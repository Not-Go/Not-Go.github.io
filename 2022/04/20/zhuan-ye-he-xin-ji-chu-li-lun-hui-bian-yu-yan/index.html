<!DOCTYPE html>
<html>
  <!-- meta/link... -->
  



<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <!-- Global site tag (gtag.js) - Google Analytics -->


  <title>专业核心基础理论：汇编语言 | 建波的学习妙妙屋</title>

  <link rel="icon" type="image/jpeg" href="/img/logo.jpg">
  <link rel="stylesheet" href="https://at.alicdn.com/t/font_1911880_c1nvbyezg17.css">
  <link href="https://unpkg.com/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
  <link href="/js/swiper/swiper@5.4.1.min.css" rel="stylesheet">
  
  
    <script>
        var themeModelId = '5';
        if (themeModelId) {
            localStorage.setItem('modelId', themeModelId);
        }
    </script>
    
    <script defer src="https://cdn.jsdelivr.net/gh/yuang01/live2d-widget@latest/autoload.js"></script>
    <script>
        var live2dOpen = eval('false') || false;
        if (!live2dOpen) {
            localStorage.setItem('waifu-display', 1609323474481);
        }
    </script>
  
  
  
<link rel="stylesheet" href="/css/animate.min.css">

  
<link rel="stylesheet" href="/css/style.css">

  
  
    <link href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" rel="stylesheet">
  
  
    
<link rel="stylesheet" href="/js/shareJs/share.min.css">

  
  <style>
        @media (max-width: 992px) {
            #waifu {
                display: none;
            }
        }
    </style>
    <script defer src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">

    
    
    <!-- 依赖于jquery和vue -->
    
        <script src="https://unpkg.com/jquery@3.5.1/dist/jquery.min.js"></script>
    

    
        <script src="https://unpkg.com/vue@2.6.11/dist/vue.min.js"></script>
    

    <!-- import link -->
    
        
            
        
            
        
    
    <!-- import script -->
    
        
            
        
            
        
    

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="建波的学习妙妙屋" type="application/atom+xml">
</head>

  
  <!-- 预加载动画 -->
  <!-- 页面预加载动画 -->

  
    <div class="preloader-1" id="loader">
  <div  aria-label="Orange and tan hamster running in a metal wheel" role="img" class="wheel-and-hamster">
    <div class="wheel"></div>
    <div class="hamster">
      <div class="hamster__body">
        <div class="hamster__head">
          <div class="hamster__ear"></div>
          <div class="hamster__eye"></div>
          <div class="hamster__nose"></div>
        </div>
        <div class="hamster__limb hamster__limb--fr"></div>
        <div class="hamster__limb hamster__limb--fl"></div>
        <div class="hamster__limb hamster__limb--br"></div>
        <div class="hamster__limb hamster__limb--bl"></div>
        <div class="hamster__tail"></div>
      </div>
    </div>
    <div class="spoke"></div>
  </div>
</div>
  
<script>
  var endLoading = function () {
    document.body.style.overflow = 'auto';
    document.getElementById('loader').classList.add("loading");
  }
  window.addEventListener('DOMContentLoaded',endLoading);
</script>

  <body>
    <!-- 判断是否为暗黑风格 -->
    <!-- 判断是否为黑夜模式 -->
<script>
  let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');

  if (isDark) {
    $(document.body).addClass('darkModel');
  }
</script>

    <!-- 需要在上面加载的js -->
    <script>
  function loadScript(src, cb) {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }

  //https://github.com/filamentgroup/loadCSS
  var loadCSS = function (src) {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  };

</script> 

<!-- 轮播图所需要的js -->
<script src="/js/swiper/swiper.min.js"></script>
<script src="/js/swiper/vue-awesome-swiper.js"></script>
<script src="/js/swiper/swiper.animate1.0.3.min.js"></script>

<script type="text/javascript">
  Vue.use(window.VueAwesomeSwiper)
</script>


  <script src="/js/vue-typed-js/index.js"></script>


<!-- 首页的公告滚动插件的js需要重新加载 -->
<script src="/js/vue-seamless-scroll/index.js"></script>

<!-- 打字机效果js -->
<script src="https://unpkg.com/typed.js@2.0.11"></script>


    <div id="safearea">
      <main class="main" id="pjax-container">
        <!-- 头部导航 -->
        
<header class="header  " 
  id="navHeader"
  style="position: fixed;
  left: 0; top: 0; z-index: 10;width: 100%;"
>
  <div class="header-content">
    <div class="bars">
      <div id="appDrawer" class="sidebar-image">
  <div class="drawer-box-icon">
    <i class="fas fa-bars" aria-hidden="true" @click="showDialogDrawer"></i>
  </div>
  
  <transition name="fade">
    <div class="drawer-box_mask" v-cloak style="display: none;" v-show="visible" @click.self="cancelDialogDrawer">
    </div>
  </transition>
  <div class="drawer-box" :class="{'active': visible}">
    <div class="drawer-box-head bg-color">
      <img class="drawer-box-head_logo lazyload placeholder" src="/img/logo.jpg" class="lazyload placeholder" data-srcset="/img/logo.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="logo">
      <h3 class="drawer-box-head_title">建波的学习妙妙屋</h3>
      <h5 class="drawer-box-head_desc">天行健，君子以自强不息</h5>
    </div>
    
    <div class="drawer-box-content">
      <ul class="drawer-box-content_menu">
        
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/" class="drawer-menu-item-link">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">首页</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/archives" class="drawer-menu-item-link">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">归档</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="/categories" class="drawer-menu-item-link">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">分类</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a target="_blank" rel="noopener" href="http://qzbltushu.ysepan.com/" class="drawer-menu-item-link">
                  
                    <i class="fas fa-book" aria-hidden="true"></i>
                  
                  <span class="name">考研专区</span>
                </a>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(4)">
                  <span>
                    
                      <i class="fas fa-wrench"></i>
                    
                    <span class="name">编程学习网站</span>
                  </span>
                  <i class="fas fa-chevron-left arrow " :class="{'icon-rotate': isOpen(4)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(4)">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.csdn.net/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>CSDN</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://juejin.cn/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>稀土掘金</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.cnblogs.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>博客园</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="http://www.codebaoku.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>编程宝库</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://github.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Github</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://gitee.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Gitee</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://app.netlify.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Netlify</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://stackoverflow.org.cn/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Stack Overflow</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(5)">
                  <span>
                    
                      <i class="fas fa-star"></i>
                    
                    <span class="name">后端全栈开发</span>
                  </span>
                  <i class="fas fa-chevron-left arrow " :class="{'icon-rotate': isOpen(5)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(5)">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://stibel.icu/">
                      
                      <i class="fas fa-star" style="margin-top: -20px;"></i>
                      
                      <span>C++全栈开发</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.pdai.tech/">
                      
                      <i class="fas fa-star" style="margin-top: -20px;"></i>
                      
                      <span>JAVA全栈开发</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(6)">
                  <span>
                    
                      <i class="fas fa-check-circle"></i>
                    
                    <span class="name">刷题网站</span>
                  </span>
                  <i class="fas fa-chevron-left arrow " :class="{'icon-rotate': isOpen(6)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(6)">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.nowcoder.com/">
                      
                      <i class="fas fa-check-circle" style="margin-top: -20px;"></i>
                      
                      <span>牛客网</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://leetcode.cn/problemset/all/">
                      
                      <i class="fas fa-check-circle" style="margin-top: -20px;"></i>
                      
                      <span>Leetcode</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://codetop.cc/home">
                      
                      <i class="fas fa-check-circle" style="margin-top: -20px;"></i>
                      
                      <span>CodeTop</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(7)">
                  <span>
                    
                      <i class="fas fa-key"></i>
                    
                    <span class="name">八股文</span>
                  </span>
                  <i class="fas fa-chevron-left arrow " :class="{'icon-rotate': isOpen(7)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(7)">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://interviewguide.cn/">
                      
                      <i class="fas fa-key" style="margin-top: -20px;"></i>
                      
                      <span>阿秀的学习笔记</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://xiaolincoding.com/">
                      
                      <i class="fas fa-key" style="margin-top: -20px;"></i>
                      
                      <span>小林coding</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.programmercarl.com/">
                      
                      <i class="fas fa-key" style="margin-top: -20px;"></i>
                      
                      <span>代码随想录</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="drawer-box-content_item" style="position: relative;">
              
                <a href="javascript:;" class="drawer-menu-item-link has-children" @click="openOrCloseMenu(8)">
                  <span>
                    
                      <i class="fas fa-graduation-cap"></i>
                    
                    <span class="name">工具</span>
                  </span>
                  <i class="fas fa-chevron-left arrow " :class="{'icon-rotate': isOpen(8)}" aria-hidden="true"></i>
                </a>
                <ul class="drawer-sub-menu" v-if="isOpen(8)">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.canva.cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Canva可画</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.processon.com/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>ProcessOn思维导图</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.officeplus.cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>OfficePLUS模板</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.aconvert.com/cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Aconvert万能格式转换</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://speedpdf.com/zh-cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Speedpdf文档格式转换</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://microsoftedge.microsoft.com/addons/detail/github%E5%8A%A0%E9%80%9F/alhnbdjjbokpmilgemopoomnldpejihb?hl=zh-CN">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>github加速(Edge插件)</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://microsoftedge.microsoft.com/addons/detail/wetab%E5%85%8D%E8%B4%B9chatgpt%E6%96%B0%E6%A0%87%E7%AD%BE%E9%A1%B5/bpelnogcookhocnaokfpoeinibimbeff?hl=zh-CN">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Wetab浏览器(免费Gpt)</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://steampp.net/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Watt Toolkit(外网加速器)</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.internetdownloadmanager.com/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>IDM下载器</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
        
        
          <li class="drawer-box-content_item">
            <a target="_blank" rel="noopener" href="https://gitee.com/Not_Go">
              <i class="fas fa-github" aria-hidden="true"></i>
              <span>Github</span>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDrawer',
    data: {
      visible: false,
      top: 0,
      openArr: [],
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      isOpen(index) {
        if (this.openArr.includes(index)) {
          return true;
        } else {
          return false;
        }
      },
      openOrCloseMenu(curIndex) {
        const index = this.openArr.indexOf(curIndex);
        if (index !== -1) {
          this.openArr.splice(index, 1);
        } else {
          this.openArr.push(curIndex);
        }
      },
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'width: 100%; height: 100%;overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      }
    },
    created() {}
  })
</script>

    </div>
    <div class="blog-title" id="author-avatar">
      
        <div class="avatar">
          <img src="/img/logo.jpg" class="lazyload placeholder" data-srcset="/img/logo.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="logo">
        </div>
      
      <a href="/" class="logo">建波的学习妙妙屋</a>
    </div>
    <nav class="navbar">
      <ul class="menu">
        
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/" class="menu-item-link" title="首页">
                  
                    <i class="fas fa-home" aria-hidden="true"></i>
                  
                  <span class="name">首页</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/archives" class="menu-item-link" title="归档">
                  
                    <i class="fas fa-archive" aria-hidden="true"></i>
                  
                  <span class="name">归档</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="/categories" class="menu-item-link" title="分类">
                  
                    <i class="fas fa-bookmark" aria-hidden="true"></i>
                  
                  <span class="name">分类</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a target="_blank" rel="noopener" href="http://qzbltushu.ysepan.com/" class="menu-item-link" title="考研专区">
                  
                    <i class="fas fa-book" aria-hidden="true"></i>
                  
                  <span class="name">考研专区</span>
                </a>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link" title="编程学习网站">
                  
                    <i class="fas fa-wrench"></i>
                  
                  <span class="name">编程学习网站</span>
                  <i class="fas fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.csdn.net/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>CSDN</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://juejin.cn/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>稀土掘金</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.cnblogs.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>博客园</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="http://www.codebaoku.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>编程宝库</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://github.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Github</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://gitee.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Gitee</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://app.netlify.com/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Netlify</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://stackoverflow.org.cn/">
                      
                      <i class="fas fa-wrench" style="margin-top: -20px;"></i>
                      
                      <span>Stack Overflow</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link" title="后端全栈开发">
                  
                    <i class="fas fa-star"></i>
                  
                  <span class="name">后端全栈开发</span>
                  <i class="fas fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://stibel.icu/">
                      
                      <i class="fas fa-star" style="margin-top: -20px;"></i>
                      
                      <span>C++全栈开发</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.pdai.tech/">
                      
                      <i class="fas fa-star" style="margin-top: -20px;"></i>
                      
                      <span>JAVA全栈开发</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link" title="刷题网站">
                  
                    <i class="fas fa-check-circle"></i>
                  
                  <span class="name">刷题网站</span>
                  <i class="fas fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.nowcoder.com/">
                      
                      <i class="fas fa-check-circle" style="margin-top: -20px;"></i>
                      
                      <span>牛客网</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://leetcode.cn/problemset/all/">
                      
                      <i class="fas fa-check-circle" style="margin-top: -20px;"></i>
                      
                      <span>Leetcode</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://codetop.cc/home">
                      
                      <i class="fas fa-check-circle" style="margin-top: -20px;"></i>
                      
                      <span>CodeTop</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link" title="八股文">
                  
                    <i class="fas fa-key"></i>
                  
                  <span class="name">八股文</span>
                  <i class="fas fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://interviewguide.cn/">
                      
                      <i class="fas fa-key" style="margin-top: -20px;"></i>
                      
                      <span>阿秀的学习笔记</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://xiaolincoding.com/">
                      
                      <i class="fas fa-key" style="margin-top: -20px;"></i>
                      
                      <span>小林coding</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.programmercarl.com/">
                      
                      <i class="fas fa-key" style="margin-top: -20px;"></i>
                      
                      <span>代码随想录</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
            <li class="menu-item" style="position: relative;">
              
                <a href="javascript:;" class="menu-item-link" title="工具">
                  
                    <i class="fas fa-graduation-cap"></i>
                  
                  <span class="name">工具</span>
                  <i class="fas fa-chevron-down arrow" aria-hidden="true"></i>
                </a>
                <ul class="sub-menu">
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.canva.cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Canva可画</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.processon.com/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>ProcessOn思维导图</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.officeplus.cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>OfficePLUS模板</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.aconvert.com/cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Aconvert万能格式转换</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://speedpdf.com/zh-cn/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Speedpdf文档格式转换</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://microsoftedge.microsoft.com/addons/detail/github%E5%8A%A0%E9%80%9F/alhnbdjjbokpmilgemopoomnldpejihb?hl=zh-CN">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>github加速(Edge插件)</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://microsoftedge.microsoft.com/addons/detail/wetab%E5%85%8D%E8%B4%B9chatgpt%E6%96%B0%E6%A0%87%E7%AD%BE%E9%A1%B5/bpelnogcookhocnaokfpoeinibimbeff?hl=zh-CN">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Wetab浏览器(免费Gpt)</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://steampp.net/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>Watt Toolkit(外网加速器)</span>
                    </a>
                  </li>
                  
                  <li>
                    <a target="_blank" rel="noopener" href="https://www.internetdownloadmanager.com/">
                      
                      <i class="fas fa-graduation-cap" style="margin-top: -20px;"></i>
                      
                      <span>IDM下载器</span>
                    </a>
                  </li>
                  
                </ul>
              
            </li>
          
        
      </ul>
      
      
        <div id="appSearch">
  <div class="search"  @click="showDialog()"><i class="fas fa-search" aria-hidden="true"></i></div>
  <transition name="fade">
    <div class="message-box_wrapper" style="display: none;" v-cloak v-show="dialogVisible" @click.self="cancelDialogVisible()">
      <div class="message-box animated bounceInDown">
        <h2>
          <span>
            <i class="fas fa-search" aria-hidden="true"></i>
            <span class="title">本地搜索</span>
          </span>
          <i class="fas fa-times close" pointer style="float:right;" aria-hidden="true" @click.self="cancelDialogVisible()"></i>
        </h2>
        <form class="site-search-form">
          <input type="text"
            placeholder="请输入关键字"
            id="local-search-input" 
            @click="getSearchFile()"
            class="st-search-input"
            v-model="searchInput"
          />
        </form>
        <div class="result-wrapper">
          <div id="local-search-result" class="local-search-result-cls"></div>
        </div>
      </div>
    </div>
  </transition>
</div>
<script src="/js/local_search.js"></script>
<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appSearch',
    data: {
      dialogVisible: false,
      searchInput: '',
      top: 0,
    },
    computed: {
    },
    mounted() {
      window.addEventListener('pjax:complete', () => {
        this.cancelDialogVisible();
      })
    },
    methods: {
      showDialog() {
        this.dialogVisible = true;
        // 防止页面滚动，只能让弹框滚动
        this.top = $(document).scrollTop()
        body.style.cssText = 'overflow: hidden;';
      },
      getSearchFile() {
        if (!this.searchInput) {
          getSearchFile("/search.xml");
        }
      },
      cancelDialogVisible() {
        this.dialogVisible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
    },
    created() {}
  })
</script>
<!-- 解决刷新页面闪烁问题，可以在元素上添加display: none, 或者用vue.extend方法，详情：https://blog.csdn.net/qq_31393401/article/details/81017912 -->
<!-- 下面是搜索基本写法 -->
<!-- <script type="text/javascript" id="local.search.active">
  var inputArea = document.querySelector("#local-search-input");
  inputArea.onclick   = function(){ getSearchFile(); this.onclick = null }
  inputArea.onkeydown = function(){ if(event.keyCode == 13) return false }
</script> -->

      

    </nav>
  </div>
  
    <a target="_blank" rel="noopener" href="https://gitee.com/Not_Go" class="github-corner color-primary" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  
  
    <div id="he-plugin-simple"></div>
    <script>
      WIDGET = {
        CONFIG: {
          "modules": "012",
          "background": 5,
          "tmpColor": "4A4A4A",
          "tmpSize": 16,
          "cityColor": "4A4A4A",
          "citySize": 16,
          "aqiSize": 16,
          "weatherIconSize": 24,
          "alertIconSize": 18,
          "padding": "10px 10px 10px 10px",
          "shadow": "1",
          "language": "auto",
          "borderRadius": 5,
          "fixed": "false",
          "vertical": "middle",
          "horizontal": "center",
          "key": "2784dd3fcb1e4f0f9a9b579bf69641f2"
        }
      }
    </script>
    <script defer src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script> 
    
</header>
        <!-- 内容区域 -->
        
 <!-- prismjs 代码高亮 -->
 
    
    <link href="/js/prism/prism-line-numbers.css" rel="stylesheet">
    
        <link href="/js/prism/prism-solarizedlight.min.css" rel="stylesheet">
    

    <style>
        pre[class*="language-"] {
            overflow-y: hidden;
        }
        .line-numbers .line-numbers-rows {
            border: none;
        }
    </style>
  


<div class="bg-dark-floor" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -1;"></div>


  <!-- 文章详情页顶部图片和标题 -->




<div class="post-detail-header" id="thumbnail_canvas" style="background-repeat: no-repeat; background-size: cover; 
  background-position: center center;position: relative;background-image:url('https://pic4.zhimg.com/80/v2-e434e3a2888fb4efb1844845b8791d1f_1440w.webp')">
  <div class="post-detail-header-mask"></div>
  <canvas id="header_canvas"style="position:absolute;bottom:0;pointer-events:none;"></canvas>
  
  <div class="post-detail-header_info-box">
    <div class="title-box">
      <span class="title">
        专业核心基础理论：汇编语言
      </span>
    </div>
    
    
      
        <span class="post-detail-header_date">
          <i class="fas fa-calendar"></i> 发表于：2022-04-20 |
        </span>
      

      
        <span class="post-detail-header_categories">
          <i class="iconfont iconbookmark1"></i> 分类：
          
            <a href="/categories/%E4%B8%93%E4%B8%9A%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA-%E4%B9%9D%E5%A4%A7%E4%BB%B6/" class="post-detail-header_category">
              专业核心基础理论(九大件)
            </a>
          
        </span>
      

      
        <div class="post-detail-header_wordcount">
          <span class="totalcount">
            <i class="fas fa-file-text-o"></i> 字数统计: 23.1k |
          </span>
  
          <span class="min2read">
            <i class="fas fa-clock"></i> 阅读时长: 91分钟 |
          </span>
  
          
            <span class="reading">
              <i class="fas fa-eye"></i> 阅读量：<span id="busuanzi_value_page_pv"></span>
            </span>
          
        </div>
      
    
  </div>
  
  
    <script src="/js/bubble/bubble.js"></script>
  
</div>





<div class="post-detail-content post-row" 
  style="padding-top: 0px;">
  <div class="main-content">
    <article class="post post-detail">
      <div class="post-content">
        <h1 id="专业核心基础理论：汇编语言"><a href="#专业核心基础理论：汇编语言" class="headerlink" title="专业核心基础理论：汇编语言"></a>专业核心基础理论：汇编语言</h1><h2 id="第一章：汇编语言基础"><a href="#第一章：汇编语言基础" class="headerlink" title="第一章：汇编语言基础"></a>第一章：汇编语言基础</h2><h3 id="指令基础概念"><a href="#指令基础概念" class="headerlink" title="指令基础概念"></a><strong>指令基础概念</strong></h3><blockquote>
<p><strong><code>基本概念：</code></strong></p>
<ol>
<li><strong><code>机器指令：CPU能直接识别并执行的二进制编码</code></strong></li>
<li><strong><code>汇编指令：汇编指令是机器指令的助记符，同机器指令一一对应</code></strong></li>
<li><strong><code>指令：指令通常由操作码和地址码（操作数）两部分组成</code></strong></li>
<li><strong><code>指令集：每种CPU都有自己的汇编指令集</code></strong></li>
<li><strong><code>在内存或磁盘上，指令和数据没有任何区别，都是二进制信息</code></strong></li>
</ol>
</blockquote>
<p><font color=red>汇编语言由三类指令构成：</font></p>
<ol>
<li><strong><mark>汇编指令：如add、mov、push、pop等</mark></strong></li>
<li><strong><mark>伪指令：没有对应的机器码，由编译器执行，计算机并不执行</mark></strong></li>
<li><strong><mark>其他符号：如+、-、*、&#x2F;等，由编译器识别，没有对应的机器码</mark></strong></li>
</ol>
<p><strong><font color=red>编译器概念：够将汇编指令转换成机器指令的翻译程序每一种CPU都有自己的汇编指令集</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319001.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319001.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319001">

<hr>
<h3 id="存储器概念"><a href="#存储器概念" class="headerlink" title="存储器概念"></a><strong>存储器概念</strong></h3><blockquote>
<p><strong><font color=red>存储器主要分为两类：</font></strong></p>
<ol>
<li><p><strong><font color=red>随机存储器（RAM）在程序的执行过程中可读可写，必须带电存储</font></strong></p>
</li>
<li><p><strong><font color=red>只读存储器（ROM）在程序的执行过程中只读，关机数据不丢失</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319002.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319002.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319002">



<p><strong><font color=red>存储器的主要特点：</font></strong></p>
</li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319003.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319003.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319003">

 <img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319004.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319004.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319004">
</blockquote>
<hr>
<h3 id="总线概念"><a href="#总线概念" class="headerlink" title="总线概念"></a><strong>总线概念</strong></h3><p><strong><code>总线</code>是连接各个部件的信息传输线，是<code>各个部件共享的传输介质</code>，主板上有核心器件和一些主要器件，这些器件通过总线（地址总线、数据总线、控制总线）相连。这些器件有CPU、存储器、外围芯片组、扩展插槽等。扩展插槽上一般插有RAM内存条和各类接口卡</strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319005.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319005.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319005">

<p><strong><font color=red>总线根据位置分类：</font></strong></p>
<ol>
<li><strong><font color=red>片内总线（芯片内部总线）</font></strong></li>
<li><strong><font color=red>系统总线（计算机各部件之间的信息传输线，根据传输信息的不同又分为：<mark>地址总线、控制总线和数据总线</mark>）</font></strong></li>
</ol>
<blockquote>
<p><strong>CPU要想进行数据的读写，必须和外部器件（标准的说法是芯片）进行以下3类信息的交互:</strong></p>
<ol>
<li><p><strong>地址总线：CPU通过地址总线来指定存储单元</strong></p>
<ul>
<li><p><strong>1根导线可以传送的稳定状态只有两种，高电平或是低电平。用二进制表示就是1或0</strong></p>
</li>
<li><p><strong>图示有10根地址线即一次可以传输10位，访问存储单元地址为1011，寻址范围为0 ~ (210 - 1)</strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319006.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319006.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319006"></li>
</ul>
</li>
<li><p><strong>数据总线：CPU与内存或其他器件之间的数据传送是通过数据总线来进行的</strong></p>
<ul>
<li><p><strong>8根数据线一次可传送一个8位二进制数据（即一个字节），传送2个字节需要两次；16根数据线一次可传送2个字节（内存对齐核心原理）</strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319007.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319007.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319007"></li>
</ul>
</li>
<li><p><strong>控制总线：CPU对外部器件的控制是通过控制总线来进行的</strong></p>
<ul>
<li><strong>有多少根控制总线，就意味着CPU提供了对外部器件的多少种控制</strong></li>
<li><strong>所以，控制总线的宽度决定了CPU对外部器件的控制能力</strong></li>
</ul>
</li>
</ol>
</blockquote>
<hr>
<h3 id="CPU对存储器的读写"><a href="#CPU对存储器的读写" class="headerlink" title="CPU对存储器的读写"></a><strong>CPU对存储器的读写</strong></h3><blockquote>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319008.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319008.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319008">

<p><strong>1、CPU通过地址线将地址信息3发出。</strong><br><strong>2、CPU通过控制线发出内存读命令，选中存储器芯片，并通知它，将要从中读取数据。</strong><br><strong>3、存储器将3号单元中的数据8通过数据线送入CPU。写操作与读操作的步骤相似。</strong><br><strong>联想：在组成原理中用微操作表示：(PC) → MAR; 1 → R; M(MAR) → MDR; …</strong></p>
</blockquote>
<hr>
<h3 id="CPU对外设的控制"><a href="#CPU对外设的控制" class="headerlink" title="CPU对外设的控制"></a><strong>CPU对外设的控制</strong></h3><blockquote>
<ol>
<li><strong>CPU对外设都不能直接控制，如显示器、音箱、打印机等</strong></li>
<li><strong>直接控制这些设备进行工作的是插在扩展插槽上的接口卡</strong></li>
<li><strong>扩展插槽通过总线和CPU相连，所以接口卡也通过总线同CPU相连。CPU可以直接控制这些接口卡，从而实现CPU对外设的间接控制</strong></li>
<li><strong>如：CPU无法直接控制显示器，但CPU可以直接控制显卡，从而实现对显示器的间接控制</strong></li>
</ol>
</blockquote>
<hr>
<h3 id="内存地址空间概念"><a href="#内存地址空间概念" class="headerlink" title="内存地址空间概念"></a><strong>内存地址空间概念</strong></h3><blockquote>
<p><strong><font color=red>CPU将系统中各类存储器看作一个逻辑存储器，这个逻辑存储器就是我们所说的内存地址空间。对于CPU，所有存储器中的存储单元都处于一个统一的逻辑存储器中，它的容量受CPU寻址能力限制</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319009.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319009.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319009">

<p><strong><font color=red>每个物理存储器在这个逻辑存储器中占有一个地址段，即一段地址空间。CPU在这段地址空间中读写数据，实际上就是在相对应的物理存储器中读写数据（对ROM写无效）</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319010.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/20221010110319010.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" width="20221010110319010">
</blockquote>
<hr>
<h2 id="第二章：8086CPU的寄存器"><a href="#第二章：8086CPU的寄存器" class="headerlink" title="第二章：8086CPU的寄存器"></a>第二章：8086CPU的寄存器</h2><h3 id="8086cpu寄存器的基本结构"><a href="#8086cpu寄存器的基本结构" class="headerlink" title="8086cpu寄存器的基本结构"></a><strong>8086cpu寄存器的基本结构</strong></h3><blockquote>
<ol>
<li><strong><font color=red>CPU由运算器、控制器、寄存器等器件构成，这些器件靠片内总线相连</font></strong></li>
<li><strong>运算器进行信息处理；控制器控制各种器件进行工作；寄存器进行信息存储；</strong></li>
<li><strong><mark>8086CPU有14个寄存器：AX、BX、CX、DX、SI、DI、SP、BP、IP、CS、SS、DS、ES、PSW都是<code>16位</code></mark></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224001.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224001.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224001">

<p><strong><font color=red>16位结构CPU具有下面几方面的结构特性</font></strong></p>
<ul>
<li><strong><mark>运算器一次最多可以处理16位的数据</mark></strong></li>
<li><strong><mark>寄存器的最大宽度为16位</mark></strong></li>
<li><strong><mark>寄存器和运算器之间的通路为16位</mark></strong></li>
</ul>
</blockquote>
<p><strong><font color=green>8086CPU可以一次性处理以下两种尺寸的数据：</font></strong></p>
<blockquote>
<ol>
<li><strong><mark>字节：记为byte，一个字节由8个bit组成，可以存在8位寄存器中</mark></strong></li>
<li><strong><mark>字：记为word，一个字由两个字节组成，可以存在一个16位寄存器中(16位CPU)</mark></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224002.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224002.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224002">


</blockquote>
<hr>
<h3 id="通用寄存器基础"><a href="#通用寄存器基础" class="headerlink" title="通用寄存器基础"></a><strong>通用寄存器基础</strong></h3><p><strong><mark>通用寄存器：通常用来存放一般性的数据，有<code>AX、BX、CX、DX</code>，它们<code>可分为两个可独立使用的8位寄存器</code></mark></strong></p>
<table>
<thead>
<tr>
<th align="center"><strong>16位</strong></th>
<th align="center"><strong>高8位</strong></th>
<th align="center"><strong>低8位</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>AX</strong></td>
<td align="center"><strong>AH</strong></td>
<td align="center"><strong>AL</strong></td>
</tr>
<tr>
<td align="center"><strong>BX</strong></td>
<td align="center"><strong>BH</strong></td>
<td align="center"><strong>BL</strong></td>
</tr>
<tr>
<td align="center"><strong>CX</strong></td>
<td align="center"><strong>CH</strong></td>
<td align="center"><strong>CL</strong></td>
</tr>
<tr>
<td align="center"><strong>DX</strong></td>
<td align="center"><strong>DH</strong></td>
<td align="center"><strong>DL</strong></td>
</tr>
</tbody></table>
<p><strong><font color=red>在进行数据传送或运算时，要注意指令的两个操作对象的位数应当是一致的，一个8位寄存器所能存储的数据范围是0 ~ 2<sup>8</sup>-1</font></strong></p>
<p><strong><font color=red>让我们来看一下几条容易出错的汇编指令：</font></strong></p>
<table>
<thead>
<tr>
<th align="center"><strong>程序段中的指令</strong></th>
<th align="center"><strong>指令执行后AX中的数据</strong></th>
<th align="center"><strong>指令执行后BX中的数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>mov ax,4E20H</strong></td>
<td align="center"><strong>4E20H</strong></td>
<td align="center"><strong>0000H</strong></td>
</tr>
<tr>
<td align="center"><strong>add ax,1406H</strong></td>
<td align="center"><strong>6226H</strong></td>
<td align="center"><strong>0000H</strong></td>
</tr>
<tr>
<td align="center"><strong>mov bx,2000H</strong></td>
<td align="center"><strong>6226H</strong></td>
<td align="center"><strong>2000H</strong></td>
</tr>
<tr>
<td align="center"><strong>add ax,bx</strong></td>
<td align="center"><strong>8226H</strong></td>
<td align="center"><strong>2000H</strong></td>
</tr>
<tr>
<td align="center"><strong>mov bx,ax</strong></td>
<td align="center"><strong>8226H</strong></td>
<td align="center"><strong>8226H</strong></td>
</tr>
<tr>
<td align="center"><strong>add ax,bx</strong></td>
<td align="center"><strong><font color=red>044CH</font></strong></td>
<td align="center"><strong>8226H</strong></td>
</tr>
</tbody></table>
<p><strong><font color=green>对于<code>add ax，bx得出044CH的</code>解释：程序段中最后一条指令 add ax，bx 在执行前ax和bx中的数据都是8226H，相加后等于1044CH，但是ax为16位寄存器，只能存放4位十六进制的数据，所以最后高位的1不能在ax寄存器中保存，所以ax中的数据为044CH</font></strong></p>
<p><strong><font color=red>我们再来看一种情况：</font></strong></p>
<table>
<thead>
<tr>
<th align="center"><strong>程序段中的指令</strong></th>
<th align="center"><strong>指令执行后AX中的数据</strong></th>
<th align="center"><strong>指令执行后BX中的数据</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>mov ax,001AH</strong></td>
<td align="center"><strong>001AH</strong></td>
<td align="center"><strong>0000H</strong></td>
</tr>
<tr>
<td align="center"><strong>mov bx,0026H</strong></td>
<td align="center"><strong>001AH</strong></td>
<td align="center"><strong>0026H</strong></td>
</tr>
<tr>
<td align="center"><strong>add al,bl</strong></td>
<td align="center"><strong>0040H</strong></td>
<td align="center"><strong>0026H</strong></td>
</tr>
<tr>
<td align="center"><strong>add ah,bl</strong></td>
<td align="center"><strong>2640H</strong></td>
<td align="center"><strong>0026H</strong></td>
</tr>
<tr>
<td align="center"><strong>add bh,al</strong></td>
<td align="center"><strong>2640H</strong></td>
<td align="center"><strong>4026H</strong></td>
</tr>
<tr>
<td align="center"><strong>add ah,0</strong></td>
<td align="center"><strong>0040H</strong></td>
<td align="center"><strong>4026H</strong></td>
</tr>
<tr>
<td align="center"><strong>add al,85H</strong></td>
<td align="center"><strong>00C5H</strong></td>
<td align="center"><strong>4026H</strong></td>
</tr>
<tr>
<td align="center"><strong>add al,93H</strong></td>
<td align="center"><strong><font color=red>0058H</font></strong></td>
<td align="center"><strong>4026H</strong></td>
</tr>
</tbody></table>
<p><strong><font color=green>对于<code>add al,93H得出0058H的</code>解释：程序段最后一条指令 add al，93H 在执行前，al中的数据为C5H，相加后为158H，但是al是8位寄存器，只能存储两位十六进制的数据，所以最高位的1被丢弃，ax中的数据为0058H（CPU在执行这条指令的时候认为ah和al是两个不相关的寄存器，不要错误的认为，al会进位存储到ah中）</font></strong></p>
<p><strong><font color=red>一点小小的细节：在汇编指令操作寄存器对象的时候，操作对象的位数一定要相同，否则会产生错误</font></strong></p>
<hr>
<h3 id="8086cpu给出物理地址的方法"><a href="#8086cpu给出物理地址的方法" class="headerlink" title="8086cpu给出物理地址的方法"></a><strong>8086cpu给出物理地址的方法</strong></h3><blockquote>
<ol>
<li><p><strong><mark>8086CPU有20位地址总线，可以传送20位地址，达到1MB（2<sup>10</sup>X2<sup>10</sup>）寻址能力</mark></strong></p>
</li>
<li><p><strong><mark>8086CPU又是16位结构，在内部一次性处理、传输、暂时存储的地址为16位</mark></strong></p>
</li>
<li><p><strong><mark>从8086CPU的内部结构来看，如果将地址从内部简单地发出，那么它只能送出16位的地址，表现出的寻址能力只有64KB（2<sup>6</sup>X2<sup>10</sup>）</mark></strong></p>
</li>
<li><p><strong><mark>概念补充</mark>：<code>段地址就是每个逻辑段的起始地址</code>，<code>偏移地址就是段内相对于段起始地址的偏移值</code></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224003.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224003.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224003">
</li>
<li><p><strong><font color=red>8086CPU采用一种在内部用两个16位地址合成的方法来形成一个20位的物理地址</font></strong></p>
</li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224004.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224004.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224004">



<p><strong><font color=red>当8086CPU要读写内存时：</font></strong></p>
<ol>
<li><strong><mark>CPU中的相关部件提供两个16位的地址，一个称为段地址，另一个称为偏移地址</mark></strong></li>
<li><strong><mark>段地址和偏移地址通过内部总线送入一个称为地址加法器的部件</mark></strong></li>
<li><strong><mark>地址加法器将两个16位地址合成为一个20位的物理地址</mark></strong></li>
<li><strong><mark>地址加法器通过内部总线将20位物理地址送入输入输出控制电路</mark></strong></li>
<li><strong><mark>输入输出控制电路将20位物理地址送上地址总线</mark></strong></li>
<li><strong><mark>20位物理地址被地址总线传送到存储器</mark></strong></li>
<li><strong><mark>地址加法器采用：<code>物理地址 = 段地址×16 + 偏移地址</code>的方法用段地址和偏移地址合成物理地址</mark></strong></li>
<li><strong><mark>例如，8086CPU要访问地址为<code>123C8H</code>的内存单元，<code>1230H</code>左移一位(空出4位)加上<code>00C8H</code>合成<code>123C8H</code></mark></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224005.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224005.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224005">
</blockquote>
<hr>
<h3 id="段寄存器剖析"><a href="#段寄存器剖析" class="headerlink" title="段寄存器剖析"></a><strong>段寄存器剖析</strong></h3><blockquote>
<p><strong><font color=green>我们可以将一段内存定义为一个段，用一个段地址指示段，用偏移地址访问段内的单元，可以用分段的方式来管理内存:</font></strong></p>
<ol>
<li><strong>用一个段存放数据，将它定义为“数据段”,如<mark>DS寄存器</mark></strong></li>
<li><strong>用一个段存放代码，将它定义为“代码段”，如<mark>CS寄存器</mark></strong></li>
<li><strong>用一个段当作栈，将它定义为“栈段”，如<mark>SS寄存器</mark></strong></li>
<li><strong>补充：<mark>ES是附加段寄存器</mark></strong></li>
</ol>
<p><strong><font color=red>注意：</font></strong></p>
<ol>
<li><strong><mark>一个段的起始地址一定是16的倍数</mark></strong></li>
<li><strong><mark>偏移地址为16位，变化范围为0-FFFFH，所以一个段的长度最大为64KB</mark></strong></li>
<li><strong>CPU可以用不同的段地址和偏移地址形成同一个物理地址</strong></li>
<li><strong><font color=red>段寄存器：8086CPU有4个段寄存器：<code>DS、CS、SS、ES</code>，<code>提供内存单元的段地址</code></font></strong></li>
</ol>
</blockquote>
<hr>
<h4 id="CS和IP寄存器"><a href="#CS和IP寄存器" class="headerlink" title="CS和IP寄存器"></a><strong>CS和IP寄存器</strong></h4><blockquote>
<ol>
<li><strong><font color=red>CS为代码段寄存器(存段地址)</font>，<font color=green>IP为指令指针寄存器(存偏移地址)</font></strong></li>
<li><strong>CPU将CS、IP中的内容当作指令的段地址和偏移地址,用它们合成指令的物理地址</strong></li>
<li><strong><font color=red>比如：CS中的内容为M，IP中的内容为N。则8086CPU将从<code>内存Mx16+N</code>单元开始，读取一条指令并执行</font></strong></li>
<li><strong><code>在8086CPU中，将CS:IP指向的内容当作指令执行</code></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224006.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224006.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224006">



<p><font color=red>8086CPU的工作过程简要描述：</font></p>
<ol>
<li><strong><mark>从CS:IP指向的内存单元读取指令，读取的指令进入指令缓冲器</mark></strong></li>
<li><strong><mark>IP&#x3D;IP+所读取指令的长度，从而指向下一条指令</mark></strong></li>
<li><strong><mark>执行指令，使用AX、BX寄存器完成操作。转到步骤1，重复这个过程</mark></strong></li>
<li><strong><font color=red>补充：</font><mark>在8086CPU加电启动或复位后（即CPU刚开始工作时）CS和IP被设置为CS&#x3D;FFFFH，IP&#x3D;0000H，即在8086PC机刚启动时，FFFF0H单元中的指令是8086PC机开机后执行的第一条指令</mark></strong></li>
</ol>
<p><strong><font color=red>8086CPU提供<code>转移指令</code>修改CS、IP的内容：</font></strong></p>
<ol>
<li><strong><code>jmp 段地址:偏移地址</code>：<font color=red>用指令中给出的段地址修改CS，偏移地址修改IP</font>。如：<code>jmp 2AE3H:0003H(修改段地址为2AE3H，偏移地址为0003H，即从2AE33H处读取指令)</code></strong></li>
<li><strong><code>jmp 某一合法寄存器</code>：<font color=red>仅修改IP的内容</font>。如：<code>jmp ax</code>。在含义上好似：<code>mov IP，ax</code></strong></li>
</ol>
</blockquote>
<hr>
<h4 id="DS和-address-寄存器"><a href="#DS和-address-寄存器" class="headerlink" title="DS和[address]寄存器"></a><strong>DS和[address]寄存器</strong></h4><blockquote>
<ol>
<li><strong><font color=red>DS寄存器：通常用来存放要访问数据的段地址</font></strong></li>
<li><strong><font color=red>[address]表示一个<code>偏移地址为address的内存单元</code>，<code>段地址默认放在ds中</code></font></strong></li>
<li><strong><mark>通过数据段地址和偏移地址即可定位内存单元位置</mark></strong></li>
<li><strong><mark>8086CPU不支持将数据直接送入段寄存器的操作，这属于8086CPU硬件设计。比如：我们不能直接mov ds,1000H 而是通过mov bx，1000H mov ds，bx这种方式用一个寄存器中转才能实现</mark></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>以下为读取<span class="token number">10000</span>H单元的内容操作
mov bx<span class="token punctuation">,</span> <span class="token number">1000</span>H <span class="token punctuation">;</span><span class="token number">8086</span>CPU不支持将数据直接送入段寄存器的操作
mov ds<span class="token punctuation">,</span> bx <span class="token punctuation">;</span>ds存放数据段地址<span class="token number">1000</span>H，存放后就意味着从<span class="token number">1000</span>H这个段地址开始执行了
mov al<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>将al数据（<span class="token number">1</span>字节）存到<span class="token number">1000</span>H段的<span class="token number">0</span>偏移地址处，即<span class="token number">10000</span>H  扩展：为什么使用al，因为节约空间

<span class="token punctuation">;</span>以下为将al数据送入内存单元<span class="token number">10000</span>H操作
mov bx<span class="token punctuation">,</span><span class="token number">1000</span>H
mov ds<span class="token punctuation">,</span>bx
mov <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>al

<span class="token punctuation">;</span>一些其他操作
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>将数据段偏移地址<span class="token number">2</span>处的一个字（<span class="token number">8086</span>为<span class="token number">2</span>字节）存放到ax寄存器
add cx<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>将偏移地址<span class="token number">4</span>处的一个字数据加上cx寄存器数据放到cx寄存器
sub dx<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>dx寄存器数据减去数据段偏移地址<span class="token number">6</span>处的字数据存到dx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=green>一点思考：让我们对以下指令操作进行单步跟踪，看下每条指令执行后相关寄存器中的值</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224007.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224007.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224007">

<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span><span class="token number">1000</span>H
mov ds<span class="token punctuation">,</span>ax
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
mov bx<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
mov cx<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
mov bx<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
mov cx<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<table>
<thead>
<tr>
<th align="center">指令</th>
<th align="center">执行后相关寄存器中的内容</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">mov ax,1000H</td>
<td align="center">ax&#x3D;1000H</td>
<td align="left">前两条指令的目的是将ds设为1000H</td>
</tr>
<tr>
<td align="center">mov ds,ax</td>
<td align="center">ds&#x3D;1000H</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">mov ax,[0]</td>
<td align="center">ax&#x3D;1123H</td>
<td align="left">1000:0处存放的字型数据送入ax：                                                                                          1000:1处存放的字型数据的高8位：11H                                                                                         1000:0单元存放的字型数据的低8位：23H                                                                                             所以1000:0处存放的字型数据为1123H                                                                                                          执行指令的时候，高8位送入ah，低8位送入al，则ax中数据为1123H</td>
</tr>
<tr>
<td align="center">mov bx,[2]</td>
<td align="center">bx&#x3D;6623H</td>
<td align="left">原理同上</td>
</tr>
<tr>
<td align="center">mov cx,[1]</td>
<td align="center">cx&#x3D;2211H</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">mov bx,[1]</td>
<td align="center">bx&#x3D;8833H</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">mov cx,[2]</td>
<td align="center">cx&#x3D;8833H</td>
<td align="left"></td>
</tr>
</tbody></table>
</blockquote>
<hr>
<p>​	</p>
<h4 id="SS和SP寄存器"><a href="#SS和SP寄存器" class="headerlink" title="SS和SP寄存器"></a><strong>SS和SP寄存器</strong></h4><blockquote>
<ol>
<li><p><strong>在基于8086CPU编程的时候，可以将一段内存当作栈来使用</strong></p>
</li>
<li><p><strong><code>栈段寄存器SS存放段地址</code>，<code>SP寄存器存放偏移地址</code>，<code>任意时刻，SS:SP指向栈顶元素</code></strong></p>
</li>
<li><p><strong><mark>8086CPU中，入栈时，栈顶从高地址向低地址方向增长</mark></strong></p>
</li>
<li><p><strong><code>push ax</code>表示将寄存器ax中的数据送入栈中，由两步完成：</strong></p>
<ul>
<li><strong>SP&#x3D;SP-2(<mark>减2是因为一个寄存器是16位，需要两个栈空间才够存储</mark>)，SS:SP指向当前栈顶前面的单元，以当前栈顶前面的单元为新的栈顶</strong></li>
<li><strong>将ax中的内容送入SS:SP指向的内存单元处，SS:SP此时指向新栈顶</strong></li>
</ul>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224008.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010112224008.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010112224008">
</li>
<li><p><strong><code>pop ax</code>表示从栈顶取出数据送入ax，由以下两步完成：</strong></p>
<ul>
<li><strong>将SS:SP指向的内存单元处的数据送入ax中</strong></li>
<li><strong>SP&#x3D;SP+2，SS:SP指向当前栈顶下面的单元，以当前栈顶下面的单元为新的栈顶</strong></li>
</ul>
</li>
</ol>
<p><strong><font color=red>举例流程：</font></strong></p>
<ol>
<li><strong><mark>将10000H~1000FH这段空间当作栈，初始状态栈是空的</mark></strong></li>
<li><strong><mark>设置AX&#x3D;001AH，BX&#x3D;001BH</mark></strong></li>
<li><strong><mark>将AX、BX中的数据入栈</mark></strong></li>
<li><strong><mark>然后将AX、BX清零</mark></strong></li>
<li><strong><mark>从栈中恢复AX、BX原来的内容</mark></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> <span class="token number">1000</span>H 
mov ss<span class="token punctuation">,</span> ax 
mov sp<span class="token punctuation">,</span> <span class="token number">0010</span>H    <span class="token punctuation">;</span>初始化栈顶
mov ax<span class="token punctuation">,</span> <span class="token number">001</span>AH
mov bx<span class="token punctuation">,</span> <span class="token number">001</span>BH 

push ax 
push bx    <span class="token punctuation">;</span>ax、bx入栈

sub ax<span class="token punctuation">,</span> ax   <span class="token punctuation">;</span>将ax清零，也可以用mov ax，<span class="token number">0</span>，
             <span class="token punctuation">;</span><span class="token comment">//sub ax，ax的机器码为2个字节，</span>
             <span class="token punctuation">;</span><span class="token comment">//mov ax，0的机器码为3个字节。</span>

sub bx<span class="token punctuation">,</span> bx 

pop bx  <span class="token punctuation">;</span><span class="token comment">//从栈中恢复ax、bx原来的数据</span>
pop ax  <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>栈顶超界问题的思考:</font></strong></p>
<ol>
<li><strong><font color=red>push指令，sp&#x3D;sp-2，往低地址走</font></strong></li>
<li><strong><font color=red>pop指令，sp&#x3D;sp+2，往高地址走</font></strong></li>
<li><strong><font color=red>push至栈满，再push，覆盖栈外数据。pop至栈空，再pop，覆盖栈外数据</font></strong></li>
</ol>
</blockquote>
<hr>
<h2 id="第三章：第一个汇编程序"><a href="#第三章：第一个汇编程序" class="headerlink" title="第三章：第一个汇编程序"></a>第三章：第一个汇编程序</h2><h3 id="汇编模拟程序：DOSBox使用"><a href="#汇编模拟程序：DOSBox使用" class="headerlink" title="汇编模拟程序：DOSBox使用"></a><strong>汇编模拟程序：DOSBox使用</strong></h3><p><strong><font color=red>BOSBox软件常用基本语法：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mount c<span class="token operator">:</span> d<span class="token operator">:</span>\masn 	<span class="token punctuation">;</span>挂载磁盘
dir 				<span class="token punctuation">;</span>查看当前磁盘
debug 			    <span class="token punctuation">;</span>使用debug工具
<span class="token operator">-</span>r 寄存器名			 <span class="token punctuation">;</span>查看cpu寄存器的内容
<span class="token operator">-</span>d					<span class="token punctuation">;</span>查看内存中的内容  <span class="token punctuation">;</span>扩展用法： <span class="token operator">-</span>d 段地址<span class="token operator">:</span>偏移地址 结果偏移地址，如 <span class="token operator">-</span>d <span class="token number">1000</span><span class="token operator">:</span><span class="token number">0</span> <span class="token number">9</span> 代表地址<span class="token number">1000</span><span class="token operator">:</span><span class="token number">0</span><span class="token operator">~</span><span class="token number">1000</span><span class="token operator">:</span><span class="token number">9</span>
<span class="token operator">-</span>e 内存内容			 <span class="token punctuation">;</span>改写寄存器内存中的内容
<span class="token operator">-</span>u 				    <span class="token punctuation">;</span>查看内存中机器码含义
<span class="token operator">-</span>T 					<span class="token punctuation">;</span>执行内存中的机器码
<span class="token operator">-</span>a					<span class="token punctuation">;</span>以汇编指令的形式在内存中写入机器指令
<span class="token operator">-</span>q					<span class="token punctuation">;</span>退出debug工具<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong><font color=red>一点使用细节：</font></strong></p>
<blockquote>
<ol>
<li><strong>在使用DOSBox的使用一定要先挂载磁盘，否则无法使用debug工具</strong></li>
<li>不要直接在自己电脑上使用DOSBox软件，因为你修改的寄存器可能是存储系统文件的寄存器，改了系统就崩了</li>
</ol>
</blockquote>
<p><strong><font color=red>伪指令与汇编代码的含义：</font></strong></p>
<blockquote>
<ol>
<li><strong><font color=red>在汇编语言中有两种指令：汇编指令和伪指令</font></strong></li>
<li><strong><font color=red>汇编指令：是指对应的机器码指令，可以被编译为机器指令，最终为CPU执行</font></strong></li>
<li><strong><font color=red>伪指令：是指没有对应的机器指令，最终不被CPU所执行，由编译器执行的执行</font>(编译器根据伪指令来进行相关的编译工作)</strong></li>
</ol>
</blockquote>
<p><strong><font color=red>常见的伪指令含义：</font></strong></p>
<blockquote>
<ol>
<li><p><strong>assume:这条伪指令含义是”假设”。它假设某一段寄存器和程序中的某一个用segment…ends定义的段相关联</strong></p>
</li>
<li><p><strong>segment与ends:segment和ends是一对成对使用的伪指令。segment和ends的功能是定义一个段，segment说明一个段开始，ends说明一个段结束。一个段必须有一个名称来表示</strong></p>
</li>
<li><p><strong>end：end是一个汇编语言结束标记，编译器在编译汇编程序的过程中，如果遇到伪指令end，就结束对源程序的编译</strong></p>
</li>
<li><p><strong>idata：表示常量</strong></p>
</li>
<li><p><strong>db：定义字节类型的意思</strong></p>
</li>
<li><p><strong>dw：定义字类型的意思</strong></p>
<p><strong>比如：</strong></p>
<ol>
<li><strong><mark>mov ax,[idata] 可以表示 mov ax,[1] mov ax,[2]等</mark></strong></li>
<li><strong><mark>mov bx,idata 可以表示mov bx,1 mov bx,2等</mark></strong></li>
<li><strong><mark>mov ds,idata 可以表示mov ds,1 mov ds,2等</mark>，<font color=red>但是这样是非法指令，因为ds寄存器不支持直接将数据送入ds寄存器</font></strong></li>
</ol>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>举例格式
assume cs<span class="token operator">:</span>codesg <span class="token punctuation">;</span>assume<span class="token operator">+</span>自定段名称
codesg segment <span class="token punctuation">;</span>格式：段名称<span class="token operator">+</span>segment
    mov ax<span class="token punctuation">,</span><span class="token number">0123</span>H
    mov bx<span class="token punctuation">,</span><span class="token number">0456</span>H
    add ax<span class="token punctuation">,</span>bx
    add ax<span class="token punctuation">,</span>ax
    mov ax<span class="token punctuation">,</span><span class="token number">4</span>C00H
    <span class="token keyword">int</span> <span class="token number">21</span>H
codesg ends <span class="token punctuation">;</span>格式：段名称<span class="token operator">+</span>ends
end  <span class="token punctuation">;</span>结束标志<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="汇编程序从写出到执行的过程"><a href="#汇编程序从写出到执行的过程" class="headerlink" title="汇编程序从写出到执行的过程"></a><strong>汇编程序从写出到执行的过程</strong></h3><ol>
<li><strong><mark>Edit(编写)</mark></strong></li>
<li><strong><mark>masm(编译)</mark></strong></li>
<li><strong><mark>link(连接)</mark></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156001.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156001.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010134156001">

<p><strong><font color=red>加载后，CPU的CS:IP指向程序的第一条指令（即程序的入口）</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//1.asm程序</span>
assume cs<span class="token operator">:</span>codesg <span class="token punctuation">;</span>将用作代码段的段codesg和段寄存器cs联系起来。

codesg segment <span class="token punctuation">;</span>定义一个段，段的名称为“codesg”，这个段从此开始
			   <span class="token punctuation">;</span>codesg是一个标号，作为一个段的名称，最终被编译连接成一个段的段地址

	mov ax<span class="token punctuation">,</span> <span class="token number">0123</span>H
	mov bx<span class="token punctuation">,</span> <span class="token number">0456</span>H 
	add ax<span class="token punctuation">,</span> bx
	add ax<span class="token punctuation">,</span> ax 
	
	mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00H 
	<span class="token keyword">int</span> <span class="token number">21</span>H <span class="token punctuation">;</span>这两条指令实现程序的返回
	
codesg ends <span class="token punctuation">;</span>名称为“codesg”的段到此结束

end <span class="token punctuation">;</span><span class="token comment">//编译器在编译汇编程序的过程中，碰到了伪指令end，结束对源程序的编译</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156002.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156002.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010134156002">

<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156003.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156003.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010134156003">

<hr>
<h3 id="程序执行过程跟踪"><a href="#程序执行过程跟踪" class="headerlink" title="程序执行过程跟踪"></a><strong>程序执行过程跟踪</strong></h3><p><strong><font color=red>先给结论：DS和CS段之间有256(也就是100H)的通信区，用于DOS跟程序通讯</font></strong></p>
<p><strong><font color=red>这也是为什么(ds)&#x3D;0B2DH，但程序在0B3D:0(100H就是10:0)处开始执行的原因</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156004.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156004.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010134156004">

<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156005.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010134156005.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010134156005">



<hr>
<h2 id="第四章：-bx-与loop指令"><a href="#第四章：-bx-与loop指令" class="headerlink" title="第四章：[bx]与loop指令"></a>第四章：[bx]与loop指令</h2><h3 id="bx-与loop指令概念"><a href="#bx-与loop指令概念" class="headerlink" title="[bx]与loop指令概念"></a><strong>[bx]与loop指令概念</strong></h3><blockquote>
<ol>
<li><strong><code>[bx]</code> 的含义：<font color=red>[bx]同样表示一个内存单元，它的偏移地址在bx中，段地址默认在ds中</font></strong></li>
<li><strong><code>[...]</code>的含义：<font color=red>[]表示内存单元，偏移地址是…</font></strong></li>
</ol>
<p><strong><font color=red>关于[bx]与[…]的区别：主要就在于[…]是直接给偏移地址，而[bx]偏移地址在bx中</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址为<span class="token number">0</span>，段地址在ds中
mov al<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>将一个内存单元内容送入al，这个内存单元长度为<span class="token number">1</span>字节，偏移地址为<span class="token number">0</span>，段地址在ds中
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span> <span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址在bx中，段地址在ds中
mov al<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span> <span class="token punctuation">;</span>将一个内存单元内容送入al，这个内存单元长度为<span class="token number">1</span>字节，偏移地址在bx中，段地址在ds中<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><code>loop</code>指令的格式是：loop 标号，CPU执行loop指令的时候，要进行两步操作:</strong></p>
<ol>
<li><strong><mark>(cx) &#x3D; (cx) - 1</mark>，这里的()是一个描述符，用来表示一个寄存器或一个内存单元中的内容，<mark>比如20000H表示20000H单元，(20000H)表示该单元下的内容</mark></strong></li>
<li><strong><mark>()中的元素可以是：寄存器名、段寄存器名、内存单元的物理地址</mark></strong></li>
<li><strong><mark>判断 cx 中的值，不为零则转至<code>标号</code>处执行程序，如果为零则向下执行</mark></strong></li>
</ol>
<p><strong><mark>例如：计算2<sup>12</sup></mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code 

code segment 
	mov ax<span class="token punctuation">,</span> <span class="token number">2</span>

	mov cx<span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation">;</span>循环次数
s<span class="token operator">:</span>  add ax<span class="token punctuation">,</span> ax <span class="token punctuation">;</span>放置标号s
	loop s     <span class="token punctuation">;</span>在汇编语言中，标号代表一个地址，标号s实际上标识了一个地址，
               <span class="token punctuation">;</span>这个地址处有一条指令：add ax，ax。
               <span class="token punctuation">;</span>执行loop s时，首先要将（cx）减<span class="token number">1</span>，然后若（cx）不为<span class="token number">0</span>，则向前
               <span class="token punctuation">;</span>转至s处执行add ax，ax。所以，可以利用cx来控制add ax，ax的执行次数。

	mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h 
	<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends 
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="bx-和loop的联合应用"><a href="#bx-和loop的联合应用" class="headerlink" title="[bx]和loop的联合应用"></a><strong>[bx]和loop的联合应用</strong></h3><p><strong>例题：计算<code>ffff:0 ~ ffff:b</code>单元中的数据的和，结果存储在dx中</strong></p>
<blockquote>
<p><strong><font color=red>问题分析：</font></strong></p>
<ol>
<li><p><strong><font color=red>运算后的结果是否会超出dx所能存储的范围？</font></strong></p>
<p><strong>分析：可以，ffff:0~ffff:b内存单元中的数据是字节型数据，范围在0 ~ 255之间，12个这样的数据相加，结果不会大于65535，可以在dx中存下</strong></p>
</li>
<li><p><strong><font color=red>能否将ffff:0~ffff:b中的数据直接累加到dx中？</font></strong></p>
<p><strong>分析：不行，因为ffff:0~ffff:b中的数据是8位，不能直接加到16位寄存器dx中</strong></p>
</li>
<li><p><strong><font color=red>能否将ffff:0~ffff:b中的数据累加到dl中，并设置(dh)&#x3D;0，从而实现累加到dx中？</font></strong></p>
<p><strong>分析：不行，因为dl是8位寄存器，能容纳的数据范围在0 ~ 255之间，ffff:0~ffff:b中的数据也都是8位，如果仅向dl中累加12个8位数据，很可能造成进位丢失</strong></p>
</li>
<li><p><strong><font color=red>我们如何将ffff:0~ffff:b中的8位数据，累加到16位寄存器dx中？</font></strong></p>
<p><strong><font color=green>解决方案：用一个16位寄存器来做中介。将内存单元中的8位数据赋值到一个16位寄存器a中，再将ax中的数据加到dx</font></strong></p>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>解决方案代码
assume cs<span class="token operator">:</span>code 

code segment 
	mov ax<span class="token punctuation">,</span><span class="token number">0ffff</span>h 	<span class="token punctuation">;</span>在汇编源程序中，数据不能以字母开头，所以要在前面加<span class="token number">0</span>
	mov ds<span class="token punctuation">,</span>ax 
	mov bx<span class="token punctuation">,</span><span class="token number">0</span>   		<span class="token punctuation">;</span>初始化ds<span class="token operator">:</span>bx指向ffff<span class="token operator">:</span><span class="token number">0</span>
	mov dx<span class="token punctuation">,</span><span class="token number">0</span>   		<span class="token punctuation">;</span>初始化累加寄存器dx，（dx）<span class="token operator">=</span> <span class="token number">0</span>

	mov cx<span class="token punctuation">,</span><span class="token number">12</span>  		<span class="token punctuation">;</span>初始化循环计数寄存器cx，（cx）<span class="token operator">=</span> <span class="token number">12</span>
s<span class="token operator">:</span>  mov al<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
	mov ah<span class="token punctuation">,</span><span class="token number">0</span>
	add dx<span class="token punctuation">,</span>ax  		<span class="token punctuation">;</span>间接向dx中加上（（ds）<span class="token operator">*</span> <span class="token number">16</span> <span class="token operator">+</span>（bx））单元的数值
	inc bx      <span class="token punctuation">;</span>ds<span class="token operator">:</span>bx指向下一个单元
	loop s 

	mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
	<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends 
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="段前缀概念"><a href="#段前缀概念" class="headerlink" title="段前缀概念"></a><strong>段前缀概念</strong></h3><blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> ds<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>  	<span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址在bx中，段地址在ds中
mov ax<span class="token punctuation">,</span> cs<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>	 	<span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址在bx中，段地址在cs中
mov ax<span class="token punctuation">,</span> ss<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>		<span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址在bx中，段地址在ss中
mov ax<span class="token punctuation">,</span> es<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>		<span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址在bx中，段地址在es中
mov ax<span class="token punctuation">,</span> ss<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>		<span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址为<span class="token number">0</span>，段地址在ss中
mov ax<span class="token punctuation">,</span> cs<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>		<span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元长度为<span class="token number">2</span>字节，偏移地址为<span class="token number">0</span>，段地址在cs中<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong><font color=red>这些出现在访问内存单元的指令中，用于显式地指明内存单元的段地址的<code>“ds:”，“cs:”，“ss:”，“es:”</code>，在汇编语言中称为段前缀</font></strong></p>
<p><strong><mark>关于安全段空间的扩展：</mark></strong></p>
<ol>
<li><strong><font color=red>在一般PC机中，DOS方式下，DOS和其他合法程序一般都不会使用0:200~0:2ff（00200H ~ 002ffH）的256个字节的空间，所以我们使用这段空间是安全的</font></strong></li>
<li><strong><font color=red>为了谨慎起见，进入DOS后，先用debug查看一下，如果0:200~0:2ff单元的内容都是0，则证明DOS和其他合法程序没有使用这里</font></strong></li>
</ol>
<p><strong><font color=green>段前缀的使用：将内存<code>ffff:0 ~ ffff:b</code>单元中的数据复制到<code>0:200 ~ 0:20b</code>单元中</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code 

code segment 
	mov ax<span class="token punctuation">,</span> <span class="token number">0ffff</span>h 
	mov ds<span class="token punctuation">,</span> ax   	 <span class="token punctuation">;</span>（ds）<span class="token operator">=</span> <span class="token number">0ffff</span>h 
	mov ax<span class="token punctuation">,</span> <span class="token number">0020</span>h
 mov es<span class="token punctuation">,</span> ax   		 <span class="token punctuation">;</span>（es）<span class="token operator">=</span> <span class="token number">0020</span>h     <span class="token number">0</span><span class="token operator">:</span><span class="token number">200</span> 等效于 <span class="token number">0020</span><span class="token operator">:</span><span class="token number">0</span>
 mov bx<span class="token punctuation">,</span> <span class="token number">0</span>    		 <span class="token punctuation">;</span>（bx）<span class="token operator">=</span> <span class="token number">0</span>，此时ds<span class="token operator">:</span>bx指向ffff<span class="token operator">:</span><span class="token number">0</span>，es<span class="token operator">:</span>bx指向<span class="token number">0020</span><span class="token operator">:</span><span class="token number">0</span>

	mov cx，<span class="token number">12</span>   	<span class="token punctuation">;</span>（cx）<span class="token operator">=</span><span class="token number">12</span>，循环<span class="token number">12</span>次
s<span class="token operator">:</span>  mov dl，<span class="token punctuation">[</span>bx<span class="token punctuation">]</span> 	<span class="token punctuation">;</span>（d1）<span class="token operator">=</span>（（ds）<span class="token operator">*</span> <span class="token number">16</span><span class="token operator">+</span>（bx）），将ffff<span class="token operator">:</span>bx中的字节数据送入dl 
	mov es<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>，dl 	<span class="token punctuation">;</span>（（es）<span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span>（bx））<span class="token operator">=</span>（d1），将dl中的数据送入<span class="token number">0020</span><span class="token operator">:</span>bx 
	inc bx  		 <span class="token punctuation">;</span>（bx）<span class="token operator">=</span>（bx）<span class="token operator">+</span><span class="token number">1</span>
	loop s 

	mov ax，<span class="token number">4</span>c00h 
	<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends 
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="包含多个段的程序案例"><a href="#包含多个段的程序案例" class="headerlink" title="包含多个段的程序案例"></a><strong>包含多个段的程序案例</strong></h3><p><strong><font color=red>包含多个段的程序使用案例：</font></strong></p>
<blockquote>
<p><strong><mark>程序中对段名的引用，将被编译器处理为一个表示段地址的数值，如下</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> data 

mov ds<span class="token punctuation">,</span> ax 

mov bx<span class="token punctuation">,</span> ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><mark>在代码段中使用数据,如下:</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>计算 <span class="token number">8</span> 个数据的和存到 ax 寄存器
assume cs<span class="token operator">:</span>code 

code segment 

	dw <span class="token number">0123</span>h<span class="token punctuation">,</span><span class="token number">0456</span>h<span class="token punctuation">,</span><span class="token number">0789</span>h<span class="token punctuation">,</span><span class="token number">0</span>abch<span class="token punctuation">,</span><span class="token number">0</span>defh<span class="token punctuation">,</span><span class="token number">0f</span>edh<span class="token punctuation">,</span><span class="token number">0</span>cbah<span class="token punctuation">,</span><span class="token number">0987</span>h  <span class="token punctuation">;</span>dw含义是定义字型数据，即define word
	<span class="token punctuation">;</span>这<span class="token number">8</span>个数，偏移为：<span class="token number">0</span>、<span class="token number">2</span>、<span class="token number">4</span>、<span class="token number">6</span>、<span class="token number">8</span>、A、C、E   地址为：CS<span class="token operator">:</span><span class="token number">0</span>、CS<span class="token operator">:</span><span class="token number">2</span>、CS<span class="token operator">:</span><span class="token number">4</span>、CS<span class="token operator">:</span><span class="token number">6</span>、CS<span class="token operator">:</span><span class="token number">8</span>、CS<span class="token operator">:</span>A、CS<span class="token operator">:</span>C、CS<span class="token operator">:</span>E

	start<span class="token operator">:</span>	mov bx<span class="token punctuation">,</span> <span class="token number">0</span>  <span class="token punctuation">;</span>标号start
			mov ax<span class="token punctuation">,</span> <span class="token number">0</span>  

			mov cx<span class="token punctuation">,</span> <span class="token number">8</span>
	s<span class="token operator">:</span>		add ax<span class="token punctuation">,</span> cs<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
			add bx<span class="token punctuation">,</span> <span class="token number">2</span>
			loop s 

			mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
			<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends
end start    <span class="token punctuation">;</span>end除了通知编译器程序结束外，还可以通知编译器程序的入口在什么地方
	     	 <span class="token punctuation">;</span>用end指令指明了程序的入口在标号start处，也就是说，“mov bx，<span class="token number">0</span>”是程序的第一条指令。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><mark>在代码段中使用栈,如下：</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>利用栈，将程序中定义的数据逆序存放

assume cs<span class="token operator">:</span>codesg 
codesg segment 
	dw <span class="token number">0123</span>h，<span class="token number">0456</span>h，<span class="token number">0789</span>h，<span class="token number">0</span>abch，<span class="token number">0</span>defh，<span class="token number">0f</span>edh，<span class="token number">0</span>cbah，<span class="token number">0987</span>h <span class="token punctuation">;</span> <span class="token number">0</span><span class="token operator">-</span><span class="token number">15</span>单元
	dw <span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span> <span class="token punctuation">;</span> <span class="token number">16</span><span class="token operator">-</span><span class="token number">47</span>单元作为栈使用

	start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span> cs 
			mov ss<span class="token punctuation">,</span> ax 
			mov sp<span class="token punctuation">,</span> <span class="token number">30</span>h <span class="token punctuation">;</span>将设置栈顶ss<span class="token operator">:</span>sp指向栈底cs<span class="token operator">:</span><span class="token number">30</span>。   <span class="token number">30</span>h <span class="token operator">=</span> <span class="token number">48</span>d
			mov bx<span class="token punctuation">,</span> <span class="token number">0</span>

			mov cx<span class="token punctuation">,</span> <span class="token number">8</span>
	s<span class="token operator">:</span>		push cs<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
			add bx<span class="token punctuation">,</span> <span class="token number">2</span>
			loop s    <span class="token punctuation">;</span>以上将代码段<span class="token number">0</span><span class="token operator">~</span><span class="token number">15</span>单元中的<span class="token number">8</span>个字型数据依次入栈

			mov bx<span class="token punctuation">,</span> <span class="token number">0</span>

			mov cx<span class="token punctuation">,</span> <span class="token number">8</span>
	s0<span class="token operator">:</span>		pop cs<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>		
			add bx，<span class="token number">2</span>
			loop s0   <span class="token punctuation">;</span>以上依次出栈<span class="token number">8</span>个字型数据到代码段<span class="token number">0</span><span class="token operator">~</span><span class="token number">15</span>单元中

			mov ax，<span class="token number">4</span>c00h 
			<span class="token keyword">int</span> <span class="token number">21</span>h 
codesg ends 
end start	<span class="token punctuation">;</span>指明程序的入口在start处<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><mark>将数据、代码、栈放入不同的段，如下：</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code<span class="token punctuation">,</span>ds<span class="token operator">:</span>data<span class="token punctuation">,</span>ss<span class="token operator">:</span>stack 

data segment 
	dw <span class="token number">0123</span>h<span class="token punctuation">,</span><span class="token number">0456</span>h<span class="token punctuation">,</span><span class="token number">0789</span>h<span class="token punctuation">,</span><span class="token number">0</span>abch<span class="token punctuation">,</span><span class="token number">0</span>defh<span class="token punctuation">,</span><span class="token number">0f</span>edh<span class="token punctuation">,</span><span class="token number">0</span>cbah<span class="token punctuation">,</span><span class="token number">0987</span>h <span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">15</span>单元
data ends 

stack segment 
	dw <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span> <span class="token punctuation">;</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">31</span>单元
stack ends 

code segment 
	start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span> stack<span class="token punctuation">;</span>将名称为“stack”的段的段地址送入ax
			mov ss<span class="token punctuation">,</span> ax
			mov sp<span class="token punctuation">,</span> <span class="token number">20</span>h  <span class="token punctuation">;</span>设置栈顶ss<span class="token operator">:</span>sp指向stack<span class="token operator">:</span><span class="token number">20</span>。 <span class="token number">20</span>h <span class="token operator">=</span> <span class="token number">32</span>d

			mov ax<span class="token punctuation">,</span> data <span class="token punctuation">;</span>将名称为“data”的段的段地址送入ax
			mov ds<span class="token punctuation">,</span> ax   <span class="token punctuation">;</span>ds指向data段

			mov bx<span class="token punctuation">,</span> <span class="token number">0</span>    <span class="token punctuation">;</span>ds<span class="token operator">:</span>bx指向data段中的第一个单元

			mov cx<span class="token punctuation">,</span> <span class="token number">8</span>
	s<span class="token operator">:</span>	    push <span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
			add bx<span class="token punctuation">,</span> <span class="token number">2</span>
			loop s       <span class="token punctuation">;</span>以上将data段中的<span class="token number">0</span><span class="token operator">~</span><span class="token number">15</span>单元中的<span class="token number">8</span>个字型数据依次入栈

			mov bx<span class="token punctuation">,</span> <span class="token number">0</span>

			mov cx<span class="token punctuation">,</span> <span class="token number">8</span>
	s0<span class="token operator">:</span>		pop <span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
			add bx<span class="token punctuation">,</span> <span class="token number">2</span>
			loop s0      <span class="token punctuation">;</span>以上依次出栈<span class="token number">8</span>个字型数据到data段的<span class="token number">0</span><span class="token operator">~</span><span class="token number">15</span>单元中

			mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
			<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends
end start
<span class="token punctuation">;</span>“end start”说明了程序的入口，这个入口将被写入可执行文件的描述信息，
<span class="token punctuation">;</span>可执行文件中的程序被加载入内存后，CPU的CS<span class="token operator">:</span>IP被设置指向这个入口，从而开始执行程序中的第一条指令<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h2 id="第五章：更灵活定位内存地址的方法"><a href="#第五章：更灵活定位内存地址的方法" class="headerlink" title="第五章：更灵活定位内存地址的方法"></a>第五章：更灵活定位内存地址的方法</h2><h3 id="and和or"><a href="#and和or" class="headerlink" title="and和or"></a><strong>and和or</strong></h3><blockquote>
<ol>
<li><p><strong><font color=red>and指令：<code>逻辑与</code>指令，按<code>位进行与</code>运算(同真为真)</font></strong></p>
<ul>
<li><p><strong><mark>比如：</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov al<span class="token punctuation">,</span> <span class="token number">01100011</span>B
and al<span class="token punctuation">,</span> <span class="token number">00111011</span>B
；执行后：al<span class="token operator">=</span><span class="token number">00100011</span>B即都为<span class="token number">1</span>才为<span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p><strong><font color=red>or指令：<code>逻辑或</code>指令，按<code>位进行或</code>运算(同假为假)</font></strong></p>
<ul>
<li><p><strong><mark>比如：</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov al<span class="token punctuation">,</span> <span class="token number">01100011</span>B
or al<span class="token punctuation">,</span> <span class="token number">00111011</span>B
；执行后：al<span class="token operator">=</span><span class="token number">01111011</span>B 即只要有一个为<span class="token number">1</span>就为<span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ol>
</blockquote>
<hr>
<h3 id="以字符形式给出的数据"><a href="#以字符形式给出的数据" class="headerlink" title="以字符形式给出的数据"></a><strong>以字符形式给出的数据</strong></h3><blockquote>
<p><strong>关于ASCII码在内存中的存储：</strong></p>
<ol>
<li><strong>世界上有很多编码方案，有一种方案叫做ASCII编码，是在计算机系统中通常被采用的。简单地说，所谓编码方案，就是一套规则，它约定了用什么样的信息来表示现实对象。比如说，在ASCII编码方案中，用61H表示“a”，62H表示“b”。一种规则需要人们遵守才有意义</strong></li>
<li><strong><mark>在文本编辑过程中，我们按一下键盘的a键，就会在屏幕上看到“a”。我们按下键盘的a键，这个按键的信息被送入计算机，计算机用ASCII码的规则对其进行编码，将其转化为61H存储在内存的指定空间中；文本编辑软件从内存中取出61H，将其送到显卡上的显存中；工作在文本模式下的显卡，用ASCII码的规则解释显存中的内容</mark></strong></li>
<li><strong><mark>61H被当作字符“a”，显卡驱动显示器将字符“a”的图像画在屏幕上。我们可以看到，显卡在处理文本信息的时候，是按照ASCII码的规则进行的。这也就是说，如果我们要想在显示器上看到“a”，就要给显卡提供“a”的ASCII码，61H。如何提供？当然是写入显存中</mark></strong></li>
</ol>
<p><strong><mark>比如：</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code<span class="token punctuation">,</span>ds<span class="token operator">:</span>data 

data segment 
	db <span class="token char">'unIx'</span>   <span class="token punctuation">;</span>相当于“db <span class="token number">75</span>H，<span class="token number">6</span>EH，<span class="token number">49</span>H，<span class="token number">58</span>H”
	db <span class="token char">'foRK'</span>
data ends 

code segment
start<span class="token operator">:</span>	mov al<span class="token punctuation">,</span> <span class="token char">'a'</span>  <span class="token punctuation">;</span>相当于“mov al<span class="token punctuation">,</span> <span class="token number">61</span>H”，“a”的ASCI码为<span class="token number">61</span>H；
		mov b1<span class="token punctuation">,</span> <span class="token char">'b'</span>

		mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
		<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>关于字符在内存中大小写转换的问题：</font></strong></p>
<ol>
<li><strong><code>小写字母的ASCII码值比大写字母的ASCII码值大20H</code></strong></li>
<li><strong><code>大写字母ASCII码的第5位为0，小写字母的第5位为1(其他一致)，大小写相差32，即2^5。注：这里的位数是从0开始计算的</code></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010141730980.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010141730980.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010141730980">

<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>codesg<span class="token punctuation">,</span>ds<span class="token operator">:</span>datasg 

datasg segment 
	db <span class="token char">'BaSiC'</span>
	db <span class="token char">'iNfOrMaTion'</span>
datasg end

codesg segment 
	start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span> datasg 
			mov ds<span class="token punctuation">,</span> ax	<span class="token punctuation">;</span>设置ds 指向 datasg段

			mov bx<span class="token punctuation">,</span> <span class="token number">0</span>	<span class="token punctuation">;</span>设置（bx）<span class="token operator">=</span><span class="token number">0</span>，ds<span class="token operator">:</span>bx指向’BaSic’的第一个字母

			mov cx<span class="token punctuation">,</span> <span class="token number">5</span>     	 <span class="token punctuation">;</span>设置循环次数<span class="token number">5</span>，因为’Basic'有<span class="token number">5</span>个字母
	s<span class="token operator">:</span>		mov al<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token punctuation">]</span>     <span class="token punctuation">;</span>将ASCII码从ds<span class="token operator">:</span>bx所指向的单元中取出
			and al<span class="token punctuation">,</span> <span class="token number">11011111</span>B<span class="token punctuation">;</span>将al中的ASCII码的第<span class="token number">5</span>位置为<span class="token number">0</span>，变为大写字母
			mov <span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token punctuation">,</span> al	 <span class="token punctuation">;</span>将转变后的ASCII码写回原单元
			inc bx		     <span class="token punctuation">;</span>（bx）加<span class="token number">1</span>，ds<span class="token operator">:</span>bx指向下一个字母
			loop s 

			mov bx<span class="token punctuation">,</span> <span class="token number">5</span>	<span class="token punctuation">;</span>设置（bx）<span class="token operator">=</span><span class="token number">5</span>，ds<span class="token operator">:</span>bx指向，iNfOrMaTion'的第一个字母

			mov cx<span class="token punctuation">,</span> <span class="token number">11</span>	<span class="token punctuation">;</span>设置循环次数<span class="token number">11</span>，因为‘iNfOrMaTion'有<span class="token number">11</span>个字母
	s0<span class="token operator">:</span>		mov al<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
			or al<span class="token punctuation">,</span> <span class="token number">00100000</span>B<span class="token punctuation">;</span>将a1中的ASCII码的第<span class="token number">5</span>位置为<span class="token number">1</span>，变为小写字母
			mov <span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token punctuation">,</span> al 
			inc bx
			loop s0

			mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
			<span class="token keyword">int</span> <span class="token number">21</span>h 
codesg ends<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="bx-idata"><a href="#bx-idata" class="headerlink" title="[bx+idata]"></a><strong>[bx+idata]</strong></h3><blockquote>
<p><strong><font color=red>[bx+idata]表示一个内存单元, 例如：<code>mov ax, [bx+200]</code>，该指令也可以写成如下格式：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">200</span><span class="token operator">+</span>bx<span class="token punctuation">]</span> <span class="token punctuation">;</span>将一个内存单元内容送入ax，这个内存单元的长度为<span class="token number">2</span>个字节，偏移地址为bx中的数值加上<span class="token number">200</span>，段地址在ds中<span class="token punctuation">,</span>即<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ds<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">)</span>

mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">]</span>	 <span class="token punctuation">;</span>其他格式

mov ax<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>  <span class="token punctuation">;</span>其他格式

mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token number">.200</span> <span class="token punctuation">;</span>其他格式

<span class="token punctuation">;</span>案例<span class="token operator">:</span>用Debug查看内存，结果如下
<span class="token punctuation">;</span><span class="token number">2000</span><span class="token operator">:</span><span class="token number">1000</span>H BE <span class="token number">00</span> <span class="token number">06</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

mov ax<span class="token punctuation">,</span><span class="token number">2000</span>H	
mov ds<span class="token punctuation">,</span>ax
mov bx<span class="token punctuation">,</span><span class="token number">1000</span>H
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>		<span class="token punctuation">;</span>段地址<span class="token operator">:</span><span class="token punctuation">(</span>ds<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2000</span>H 偏移地址<span class="token operator">:</span><span class="token punctuation">(</span>bx<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1000</span>H  则<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">00</span>BEH
mov cx<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>	<span class="token punctuation">;</span>段地址<span class="token operator">:</span><span class="token punctuation">(</span>ds<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2000</span>H 偏移地址<span class="token operator">:</span><span class="token punctuation">(</span>bx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1001</span>H 则<span class="token punctuation">(</span>cx<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0600</span>H
add cx<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>	<span class="token punctuation">;</span>段地址<span class="token operator">:</span><span class="token punctuation">(</span>ds<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2000</span>H 偏移地址<span class="token operator">:</span><span class="token punctuation">(</span>bx<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1002</span>H 则<span class="token punctuation">(</span>cx<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0606</span>H<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>用[bx+idata]的方式进行数组的处理：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>codesg<span class="token punctuation">,</span>ds<span class="token operator">:</span>datasg 

datasg segment 
	db <span class="token char">'BaSiC'</span><span class="token punctuation">;</span>转为大写
	db <span class="token char">'MinIx'</span><span class="token punctuation">;</span>转为小写
datasg ends

codesg segment
	start<span class="token operator">:</span>
		mov ax<span class="token punctuation">,</span> datasg 
		mov ds<span class="token punctuation">,</span> ax 
		mov bx<span class="token punctuation">,</span> <span class="token number">0</span>  			<span class="token punctuation">;</span>初始ds<span class="token operator">:</span>bx

		mov cx<span class="token punctuation">,</span> <span class="token number">5</span>
	s<span class="token operator">:</span>	mov al<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>  
		and al<span class="token punctuation">,</span> <span class="token number">11011111</span>b 	<span class="token punctuation">;</span>转为大写字母
		mov <span class="token number">0</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token punctuation">,</span> al 		<span class="token punctuation">;</span>写回
		mov al<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>  		<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">+</span> bx<span class="token punctuation">]</span>
		or al<span class="token punctuation">,</span> <span class="token number">00100000</span>b 	<span class="token punctuation">;</span>转为小写字母
		mov <span class="token number">5</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token punctuation">,</span> al 
		inc bx
		loop s

		mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
		<span class="token keyword">int</span> <span class="token number">21</span>h
codesg ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>C语言描述方式：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"BaSic"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"MinIX"</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">do</span>
	<span class="token punctuation">&#123;</span>
		a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xDF</span><span class="token punctuation">;</span>
		b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token number">0x20</span><span class="token punctuation">;</span>
		i<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="SI、DI与寻址方式的灵活应用"><a href="#SI、DI与寻址方式的灵活应用" class="headerlink" title="SI、DI与寻址方式的灵活应用"></a><strong>SI、DI与寻址方式的灵活应用</strong></h3><blockquote>
<ol>
<li><p><strong><font color=red>si和di是8086CPU中和bx功能相近的寄存器，si和di不能够分成两个8位寄存器来使用</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span> codesg<span class="token punctuation">,</span> ds<span class="token operator">:</span> datasg 
               
datasg segment 
	db <span class="token char">'welcome to masm!'</span> <span class="token punctuation">;</span>用si和di实现将字符串‘welcome to masm！"复制到它后面的数据区中。
	db <span class="token char">'................'</span> <span class="token punctuation">;</span>db是ding'y
datasg ends
               
codesg segment 
	start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span> datasg 
			mov ds<span class="token punctuation">,</span> ax 
			mov si<span class="token punctuation">,</span> <span class="token number">0</span>
               
			mov cx<span class="token punctuation">,</span> <span class="token number">8</span>
	s<span class="token operator">:</span>		mov ax<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">[</span>si<span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">+</span> si<span class="token punctuation">]</span>
			mov <span class="token number">16</span><span class="token punctuation">[</span>si<span class="token punctuation">]</span><span class="token punctuation">,</span> ax <span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">16</span> <span class="token operator">+</span> si<span class="token punctuation">]</span> 使用<span class="token punctuation">[</span>bx <span class="token operator">+</span>idata<span class="token punctuation">]</span>方式代替di，使程序更简洁
			add si<span class="token punctuation">,</span> <span class="token number">2</span> 
			loop s 
               
			mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h 
			<span class="token keyword">int</span> <span class="token number">21</span>h 
codesg ends 
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p><strong><font color=red>[bx+si]和[bx+di]的含义相似：</font></strong></p>
<ol>
<li><strong>[bx+si]表示一个内存单元，它的偏移地址为（bx）+（si）</strong></li>
<li><strong>指令<code>mov ax, [bx + si]</code>的含义：将一个内存单元字数据的内容送入ax，段地址在ds中</strong></li>
<li><strong>该指令也可以写成如下格式：<code>mov ax, [bx][si]</code></strong></li>
</ol>
</li>
<li><p><strong><font color=red>[bx+si+idata]和[bx+di+idata]：</font></strong></p>
<ol>
<li>[bx+si+idata]表示一个内存单元，它的偏移地址为（bx）+（si）+idata</li>
<li>指令<code>mov ax，[bx+si+idata]</code>的含义：将一个内存单元字数据的内容送入ax，段地址在ds中</li>
</ol>
</li>
<li><p><strong><font color=red>不同的寻址方式的灵活应用</font></strong></p>
<ol>
<li><code>[idata]</code>用一个常量来表示地址，可用于直接定位一个内存单元</li>
<li><code>[bx]</code>用一个变量来表示内存地址，可用于间接定位一个内存单元</li>
<li><code>[bx+idata]</code>用一个变量和常量表示地址，可在一个起始地址的基础上用变量间接定位一个内存单元</li>
<li><code>[bx+si]</code>用两个变量表示地址</li>
<li><code>[bx+si+idata]</code>用两个变量和一个常量表示地址</li>
</ol>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>将datasg段中每个单词改为大写字母
assume cs<span class="token operator">:</span>codesg<span class="token punctuation">,</span>ds<span class="token operator">:</span>datasg<span class="token punctuation">,</span>ss<span class="token operator">:</span>stacksg 

datasg segment
	db <span class="token char">'ibm            '</span> <span class="token punctuation">;</span><span class="token number">16</span>
	db <span class="token char">'dec            '</span> 
	db <span class="token char">'dos            '</span>
	db <span class="token char">'vax            '</span>  <span class="token punctuation">;</span>看成二维数组
datasg ends 

stacksg segment <span class="token punctuation">;</span>定义一个段，用来做栈段，容量为<span class="token number">16</span>个字节
	dw <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
stacksg ends 

codesg segment 
	start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span> stacksg 
			mov ss<span class="token punctuation">,</span> ax
			mov sp<span class="token punctuation">,</span> <span class="token number">16</span> 
			mov ax<span class="token punctuation">,</span> datasg 
			mov ds<span class="token punctuation">,</span> ax 
			mov bx<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">;</span>初始ds<span class="token operator">:</span>bx

			<span class="token punctuation">;</span>cx为默认循环计数器，二重循环只有一个计数器，所以外层循环先保存cx值，再恢复，我们采用栈保存
			mov cx<span class="token punctuation">,</span> <span class="token number">4</span>
	s0<span class="token operator">:</span>		push cx	<span class="token punctuation">;</span>将外层循环的cx值入栈
			mov si<span class="token punctuation">,</span> <span class="token number">0</span>
			mov cx<span class="token punctuation">,</span> <span class="token number">3</span>	<span class="token punctuation">;</span>cx设置为内层循环的次数
	s<span class="token operator">:</span>		mov al<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token punctuation">]</span>
			and al<span class="token punctuation">,</span> <span class="token number">11011111</span>b <span class="token punctuation">;</span>每个字符转为大写字母
			mov <span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token punctuation">]</span><span class="token punctuation">,</span> al 
			inc si
			loop s 

			add bx<span class="token punctuation">,</span> <span class="token number">16</span> <span class="token punctuation">;</span>下一行
			pop cx	<span class="token punctuation">;</span>恢复cx值
			loop s0 <span class="token punctuation">;</span>外层循环的loop指令将cx中的计数值减<span class="token number">1</span>

			mov ax，<span class="token number">4</span>c00H 
			<span class="token keyword">int</span> <span class="token number">21</span>H 
codesg ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h2 id="第六章：数据处理的两个基本问题"><a href="#第六章：数据处理的两个基本问题" class="headerlink" title="第六章：数据处理的两个基本问题"></a>第六章：数据处理的两个基本问题</h2><h3 id="bx、si、di和bp寄存器"><a href="#bx、si、di和bp寄存器" class="headerlink" title="bx、si、di和bp寄存器"></a><strong>bx、si、di和bp寄存器</strong></h3><blockquote>
<ol>
<li><strong><font color=red>在8086CPU中，只有这4个寄存器可以用在“[…]”中来进行内存单元的寻址</font></strong></li>
<li><strong>在[ ]中，这4个寄存器可以单个出现，或只能以4种组合出现：<code>bx和si、bx和di</code>、<code>bp和si、bp和di</code></strong></li>
<li><strong><mark>只要在[……]中使用寄存器bp，而指令中没有显性地给出段地址, 段地址就默认在ss中</mark></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>合法
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bx<span class="token operator">+</span>di<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token operator">+</span>si<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token operator">+</span>di<span class="token punctuation">]</span>

<span class="token punctuation">;</span>不合法
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>cx<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>ax<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>dx<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>ds<span class="token punctuation">]</span>

<span class="token punctuation">;</span>特殊：使用bp寄存器，如果指令中没有显性给出段地址，段地址就默认在ss寄存器中
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token punctuation">]</span>				<span class="token punctuation">;</span>含义：<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span><span class="token punctuation">(</span>bp<span class="token punctuation">)</span><span class="token punctuation">)</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token operator">+</span>idata<span class="token punctuation">]</span>		<span class="token punctuation">;</span>含义：<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span><span class="token punctuation">(</span>bp<span class="token punctuation">)</span><span class="token operator">+</span>idata<span class="token punctuation">)</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token operator">+</span>si<span class="token punctuation">]</span>			<span class="token punctuation">;</span>含义：<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span><span class="token punctuation">(</span>bp<span class="token punctuation">)</span><span class="token operator">+</span>si<span class="token punctuation">)</span>
mov ax<span class="token punctuation">,</span><span class="token punctuation">[</span>bp<span class="token operator">+</span>si<span class="token operator">+</span>idata<span class="token punctuation">]</span>	<span class="token punctuation">;</span>含义：<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16</span><span class="token operator">+</span><span class="token punctuation">(</span>bp<span class="token punctuation">)</span><span class="token operator">+</span>si<span class="token operator">+</span>idata<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="机器指令处理的数据在什么地方"><a href="#机器指令处理的数据在什么地方" class="headerlink" title="机器指令处理的数据在什么地方"></a><strong>机器指令处理的数据在什么地方</strong></h3><blockquote>
<ol>
<li><strong>数据处理大致可分为3类：<mark>读取、写入、运算</mark></strong></li>
<li><strong>在机器指令这一层来讲，并不关心数据的值是多少，而关心指令执行前一刻，它将要处理的数据所在的位置。指令在执行前，所要处理的数据可以在3个地方：CPU内部、内存、端口</strong></li>
</ol>
</blockquote>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010160745001.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010160745001.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010160745001">

<hr>
<h3 id="汇编语言中数据位置的表达"><a href="#汇编语言中数据位置的表达" class="headerlink" title="汇编语言中数据位置的表达"></a><strong>汇编语言中数据位置的表达</strong></h3><blockquote>
<p><strong>汇编语言中用3个概念来表达数据的位置：立即数、寄存器、段地址(SA)和偏低地址(EA)</strong></p>
<ol>
<li><p>立即数</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> <span class="token number">1</span>                 <span class="token punctuation">;</span>对于直接包含在机器指令中的数据（执行前在CPU的指令缓冲器中）
add bx<span class="token punctuation">,</span> <span class="token number">2000</span>h             <span class="token punctuation">;</span>在汇编语言中称为：立即数（idata）
or bx<span class="token punctuation">,</span> <span class="token number">00010000</span>b
mov al<span class="token punctuation">,</span> <span class="token char">'a'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>寄存器</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> bx     <span class="token punctuation">;</span>指令要处理的数据在寄存器中，在汇编指令中给出相应的寄存器名。
mov ds<span class="token punctuation">,</span> ax 
push bx 
mov ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bx 
push ds 
mov ss<span class="token punctuation">,</span> ax
mov sp<span class="token punctuation">,</span> ax<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p>段地址(SA)和偏低地址(EA)</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>指令要处理的数据在内存中，在汇编指令中可用<span class="token punctuation">[</span>X<span class="token punctuation">]</span>的格式给出EA，SA在某个段寄存器中。
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>di<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>   <span class="token punctuation">;</span>以上段地址默认在ds中
            
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bp<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bp<span class="token operator">+</span>si<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span>bp<span class="token operator">+</span>si<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>   <span class="token punctuation">;</span>以上段地址默认在ss中
            
mov ax<span class="token punctuation">,</span> ds<span class="token operator">:</span><span class="token punctuation">[</span>bp<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> es<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> ss<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token punctuation">]</span>
mov ax<span class="token punctuation">,</span> cs<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token operator">+</span>si<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>显式给出存放段地址的寄存器<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</blockquote>
<hr>
<h3 id="寻址方式"><a href="#寻址方式" class="headerlink" title="寻址方式"></a><strong>寻址方式</strong></h3><img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010160745002.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010160745002.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010160745002">

<hr>
<h3 id="指令要处理的数据有多长"><a href="#指令要处理的数据有多长" class="headerlink" title="指令要处理的数据有多长"></a><strong>指令要处理的数据有多长</strong></h3><blockquote>
<p><strong><font color=red>8086CPU的指令，可以处理两种尺寸的数据，byte和word，处理情况如下：</font></strong></p>
<p><strong>注：<code>word ptr</code><mark>表示指令访问的内存单元是两个字节单元</mark>，<code>byte ptr</code><mark>表示指令访问的内存单元式一个字节单元</mark>，这是强制定义为字大小</strong></p>
<ol>
<li><strong><font color=red>通过寄存器名指明要处理的数据的尺寸</font></strong><ul>
<li><strong>例如：<code>mov al, ds:[0]</code> 寄存器al指明了数据为1字节</strong></li>
</ul>
</li>
<li><strong><font color=red>在没有寄存器名存在的情况下，用操作符<code>X ptr</code>指明内存单元的长度，X在汇编指令中可以为<code>word</code>或<code>byte</code></font></strong><ul>
<li><strong>例如：<code>mov byte ptr ds:[0], 1</code> byte ptr 指明了指令访问的内存单元是一个字节单元</strong></li>
</ul>
</li>
<li><strong><font color=red>有些指令默认了访问的是字单元还是字节单元</font></strong><ul>
<li><strong>例如，<code>push [1000H]</code>，push 指令只进行字操作</strong></li>
</ul>
</li>
</ol>
</blockquote>
<hr>
<h3 id="寻址方式的综合应用"><a href="#寻址方式的综合应用" class="headerlink" title="寻址方式的综合应用"></a><strong>寻址方式的综合应用</strong></h3><img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010160745003.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010160745003.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010160745003">

<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> seg 
mov ds<span class="token punctuation">,</span> ax 
mov bx<span class="token punctuation">,</span> <span class="token number">60</span>h   					<span class="token punctuation">;</span>确定记录地址，ds<span class="token operator">:</span>bx 

<span class="token punctuation">;</span>word ptr：指明访问的内存单元是两个字节单元
<span class="token punctuation">;</span>byte ptr：指明访问的内存单元是一个字节单元
    
mov word ptr <span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">0</span>CH<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">38</span>   	<span class="token punctuation">;</span>排名字段改为<span class="token number">38</span>  <span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token number">.0</span>Ch
add word ptr <span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">0</span>EH<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">70</span>   	<span class="token punctuation">;</span>收入字段增加<span class="token number">70</span>  <span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token number">.0</span>Eh
mov si<span class="token punctuation">,</span> <span class="token number">0</span>   					<span class="token punctuation">;</span>用si来定位产品字符串中的字符
mov byte ptr <span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">10</span>H<span class="token operator">+</span>si<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token char">'V'</span>   <span class="token punctuation">;</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token number">.10</span>H<span class="token punctuation">[</span>si<span class="token punctuation">]</span>
inc si 
mov byte ptr <span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">10</span>H<span class="token operator">+</span>si<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token char">'A'</span>
inc si 
mov byte ptr <span class="token punctuation">[</span>bx<span class="token operator">+</span><span class="token number">10</span>H<span class="token operator">+</span>si<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token char">'X'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>C语言描述方式：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/*定义一个公司记录的结构体*/</span>
<span class="token keyword">struct</span> <span class="token class-name">company</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> cn<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/*公司名称*/</span>
    <span class="token keyword">char</span> hn<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/*总裁姓名*/</span>
    <span class="token keyword">int</span> pm<span class="token punctuation">;</span><span class="token comment">/*排名*/</span>
    <span class="token keyword">int</span> sr<span class="token punctuation">;</span><span class="token comment">/*收入*/</span>
    <span class="token keyword">char</span> cp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">/*著名产品*/</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">//sizeof (struct company) == 24</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">/*定义一个公司记录的变量，内存中将存有一条公司的记录*/</span>
    <span class="token keyword">struct</span> <span class="token class-name">company</span> dec <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"DEC"</span><span class="token punctuation">,</span> <span class="token string">"Ken Olsen"</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">"PDP"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> i<span class="token punctuation">;</span>

    dec<span class="token punctuation">.</span>pm <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">;</span>
    dec<span class="token punctuation">.</span>sr <span class="token operator">=</span> dec<span class="token punctuation">.</span>sr <span class="token operator">+</span> <span class="token number">70</span><span class="token punctuation">;</span>

    i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    dec<span class="token punctuation">.</span>cp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'V'</span><span class="token punctuation">;</span> <span class="token comment">//mov byte ptr [bx].10h[si], 'V'</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
    dec<span class="token punctuation">.</span>cp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'A'</span><span class="token punctuation">;</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
    dec<span class="token punctuation">.</span>cp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'X'</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="div指令、伪指令dd、dup、mul指令"><a href="#div指令、伪指令dd、dup、mul指令" class="headerlink" title="div指令、伪指令dd、dup、mul指令"></a><strong>div指令、伪指令dd、dup、mul指令</strong></h3><blockquote>
<p><strong><font color=red>div是除法指令：</font></strong></p>
<ol>
<li><strong><mark>除数</mark>：有8位和16位两种，在一个<code>寄存器（reg）</code>或<code>内存单元</code>中</strong></li>
<li><strong><mark>被除数</mark>：默认放在<code>AX</code>或<code>DX</code>和<code>AX</code>中，如果除数为8位，被除数则为16位，默认在AX中存放；如果除数为16位，被除数则为32位，在DX和AX中存放，DX存放高16位，AX存放低16位</strong></li>
<li><strong><mark>结果</mark>：如果除数为8位，则<code>AL存储除法操作的商</code>，<code>AH存储除法操作的余数</code>；如果除数为16位，则AX存储除法操作的商，DX存储除法操作的余数</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>利用除法指令计算<span class="token number">100001</span><span class="token operator">/</span><span class="token number">100</span>
<span class="token punctuation">;</span><span class="token number">100001</span>D <span class="token operator">=</span> <span class="token number">186</span>A1H

mov dx<span class="token punctuation">,</span> <span class="token number">1</span>
mov ax<span class="token punctuation">,</span> <span class="token number">86</span>A1H 	<span class="token punctuation">;</span><span class="token punctuation">(</span>dx<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10000</span>H<span class="token operator">+</span><span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">100001</span>
mov bx<span class="token punctuation">,</span> <span class="token number">100</span>
div bx

<span class="token punctuation">;</span>利用除法指令计算<span class="token number">1001</span><span class="token operator">/</span><span class="token number">100</span>
mov ax<span class="token punctuation">,</span> <span class="token number">1001</span>
mov bl<span class="token punctuation">,</span> <span class="token number">100</span>
div b1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p><strong><font color=red>伪指令dd：</font></strong></p>
<ol>
<li><strong>db和dw定义字节型数据和字型数据</strong></li>
<li><strong>dd是用来定义dword（double word，双字）型数据的伪指令</strong></li>
</ol>
<hr>
<p><strong><font color=red>操作符dup指令：</font></strong></p>
<ol>
<li><strong>dup在汇编语言中同db、dw、dd等一样，也是由编译器识别处理的符号</strong></li>
<li><strong>它和db、dw、dd等数据定义伪指令配合使用，用来进行数据的重复</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">db <span class="token number">3</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>       		<span class="token punctuation">;</span>定义了<span class="token number">3</span>个字节，它们的值都是<span class="token number">0</span>，相当于db <span class="token number">0</span>，<span class="token number">0</span>，<span class="token number">0</span>。
db <span class="token number">3</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> 		<span class="token punctuation">;</span>定义了<span class="token number">9</span>个字节，它们是<span class="token number">0</span>、<span class="token number">1</span>、<span class="token number">2</span>、<span class="token number">0</span>、<span class="token number">1</span>、<span class="token number">2</span>、<span class="token number">0</span>、<span class="token number">1</span>、<span class="token number">2</span>，相当于db <span class="token number">0</span>，<span class="token number">1</span>，<span class="token number">2</span>，<span class="token number">0</span>，<span class="token number">1</span>，<span class="token number">2</span>，<span class="token number">0</span>，<span class="token number">1</span>，<span class="token number">2</span>。
db <span class="token number">3</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token char">'abc'</span><span class="token punctuation">,</span> <span class="token char">'ABC'</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>定义了<span class="token number">18</span>个字节，它们是abcABCabcABCabcABCC，相当于db <span class="token char">'abc'</span><span class="token punctuation">,</span> <span class="token char">'ABC'</span> <span class="token punctuation">,</span><span class="token char">'abc'</span> <span class="token punctuation">,</span> <span class="token char">'ABC, '</span>abc<span class="token char">', '</span>ABC'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<p><strong><font color=red>mul指令：</font></strong></p>
<ol>
<li>mul是乘法指令，使用 mul 做乘法的时候：相乘的两个数：要么都是8位，要么都是16位<ul>
<li>8 位： <code>AL</code>中和 <code>8位寄存器</code>或<code>内存字节单元</code>中</li>
<li>16 位： <code>AX</code>中和 <code>16 位寄存器</code>或<code>内存字单元</code>中</li>
</ul>
</li>
<li>结果：<ul>
<li>8位：AX中</li>
<li>16位：DX（高位）和 AX（低位）中</li>
</ul>
</li>
<li>格式：<code>mul 寄存器</code> 或 <code>mul 内存单元</code>：</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>计算<span class="token number">100</span><span class="token operator">*</span><span class="token number">10</span>
<span class="token punctuation">;</span><span class="token number">100</span>和<span class="token number">10</span>小于<span class="token number">255</span>，可以做<span class="token number">8</span>位乘法
<span class="token punctuation">;</span>结果： <span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1000</span>（<span class="token number">03E8</span>H） 

mov al<span class="token punctuation">,</span><span class="token number">100</span>
mov bl<span class="token punctuation">,</span><span class="token number">10</span>
mul bl   <span class="token punctuation">;</span><span class="token number">8</span>位cu<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h2 id="第七章：转移指令的原理"><a href="#第七章：转移指令的原理" class="headerlink" title="第七章：转移指令的原理"></a>第七章：转移指令的原理</h2><h3 id="转移指令概念"><a href="#转移指令概念" class="headerlink" title="转移指令概念"></a><strong>转移指令概念</strong></h3><p><strong><code>转移指令概念</code>：<mark>可以修改IP，或同时修改CS和IP的指令统称为转移指令</mark>。概括地讲，转移指令就是可以控制CPU执行内存中某处代码的指令</strong></p>
<blockquote>
<p><strong><font color=red>8086CPU的<mark>转移行为</mark>有以下几类:</font></strong></p>
<ol>
<li><strong>只修改IP时，称为<code>段内转移</code>，比如：<code>jmp ax</code></strong></li>
<li><strong>同时修改CS和IP时，称为<code>段间转移</code>，比如：<code>jmp 1000:0</code></strong></li>
</ol>
<p><strong><font color=red>由于转移指令对IP的<mark>修改范围</mark>不同，段内转移又分为：<code>短转移和近转移</code></font></strong></p>
<ol>
<li><strong>短转移IP的修改范围为<code>-128 ~ 127</code></strong></li>
<li><strong>近转移IP的修改范围为<code>-32768 ~ 32767</code></strong></li>
</ol>
<p><strong><font color=red>8086CPU的<mark>转移指令</mark>分为以下几类:</font></strong></p>
<ol>
<li><strong>无条件转移指令（如：jmp）</strong></li>
<li><strong>条件转移指令</strong></li>
<li><strong>循环指令（如：loop）</strong></li>
<li><strong>过程</strong></li>
<li><strong>中断</strong></li>
</ol>
</blockquote>
<hr>
<h3 id="操作符offset"><a href="#操作符offset" class="headerlink" title="操作符offset"></a><strong>操作符offset</strong></h3><blockquote>
<p><strong><font color=red>操作符offset在汇编语言中是由编译器处理的符号，它的功能是取得标号的偏移地址</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>将s处的一条指令复制到s0处
<span class="token punctuation">;</span>s和s0是标号

assume cs<span class="token operator">:</span>codesg
codesg segment
s<span class="token operator">:</span>   mov ax<span class="token punctuation">,</span> bx           <span class="token punctuation">;</span>（mov ax<span class="token punctuation">,</span>bx 的机器码占两个字节）
mov si<span class="token punctuation">,</span> offset s     <span class="token punctuation">;</span>获得标号s的偏移地址
mov di<span class="token punctuation">,</span> offset s0    <span class="token punctuation">;</span>获得标号s0的偏移地址

mov ax<span class="token punctuation">,</span> cs<span class="token operator">:</span><span class="token punctuation">[</span>si<span class="token punctuation">]</span>
mov cs<span class="token operator">:</span><span class="token punctuation">[</span>di<span class="token punctuation">]</span><span class="token punctuation">,</span> ax
s0<span class="token operator">:</span>  nop                     <span class="token punctuation">;</span>（nop的机器码占一个字节）
nop
codesg ends
ends<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="jmp指令"><a href="#jmp指令" class="headerlink" title="jmp指令"></a><strong>jmp指令</strong></h3><blockquote>
<ol>
<li><strong>jmp为无条件转移，转到标号处执行指令可以只修改IP，也可以同时修改CS和IP</strong></li>
<li><strong><mark>jmp指令要给出两种信息：</mark></strong><ul>
<li><strong><font color=red>转移的目的地址</font></strong></li>
<li><strong><font color=red>转移的距离（段间转移、段内短转移，段内近转移）</font></strong></li>
</ul>
</li>
<li><strong><code>jmp short 标号</code> <code>jmp near ptr 标号</code> <code>jcxz 标号</code> <code>loop 标号</code> 等几种汇编指令，它们对IP的修改是根据转移目的地址和转移起始地址之间的位移来进行的。在它们对应的机器码中不包含转移的目的地址，而包含的是到目的地址的位移距离</strong></li>
<li><strong><mark>jmp中的short</mark>符号说明指令进行的是<code>段内短转移</code>,修改范围-128~127</strong></li>
<li><strong><mark>jmp中的near ptr</mark>符号说明指令进行的是<code>段内近转移</code>，修改范围-128~127</strong></li>
<li><strong><mark>jmp far ptr</mark>符号说明指令进行的是<code>段间转移</code>，修改范围-32768~32767</strong></li>
</ol>
</blockquote>
<hr>
<h4 id="依据位移进行转移的jmp指令"><a href="#依据位移进行转移的jmp指令" class="headerlink" title="依据位移进行转移的jmp指令"></a><strong>依据位移进行转移的jmp指令</strong></h4><blockquote>
<p><strong><font color=red>第一种指令：jmp short 标号</font></strong></p>
<p><strong>指令“<code>jmp short 标号(段内短转移)</code>”的功能为<code>(IP)=(IP)+8位位移</code>，转到标号处执行指令，其理解为：</strong></p>
<ol>
<li><strong>8位位移 &#x3D; “标号”处的地址 - jmp指令后的第一个字节的地址</strong></li>
<li><strong>short指明此处的位移为8位位移</strong></li>
<li><strong>8位位移的范围为-128~127，用补码表示</strong></li>
<li><strong>8位位移由编译程序在编译时算出</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>codesg
codesg segment
  start<span class="token operator">:</span>mov ax<span class="token punctuation">,</span><span class="token number">0</span>
        jmp <span class="token keyword">short</span> s <span class="token punctuation">;</span>s不是被翻译成目的地址
        add ax<span class="token punctuation">,</span> <span class="token number">1</span>
      s<span class="token operator">:</span>inc ax <span class="token punctuation">;</span>程序执行后， ax中的值为 <span class="token number">1</span> 
codesg ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>CPU不需要这个目的地址就可以实现对IP的修改。这里是依据位移进行转移</strong></p>
<p><strong><font color=red>对于jmp short s指令的读取和执行过程的理解：</font></strong></p>
<ol>
<li><strong>(CS)&#x3D;0BBDH，(IP)&#x3D;0006，上一条指令执行结束后CS:IP指向EB 03（jmp short s的机器码）</strong></li>
<li><strong>读取指令码EB 03进入指令缓冲器</strong></li>
<li><strong>(IP) &#x3D; (IP) + 所读取指令的长度 &#x3D; (IP) + 2 &#x3D; 0008，CS:IP指向add ax,1</strong></li>
<li><strong>CPU指行指令缓冲器中的指令EB 03</strong></li>
<li><strong>指令EB 03执行后，(IP)&#x3D;000BH，CS:IP指向inc ax</strong></li>
</ol>
<p><strong><font color=red>第二种指令：jmp near ptr 标号</font></strong></p>
<p><strong>指令“<code>jmp near ptr 标号(段内近转移)</code>”的功能为：<code>(IP) = (IP) + 16位位移</code></strong></p>
</blockquote>
<hr>
<h4 id="转移的目的地址在指令中的jmp指令"><a href="#转移的目的地址在指令中的jmp指令" class="headerlink" title="转移的目的地址在指令中的jmp指令"></a><strong>转移的目的地址在指令中的jmp指令</strong></h4><blockquote>
<p><font color=red>第三种指令：jmp far ptr 标号</font></p>
<p><strong>指令 “<code>jmp far ptr 标号（段间转移或远转移）</code>” 功能如下：</strong></p>
<ol>
<li><strong>(CS) &#x3D; 标号所在段的段地址</strong></li>
<li><strong>(IP) &#x3D; 标号所在段中的偏移地址</strong></li>
<li><strong>far ptr指明了指令用标号的段地址和偏移地址修改CS和IP</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>codesg
codesg segment
   start<span class="token operator">:</span> mov ax<span class="token punctuation">,</span> <span class="token number">0</span>
		  mov bx<span class="token punctuation">,</span> <span class="token number">0</span>
          jmp far ptr  s <span class="token punctuation">;</span>s被翻译成转移的目的地址<span class="token number">0</span>B01 BD0B
          db <span class="token number">256</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>转移的段地址：<span class="token number">0</span>BBDH，偏移地址：<span class="token number">010</span>BH
    s<span class="token operator">:</span>    add ax<span class="token punctuation">,</span><span class="token number">1</span>
          inc ax
codesg ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010165100837.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010165100837.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010165100837">
</blockquote>
<hr>
<h4 id="转移地址在寄存器或内存中的jmp指令"><a href="#转移地址在寄存器或内存中的jmp指令" class="headerlink" title="转移地址在寄存器或内存中的jmp指令"></a><strong>转移地址在寄存器或内存中的jmp指令</strong></h4><blockquote>
<p><strong><font color=red>第四种指令：jmp word ptr 内存单元地址(段内转移)</font></strong></p>
<p><strong>jmp 16位寄存器<code> 功能：</code>IP &#x3D;（16位寄存器）</strong></p>
<p>转移地址在内存中的jmp指令有两种格式：</p>
<ol>
<li><p><code>jmp word ptr 内存单元地址</code>（段内转移）</p>
<ul>
<li><p>功能：从内存单元地址处开始存放着一个字，是转移的目的偏移地址</p>
</li>
<li><pre><code class="c">mov ax, 0123H
mov ds:[0], ax
jmp word ptr ds:[0]
        
;执行后，(IP)=0123H
<pre class="line-numbers language-none"><code class="language-none">
2. &#96;jmp dword ptr 内存单元地址&#96;（段间转移）

   - 功能：从内存单元地址处开始存放着两个字，高地址处的字是转移的目的段地址，低地址处是转移的目的偏移地址

   - (CS)&#x3D;(内存单元地址+2)

   - (IP)&#x3D;(内存单元地址)

   - &#96;&#96;&#96;c
     mov ax, 0123H
     mov ds:[0], ax;偏移地址
     mov word ptr ds:[2], 0;段地址
     jmp dword ptr ds:[0]
                         
     ;执行后，
     ;(CS)&#x3D;0
     ;(IP)&#x3D;0123H
     ;CS:IP 指向 0000:0123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
</ul>
</li>
</ol>
</blockquote>
<hr>
<h4 id="jcxz指令和loop指令"><a href="#jcxz指令和loop指令" class="headerlink" title="jcxz指令和loop指令"></a><strong>jcxz指令和loop指令</strong></h4><blockquote>
<p><strong><font color=red>jcxz指令详解：</font></strong></p>
<ol>
<li><strong>jcxz指令为有条件转移指令，所有的有条件转移指令都是短转移</strong></li>
<li><strong>在对应的机器码中包含转移的位移，而不是目的地址。对IP的修改范围都为-128~127</strong></li>
<li><strong>指令格式：<code>jcxz 标号</code>（如果(cx)&#x3D;0，则转移到标号处执行）</strong></li>
<li><strong>当(cx) &#x3D; 0时，(IP) &#x3D; (IP) + 8位位移</strong><ul>
<li><strong>8位位移 &#x3D; “标号”处的地址 - jcxz指令后的第一个字节的地址</strong></li>
<li><strong>8位位移的范围为-128~127，用补码表示</strong></li>
<li><strong>8位位移由编译程序在编译时算出</strong></li>
</ul>
</li>
<li><strong>当(cx)!&#x3D;0时，什么也不做（程序向下执行）</strong></li>
</ol>
<hr>
<p><strong><font color=red>loop指令详解：</font></strong></p>
<ol>
<li><strong>loop指令为循环指令，所有的循环指令都是短转移，在对应的机器码中包含转移的位移，而不是目的地址</strong></li>
<li><strong>对IP的修改范围都为-128~127</strong></li>
<li><strong>指令格式：<code>loop 标号</code> ((cx) &#x3D; (cx) - 1，如果(cx) ≠ 0，转移到标号处执行)</strong></li>
<li><strong>(cx) &#x3D; (cx) - 1；如果 (cx) !&#x3D; 0，(IP) &#x3D; (IP) + 8位位移</strong><ul>
<li><strong>8位位移 &#x3D; 标号处的地址 - loop指令后的第一个字节的地址</strong></li>
<li><strong>8位位移的范围为-128~127，用补码表示</strong></li>
<li><strong>8位位移由编译程序在编译时算出</strong></li>
</ul>
</li>
<li><strong>如果（cx）&#x3D; 0，什么也不做（程序向下执行）</strong></li>
</ol>
</blockquote>
<hr>
<h2 id="第八章：CALL和RET指令"><a href="#第八章：CALL和RET指令" class="headerlink" title="第八章：CALL和RET指令"></a>第八章：CALL和RET指令</h2><h3 id="ret和retf指令"><a href="#ret和retf指令" class="headerlink" title="ret和retf指令"></a><strong>ret和retf指令</strong></h3><p><strong>补充：call和ret指令都是转移指令，它们都修改IP，或同时修改CS和IP</strong></p>
<blockquote>
<ol>
<li><strong><font color=red>ret指令<mark>用栈中的数据，修改IP的内容</mark>，从而实现近转移</font></strong></li>
<li><strong><font color=red>retf指令<mark>用栈中的数据，修改CS和IP的内容</mark>，从而实现远转移</font></strong></li>
<li><strong><font color=green>CPU执行ret指令时，相当于进行： <code>pop IP</code>：</font></strong><ol>
<li><strong>(IP) &#x3D; ( (ss) * 16 + (sp) )</strong></li>
<li><strong>(sp) &#x3D; (sp) + 2</strong></li>
</ol>
</li>
<li><strong><font color=green>CPU执行retf指令时，相当于进行：<code>pop IP, pop CS</code>：</font></strong><ol>
<li><strong>(IP) &#x3D; ( (ss) * 16 + (sp) )</strong></li>
<li><strong>(sp) &#x3D; (sp) + 2</strong></li>
<li><strong>(CS) &#x3D; ( (ss) * 16 + (sp) )</strong></li>
<li><strong>(sp) &#x3D; (sp) + 2</strong></li>
</ol>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code 
stack seqment
	db <span class="token number">16</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
stack ends 

code segment
		mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h
		<span class="token keyword">int</span> <span class="token number">21</span>h 
 start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span> stack 
 		mov ss<span class="token punctuation">,</span> ax
 		mov sp<span class="token punctuation">,</span> <span class="token number">16</span>
		mov ax<span class="token punctuation">,</span> <span class="token number">0</span>
		push ax <span class="token punctuation">;</span>ax入栈
		mov bx<span class="token punctuation">,</span> <span class="token number">0</span>
		ret <span class="token punctuation">;</span>ret指令执行后，<span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>，CS<span class="token operator">:</span>IP指向代码段的第一条指令。可以push cs  push ax  retf
code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="call指令"><a href="#call指令" class="headerlink" title="call指令"></a><strong>call指令</strong></h3><blockquote>
<p><strong>call指令经常跟ret指令配合使用，因此CPU执行call指令，进行两步操作：</strong></p>
<ol>
<li><strong>将当前的IP或CS和IP压入栈中</strong></li>
<li><strong>转移（jmp）</strong></li>
</ol>
<p><strong><mark>call指令不能实现短转移，除此之外，call指令实现转移的方法和 jmp 指令的原理相同:</mark></strong></p>
<ol>
<li><p><strong><code>call 标号</code>（近转移）：CPU执行此种格式的call指令时，相当于进行 <code>push IP</code> <code>jmp near ptr 标号</code></strong></p>
</li>
<li><p><strong><code>call far ptr 标号</code>（段间转移）：CPU执行此种格式的call指令时，相当于进行：<code>push CS，push IP</code> <code>jmp far ptr 标号</code></strong></p>
</li>
<li><p><strong><code>call 16位寄存器</code>：CPU执行此种格式的call指令时，相当于进行： <code>push IP</code> <code>jmp 16位寄存器</code></strong></p>
</li>
<li><p><strong><code>call word ptr 内存单元地址</code>：CPU执行此种格式的call指令时，相当于进行：<code>push IP</code> <code>jmp word ptr 内存单元地址</code></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov sp<span class="token punctuation">,</span> <span class="token number">10</span>h
mov ax<span class="token punctuation">,</span> <span class="token number">0123</span>h
mov ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ax
call word ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            
<span class="token punctuation">;</span>执行后，<span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0123</span>H，<span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>EH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


</li>
<li><p><strong><code>call dword ptr 内存单元地址</code>：CPU执行此种格式的call指令时，相当于进行：<code>push CS</code> <code>push IP</code> <code>jmp dword ptr 内存单元地址</code></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov sp<span class="token punctuation">,</span> <span class="token number">10</span>h
mov ax<span class="token punctuation">,</span> <span class="token number">0123</span>h
mov ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ax
mov word ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>
call dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            
<span class="token punctuation">;</span>执行后，<span class="token punctuation">(</span>CS<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>，<span class="token punctuation">(</span>IP<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0123</span>H，<span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span>CH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</blockquote>
<hr>
<h3 id="call和ret的配合使用"><a href="#call和ret的配合使用" class="headerlink" title="call和ret的配合使用"></a><strong>call和ret的配合使用</strong></h3><pre class="line-numbers language-c" data-language="c"><code class="language-c">；call和ret的配合使用案例
    
assume cs<span class="token operator">:</span>code
code segment
start<span class="token operator">:</span>	mov ax<span class="token punctuation">,</span><span class="token number">1</span>
	    mov cx<span class="token punctuation">,</span><span class="token number">3</span>
     	call s <span class="token punctuation">;</span>（<span class="token number">1</span>）CPU指令缓冲器存放call指令，IP指向下一条指令（mov bx<span class="token punctuation">,</span> ax），执行call指令，IP入栈，jmp
     	
	    mov bx<span class="token punctuation">,</span>ax	<span class="token punctuation">;</span>（<span class="token number">4</span>）IP重新指向这里  bx <span class="token operator">=</span> <span class="token number">8</span>
     	mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
     	<span class="token keyword">int</span> <span class="token number">21</span>h
     s<span class="token operator">:</span> add ax<span class="token punctuation">,</span>ax
     	loop s<span class="token punctuation">;</span>（<span class="token number">2</span>）循环<span class="token number">3</span>次ax <span class="token operator">=</span> <span class="token number">8</span>
	    ret<span class="token punctuation">;</span>（<span class="token number">3</span>）<span class="token keyword">return</span> <span class="token operator">:</span> pop IP
code ends
end start
            
；call 与 ret 指令共同支持了汇编语言编程中的模块化设计<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<hr>
<h2 id="第九章：标志寄存器"><a href="#第九章：标志寄存器" class="headerlink" title="第九章：标志寄存器"></a>第九章：标志寄存器</h2><h3 id="标志寄存器概念"><a href="#标志寄存器概念" class="headerlink" title="标志寄存器概念"></a><strong>标志寄存器概念</strong></h3><blockquote>
<p><strong><font color=red>CPU内部的寄存器中，有一种特殊的寄存器（对于不同的处理机，个数和结构都可能不同）,这种特殊的寄存器在8086CPU中，被称为标志寄存器（flag）,其具有以下3种作用：</font></strong></p>
<ol>
<li><strong><mark>用来存储相关指令的某些执行结果</mark></strong></li>
<li><strong><mark>用来为CPU执行相关指令提供行为依据</mark></strong></li>
<li><strong><mark>用来控制CPU的相关工作方式</mark></strong></li>
</ol>
<p><strong><font color=red>8086CPU的标志寄存器有16位，其中存储的信息通常被称为程序状态字（PSW-Program Status Word），flag寄存器是按位起作用的，它的每一位都有专门的含义，记录特定的信息</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717001.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717001.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010174717001">
</blockquote>
<hr>
<h4 id="零标志位-ZF"><a href="#零标志位-ZF" class="headerlink" title="零标志位(ZF)"></a><strong>零标志位(ZF)</strong></h4><blockquote>
<ol>
<li><strong><font color=red>零标志位（Zero Flag）：它记录相关指令执行后，其结果是否为0</font></strong></li>
<li><strong>如果结果为0，那么zf &#x3D; 1(表示结果是0)；如果结果不为0，那么zf &#x3D; 0</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> <span class="token number">1</span>
sub ax<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">;</span>执行后，结果为<span class="token number">0</span>，则zf <span class="token operator">=</span> <span class="token number">1</span>

mov ax<span class="token punctuation">,</span> <span class="token number">2</span>
sub ax<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">;</span>执行后，结果不为<span class="token number">0</span>，则zf <span class="token operator">=</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h4 id="奇偶标志位-PF"><a href="#奇偶标志位-PF" class="headerlink" title="奇偶标志位(PF)"></a><strong>奇偶标志位(PF)</strong></h4><blockquote>
<ol>
<li><strong><font color=red>奇偶标志位（Parity Flag）：它记录相关指令执行后，其结果的所有bit位中1的个数是否为偶数</font></strong></li>
<li><strong>如果1的个数为偶数，pf &#x3D; 1，如果为奇数，那么pf &#x3D; 0</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov al<span class="token punctuation">,</span> <span class="token number">1</span>
add al<span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">;</span>执行后，结果为<span class="token number">00001011</span>B，其中有<span class="token number">3</span>（奇数）个<span class="token number">1</span>，则pf <span class="token operator">=</span> <span class="token number">0</span>；

mov al<span class="token punctuation">,</span> <span class="token number">1</span>
or al<span class="token punctuation">,</span> <span class="token number">2</span>  <span class="token punctuation">;</span>执行后，结果为<span class="token number">00000011</span>B，其中有<span class="token number">2</span>（偶数）个<span class="token number">1</span>，则pf <span class="token operator">=</span> <span class="token number">1</span>；<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h4 id="符号标志符-SF"><a href="#符号标志符-SF" class="headerlink" title="符号标志符(SF)"></a><strong>符号标志符(SF)</strong></h4><blockquote>
<ol>
<li><strong><font color=red>符号标志位(Symbol Flag)：它记录相关指令执行后，其结果是否为负</font></strong></li>
<li><strong>如果结果为负，sf &#x3D; 1；如果非负，sf &#x3D; 0</strong></li>
<li><strong>计算机中通常用补码来表示有符号数据。计算机中的一个数据可以看作是有符号数，也可以看成是无符号数</strong><ul>
<li><strong><code>00000001B</code>，可以看作为无符号数1，或有符号数+1</strong></li>
<li><strong><code>10000001B</code>，可以看作为无符号数129，也可以看作有符号数-127</strong></li>
</ul>
</li>
<li><strong><mark>对于同一个二进制数据，计算机可以将它当作无符号数据来运算，也可以当作有符号数据来运算</mark></strong></li>
<li><strong><font color=green>CPU在执行add等指令的时候，就包含了两种含义:可以将add指令进行的运算当作无符号数的运算，也可以将add指令进行的运算当作有符号数的运算</font></strong></li>
<li><strong>SF标志：就是CPU对有符号数运算结果的一种记录，它记录数据的正负。在我们将数据当作有符号数来运算的时候，可以通过它来得知结果的正负。如果我们将数据当作无符号数来运算，SF的值则没有意义，虽然相关的指令影响了它的值</strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov al<span class="token punctuation">,</span> <span class="token number">10000001</span>B 
add al<span class="token punctuation">,</span> <span class="token number">1</span>   <span class="token punctuation">;</span>执行后，结果为<span class="token number">10000010</span>B，sf <span class="token operator">=</span> <span class="token number">1</span>，表示：如果指令进行的是有符号数运算，那么结果为负；

mov al<span class="token punctuation">,</span> <span class="token number">10000001</span>B
add al<span class="token punctuation">,</span> <span class="token number">01111111</span>B   <span class="token punctuation">;</span>执行后，结果为<span class="token number">0</span>，sf <span class="token operator">=</span> <span class="token number">0</span>，表示：如果指令进行的是有符号数运算，那么结果为非负<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h4 id="进位标志符-CF"><a href="#进位标志符-CF" class="headerlink" title="进位标志符(CF)"></a><strong>进位标志符(CF)</strong></h4><blockquote>
<ol>
<li><p><strong><font color=red>进位标志位(Carry Flag)：一般情况下，在进行无符号数运算的时候，它记录了运算结果的最高有效位向更高位的进位值，或从更高位的借位值</font></strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717002.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717002.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010174717002"></li>
</ol>
</blockquote>
<hr>
<h4 id="溢出标志符-OF"><a href="#溢出标志符-OF" class="headerlink" title="溢出标志符(OF)"></a><strong>溢出标志符(OF)</strong></h4><blockquote>
<ol>
<li><strong><font color=red>溢出标志位(Overflow Flag)：一般情况下，OF记录了有符号数运算的结果是否发生了溢出</font></strong></li>
<li><strong>如果发生溢出，OF &#x3D; 1；如果没有，OF &#x3D; 0</strong></li>
<li><strong><code>CF和OF的区别：CF是对无符号数运算有意义的标志位，而OF是对有符号数运算有意义的标志位</code></strong></li>
<li><strong><font color=red>CPU在执行add等指令的时候，就包含了两种含义：无符号数运算和有符号数运算</font></strong><ul>
<li><strong><mark>对于无符号数运算，CPU用CF位来记录是否产生了进位</mark></strong></li>
<li><strong><mark>对于有符号数运算，CPU用OF位来记录是否产生了溢出，当然，还要用SF位来记录结果的符号</mark></strong></li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov al<span class="token punctuation">,</span> <span class="token number">98</span>
add al<span class="token punctuation">,</span> <span class="token number">99</span>   <span class="token punctuation">;</span>执行后将产生溢出。因为进行的<span class="token string">"有符号数"</span>运算是：（al）<span class="token operator">=</span>（al）<span class="token operator">+</span> <span class="token number">99</span> <span class="token operator">=</span> <span class="token number">98</span> <span class="token operator">+</span> <span class="token number">99</span><span class="token operator">=</span><span class="token number">197</span> <span class="token operator">=</span> C5H 为<span class="token operator">-</span><span class="token number">59</span>的补码
             <span class="token punctuation">;</span>而结果<span class="token number">197</span>超出了机器所能表示的<span class="token number">8</span>位有符号数的范围：<span class="token operator">-</span><span class="token number">128</span><span class="token operator">-</span><span class="token number">127</span>。
             <span class="token punctuation">;</span>add 指令执行后：无符号运算没有进位CF<span class="token operator">=</span><span class="token number">0</span>，有符号运算溢出OF<span class="token operator">=</span><span class="token number">1</span>
             <span class="token punctuation">;</span>当取出的数据C5H按无符号解析C5H <span class="token operator">=</span> <span class="token number">197</span><span class="token punctuation">,</span> 当按有符号解析通过SP得知数据为负<span class="token punctuation">,</span>即C5H为<span class="token operator">-</span><span class="token number">59</span>补码存储，

mov al，<span class="token number">0F</span><span class="token number">0</span>H  <span class="token punctuation">;</span>F0H，为有符号数<span class="token operator">-</span><span class="token number">16</span>的补码   <span class="token operator">-</span><span class="token function">Not</span><span class="token punctuation">(</span>F0 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
add al，<span class="token number">088</span>H  <span class="token punctuation">;</span><span class="token number">88</span>H，为有符号数<span class="token operator">-</span><span class="token number">120</span>的补码   <span class="token operator">-</span><span class="token function">Not</span><span class="token punctuation">(</span><span class="token number">88</span><span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
              <span class="token punctuation">;</span>执行后，将产生溢出。因为add al<span class="token punctuation">,</span> <span class="token number">088</span>H进行的有符号数运算结果是：（al）<span class="token operator">=</span> <span class="token operator">-</span><span class="token number">136</span> 
              <span class="token punctuation">;</span>而结果<span class="token operator">-</span><span class="token number">136</span>超出了机器所能表示的<span class="token number">8</span>位有符号数的范围：<span class="token operator">-</span><span class="token number">128</span><span class="token operator">-</span><span class="token number">127</span>。
              <span class="token punctuation">;</span>add 指令执行后：无符号运算有进位CF<span class="token operator">=</span><span class="token number">1</span>，有符号运算溢出OF<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="adc指令和sbb指令"><a href="#adc指令和sbb指令" class="headerlink" title="adc指令和sbb指令"></a><strong>adc指令和sbb指令</strong></h3><blockquote>
<p><strong><code>adc指令的详解：</code></strong></p>
<ol>
<li><strong><font color=red>adc是带进位加法指令，它利用了CF位上记录的进位值</font></strong></li>
<li><strong><code>指令格式：</code> <code>adc 操作对象1, 操作对象2</code></strong></li>
<li><strong><mark>功能：操作对象1 &#x3D; 操作对象1 + 操作对象2 + CF</mark></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> <span class="token number">2</span>
mov bx<span class="token punctuation">,</span> <span class="token number">1</span>
sub bx<span class="token punctuation">,</span> ax  <span class="token punctuation">;</span>无符号运算借位CF<span class="token operator">=</span><span class="token number">1</span>，有符号运算OF <span class="token operator">=</span> <span class="token number">0</span>
adc ax<span class="token punctuation">,</span> <span class="token number">1</span>   <span class="token punctuation">;</span>执行后，（ax）<span class="token operator">=</span> <span class="token number">4</span>。adc执行时，相当于计算：<span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span>CF <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token number">4</span>。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717003.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717003.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010174717003">

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>计算<span class="token number">1</span>EF000H<span class="token operator">+</span><span class="token number">201000</span>H，结果放在ax（高<span class="token number">16</span>位）和bx（低<span class="token number">16</span>位）中
<span class="token punctuation">;</span>将计算分两步进行，先将低<span class="token number">16</span>位相加，然后将高<span class="token number">16</span>位和进位值相加

mov ax<span class="token punctuation">,</span> <span class="token number">001</span>EH 
mov bx<span class="token punctuation">,</span> <span class="token number">0F</span><span class="token number">000</span>H 
add bx<span class="token punctuation">,</span> <span class="token number">1000</span>H
adc ax<span class="token punctuation">,</span> <span class="token number">0020</span>H<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><code>sbb指令的详解：</code></strong></p>
<ol>
<li><strong><font color=red>sbb是带借位减法指令，它利用了CF位上记录的借位值</font></strong></li>
<li><strong><code>指令格式：</code> <code>sbb 操作对象1, 操作对象2</code></strong></li>
<li><strong><mark>功能：操作对象1 &#x3D; 操作对象1 - 操作对象2 - CF</mark></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>计算 <span class="token number">003E1000</span>H <span class="token operator">-</span> <span class="token number">00202000</span>H，结果放在ax，bx中，程序如下：

mov bx<span class="token punctuation">,</span> <span class="token number">1000</span>H
mov ax<span class="token punctuation">,</span> <span class="token number">003</span>EH
sub bx<span class="token punctuation">,</span> <span class="token number">2000</span>H
sbb ax<span class="token punctuation">,</span> <span class="token number">0020</span>H<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="cmp指令"><a href="#cmp指令" class="headerlink" title="cmp指令"></a><strong>cmp指令</strong></h3><blockquote>
<ol>
<li><strong><font color=red>cmp是比较指令，cmp的功能相当于减法指令，只是不保存结果。cmp指令执行后，将对标志寄存器产生影响</font></strong></li>
<li><strong>其他相关指令通过识别这些被影响的标志寄存器位来得知比较结果</strong></li>
<li><strong><code>cmp指令格式：</code> <code>cmp 操作对象1，操作对象2</code></strong><ul>
<li>例如:指令<code>cmp ax, ax</code>，做（ax）-（ax）的运算，结果为0，但并不在ax中保存，仅影响flag的相关各位。  指令执行后：zf&#x3D;1，pf&#x3D;1，sf&#x3D;0，cf&#x3D;0，of&#x3D;0</li>
</ul>
</li>
<li><strong>CPU在执行cmp指令的时候，也包含两种含义：进行无符号数运算和进行有符号数运算</strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717004.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717004.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010174717004">

<p><strong><font color=red>如果用cmp来进行有符号数比较时,SF只能记录实际结果的正负，发生溢出的时候，实际结果的正负不能说明逻辑上真正结果的正负。但是逻辑上的结果的正负，才是cmp指令所求的真正结果，所以我们在考察SF的同时考察OF，就可以得知逻辑上真正结果的正负，同时就知道比较的结果</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ah<span class="token punctuation">,</span> <span class="token number">08</span>AH  <span class="token punctuation">;</span> <span class="token operator">-</span><span class="token function">Not</span><span class="token punctuation">(</span><span class="token number">8</span>A<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">118</span>  即当成有符号数时为<span class="token operator">-</span><span class="token number">118</span>
mov bh<span class="token punctuation">,</span> <span class="token number">070</span>H  <span class="token punctuation">;</span> 有符号数时最高位为<span class="token number">0</span>为正数， <span class="token number">70</span>H <span class="token operator">=</span> <span class="token number">112</span>
cmp ah<span class="token punctuation">,</span> bh    <span class="token punctuation">;</span>（ah）<span class="token operator">-</span>（bh）实际得到的结果是<span class="token number">1</span>AH 
		      <span class="token punctuation">;</span> 在逻辑上，运算所应该得到的结果是：（<span class="token operator">-</span><span class="token number">118</span>）<span class="token operator">-</span> <span class="token number">112</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">230</span>
		      <span class="token punctuation">;</span> sf记录实际结果的正负，所以sf<span class="token operator">=</span><span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong><code>对于cmp ah，bh的理解：</code></strong></p>
<ol>
<li><strong><font color=red>如果sf&#x3D;1，而of&#x3D;0 。 of&#x3D;0说明没有溢出，逻辑上真正结果的正负&#x3D;实际结果的正负； sf&#x3D;1，实际结果为负，所以逻辑上真正的结果为负，所以（ah）&lt;（bh）</font></strong></li>
<li><strong><font color=red>如果sf&#x3D;1，而of&#x3D;1： of&#x3D;1，说明有溢出，逻辑上真正结果的正负≠实际结果的正负； sf&#x3D;1，实际结果为负。实际结果为负，而又有溢出，这说明是由于溢出导致了实际结果为负，，如果因为溢出导致了实际结果为负，那么逻辑上真正的结果必然为正。 这样，sf&#x3D;1，of&#x3D;1，说明了（ah）&gt;（bh）</font></strong></li>
<li><strong><font color=red>如果sf&#x3D;0，而of&#x3D;1。of&#x3D;1，说明有溢出，逻辑上真正结果的正负≠实际结果的正负；sf&#x3D;0，实际结果非负。而of&#x3D;1说明有溢出，则结果非0，所以，实际结果为正。实际结果为正，而又有溢出，这说明是由于溢出导致了实际结果非负，如果因为溢出导致了实际结果为正，那么逻辑上真正的结果必然为负。这样，sf&#x3D;0，of&#x3D;1，说明了（ah）&lt;（bh）</font></strong></li>
<li><strong><font color=red>如果sf&#x3D;0，而of&#x3D;0,of&#x3D;0，说明没有溢出，逻辑上真正结果的正负&#x3D;实际结果的正负；sf&#x3D;0，实际结果非负，所以逻辑上真正的结果非负，所以（ah）≥（bh）</font></strong></li>
</ol>
</blockquote>
<hr>
<h3 id="检测比较结果的条件转移指令"><a href="#检测比较结果的条件转移指令" class="headerlink" title="检测比较结果的条件转移指令"></a><strong>检测比较结果的条件转移指令</strong></h3><blockquote>
<ol>
<li><strong><font color=red>“转移”指的是它能修改IP，而“条件”指的是它可以根据某种条件，决定是否修改IP</font></strong></li>
<li><strong><mark>比如：jcxz它可以检测cx中的数值，如果（cx）&#x3D;0，就修改IP，否则什么也不做</mark></strong></li>
<li><strong><mark>所有条件转移指令的转移位移都是[-128，127]</mark></strong></li>
<li><strong><mark>多数条件转移指令都检测标志寄存器的相关标志位，根据检测的结果来决定是否修改IP</mark></strong></li>
<li><strong><mark>这些条件转移指令通常都和cmp相配合使用,它们所检测的标志位，都是cmp指令进行无符号数比较的时记录比较结果的标志位</mark></strong></li>
<li><strong><mark>根据无符号数的比较结果进行转移的条件转移指令（它们检测zf、cf的值）</mark></strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717005.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010174717005.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010174717005">

<p><strong><mark>简写指令补充：j：jump，e：equal，b：below，a：above，n：not</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>编程，统计data段中数值为<span class="token number">8</span>的字节的个数，用ax保存统计结果。
mov ax<span class="token punctuation">,</span> data 
mov ds<span class="token punctuation">,</span> ax 
mov bx<span class="token punctuation">,</span> <span class="token number">0</span>   <span class="token punctuation">;</span>ds<span class="token operator">:</span>bx指向第一个字节
mov ax<span class="token punctuation">,</span> <span class="token number">0</span>   <span class="token punctuation">;</span>初始化累加器mov cx，<span class="token number">8</span>

s<span class="token operator">:</span>
	cmp byte ptr <span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">8</span>   <span class="token punctuation">;</span>和<span class="token number">8</span>进行比较
	jne next  <span class="token punctuation">;</span>如果不相等转到next，继续循环
	inc ax  <span class="token punctuation">;</span>如果相等就将计数值加<span class="token number">1</span>
next<span class="token operator">:</span>
	inc bx
	loop s <span class="token punctuation">;</span>程序执行后：（ax）<span class="token operator">=</span><span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="DF标志和串传送指令"><a href="#DF标志和串传送指令" class="headerlink" title="DF标志和串传送指令"></a><strong>DF标志和串传送指令</strong></h3><blockquote>
<ol>
<li><strong><font color=red>flag的第10位是DF，方向标志位。在串处理指令中，控制每次操作后si、di的增减</font></strong><ul>
<li><strong><mark>df &#x3D; 0每次操作后si、di递增</mark></strong></li>
<li><strong><mark>df &#x3D; 1每次操作后si、di递减</mark></strong></li>
</ul>
</li>
<li><strong><font color=red>格式：<code>movsb</code>，功能：将ds:si指向的内存单元中的字节送入es:di中，然后根据标志寄存器df位的值，将si和di递增或递减</font></strong></li>
<li><strong><font color=red>格式：<code>movsw</code>，功能：将ds:si指向的内存字单元中的字送入es:di中，然后根据标志寄存器df位的值，将si和di递增2或递减2</font></strong></li>
<li><strong><font color=red>格式：<code>rep movsb</code>，movsb和movsw进行的是串传送操作中的一个步骤，一般来说，movsb和movsw都和rep配合使用，功能：rep的作用是根据cx的值，重复执行后面的串传送指令</font></strong></li>
<li><strong><font color=red>8086CPU提供下面两条指令对df位进行设置：</font></strong><ul>
<li><strong><code>cld</code>指令：将标志寄存器的df位置0</strong></li>
<li><strong><code>std</code>指令：将标志寄存器的df位置1</strong></li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>将data段中的第一个字符串复制到它后面的空间中。
data segment 
	db <span class="token char">'Welcome to masm!'</span>
	db <span class="token number">16</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
data ends

mov ax<span class="token punctuation">,</span> data 
mov ds<span class="token punctuation">,</span> ax 
mov si<span class="token punctuation">,</span> <span class="token number">0</span>   <span class="token punctuation">;</span>ds<span class="token operator">:</span>si 指向data<span class="token operator">:</span><span class="token number">0</span>
mov es<span class="token punctuation">,</span> ax 
mov di<span class="token punctuation">,</span> <span class="token number">16</span>  <span class="token punctuation">;</span>es<span class="token operator">:</span>di指向data<span class="token operator">:</span><span class="token number">0010</span>

mov cx<span class="token punctuation">,</span> <span class="token number">16</span>  <span class="token punctuation">;</span>（cx）<span class="token operator">=</span><span class="token number">16</span>，rep循环<span class="token number">16</span>次
cld  <span class="token punctuation">;</span>设置df<span class="token operator">=</span><span class="token number">0</span>，正向传送
rep movsb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="pushf和popf"><a href="#pushf和popf" class="headerlink" title="pushf和popf"></a><strong>pushf和popf</strong></h3><blockquote>
<ol>
<li><strong><mark>pushf的功能是将标志寄存器的值压栈，而popf是从栈中弹出数据，送入标志寄存器中</mark></strong></li>
<li><strong><mark>pushf和popf，为直接访问标志寄存器提供了一种方法</mark></strong></li>
</ol>
</blockquote>
<hr>
<h2 id="第十章：内中断"><a href="#第十章：内中断" class="headerlink" title="第十章：内中断"></a>第十章：内中断</h2><h3 id="内中断的产生"><a href="#内中断的产生" class="headerlink" title="内中断的产生"></a><strong>内中断的产生</strong></h3><p><strong><font color=red>任何一个通用的CPU，都具备一种能力，可以在执行完当前正在执行的指令之后，检测到从CPU外部发送过来的或内部产生的一种特殊信息，并且可以立即对所接收到的信息进行处理。这种特殊的信息，我们可以称其为：中断信息。中断的意思是指，CPU不再接着（刚执行完的指令）向下执行，而是转去处理这个特殊信息</font></strong></p>
<ol>
<li><strong>中断信息可以来自CPU的内部和外部（内中断，外中断）</strong></li>
<li><strong>内中断：当CPU的内部有需要处理的事情发生的时候，将产生中断信息，引发中断过程。这种中断信息来自CPU的内部</strong></li>
</ol>
<blockquote>
<p><strong><code>8086CPU的内中断（下面四种情况将产生中断信息）:</code></strong></p>
<ol>
<li><strong><mark>除法错误，比如，执行div指令产生的除法溢出</mark></strong></li>
<li><strong><mark>单步执行</mark></strong></li>
<li><strong><mark>执行into指令</mark></strong></li>
<li><strong><mark>执行int指令</mark></strong></li>
</ol>
</blockquote>
<p><strong>中断信息中包含中断类型码，中断类型码为一个字节型数据，可以表示256种中断信息的来源（中断源）</strong></p>
<p><strong><font color=red>上述的4种内中断源，在8086CPU中的中断类型码如下:</font></strong></p>
<ol>
<li><strong>除法错误：0</strong></li>
<li><strong>单步执行：1</strong></li>
<li><strong>执行into指令：4</strong></li>
<li><strong>执行int指令，该指令的格式为int n，指令中的n为字节型立即数，是提供给CPU的中断类型码</strong></li>
</ol>
<hr>
<h3 id="中断处理程序、中断向量表、中断过程"><a href="#中断处理程序、中断向量表、中断过程" class="headerlink" title="中断处理程序、中断向量表、中断过程"></a><strong>中断处理程序、中断向量表、中断过程</strong></h3><p><strong><font color=red>中断处理程序：</font></strong></p>
<blockquote>
<ol>
<li><strong>用来处理中断信息的程序被称为中断处理程序</strong></li>
<li><strong>根据CPU的设计，中断类型码的作用就是用来定位中断处理程序。比如CPU根据中断类型码4，就可以找到4号中断的处理程序</strong></li>
</ol>
</blockquote>
<p><strong><font color=red>中断向量表：</font></strong></p>
<blockquote>
<ol>
<li><strong>中断向量就是中断处理程序的入口地址。中断向量表就是中断处理程序入口地址的列表</strong></li>
<li><strong>CPU用8位的中断类型码通过中断向量表找到相应的中断处理程序的入口地址</strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010211809501.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010211809501.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010211809501">
</blockquote>
<p><strong><font color=red>中断过程：</font></strong></p>
<blockquote>
<ol>
<li><strong>中断过程的主要任务就是用中断类型码在中断向量表中找到中断处理程序的入口地址，设置CS和IP</strong></li>
<li><strong>简要描述如下:</strong><ol>
<li><strong><mark>取得中断类型码N</mark></strong></li>
<li><strong><mark>pushf</mark></strong></li>
<li><strong><mark>TF&#x3D;0，IF&#x3D;0 （为什么这样参考单步中断）</mark></strong></li>
<li><strong><mark>push CS , push IP</mark></strong></li>
<li><strong><mark>（IP）&#x3D;（N * 4），（CS）&#x3D;（N * 4 + 2）</mark></strong></li>
</ol>
</li>
<li><strong>硬件在完成中断过程后，CS:IP将指向中断处理程序的入口，CPU开始执行中断处理程序</strong></li>
</ol>
</blockquote>
<hr>
<h3 id="iret指令"><a href="#iret指令" class="headerlink" title="iret指令"></a><strong>iret指令</strong></h3><p><strong><font color=red>CPU随时都可能执行中断处理程序，中断处理程序必须一直存储在内存某段空间之中，而中断处理程序的入口地址，即中断向量，必须存储在对应的中断向量表表项中</font></strong></p>
<blockquote>
<p><strong><font color=green>中断处理程序的常规编写步骤：</font></strong></p>
<ol>
<li><strong>保存用到的寄存器</strong></li>
<li><strong>处理中断</strong></li>
<li><strong>恢复用到的寄存器</strong></li>
<li><strong>用<code>iret</code>指令返回</strong></li>
</ol>
</blockquote>
<p><strong>iret 指令描述为：<code>pop IP</code> <code>pop CS</code> <code>popf</code></strong></p>
<p><strong>iret指令执行后，CPU回到执行中断处理程序前的执行点继续执行程序</strong></p>
<hr>
<h3 id="除法错误中断的处理"><a href="#除法错误中断的处理" class="headerlink" title="除法错误中断的处理"></a><strong>除法错误中断的处理</strong></h3><blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ax<span class="token punctuation">,</span> <span class="token number">1000</span>h 
mov bh<span class="token punctuation">,</span> <span class="token number">1</span>
div bh <span class="token punctuation">;</span>除法溢出错误<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol>
<li><strong>当CPU执行div bh时，发生了除法溢出错误，产生0号中断信息，从而引发中断过程</strong></li>
<li><strong>CPU执行0号中断处理程序</strong></li>
<li><strong>系统中的0号中断处理程序的功能：显示提示信息“Divide overflow”后，返回到操作系统中</strong></li>
</ol>
</blockquote>
<blockquote>
<p><strong><font color=red>编程实验：编写0号中断处理程序do0，当发生除法溢出时，在屏幕中间显示“overflow！”，返回DOS</font></strong></p>
<p><strong><mark>实验要求：</mark></strong></p>
<ul>
<li><strong><font color=green>0000:0200至0000:02FF的256个字节的空间所对应的中断向量表项都是空的，可以将中断处理程序do0传送到内存0000:0200处</font></strong></li>
<li><strong><font color=green>中断处理程序do0放到<code>0000:0200</code>,再将其地址登记在中断向量表对应表项</font></strong></li>
</ul>
<p><strong><font color=red>思路：</font></strong></p>
<ul>
<li><strong>0号表项的地址<code>0:0</code>。<code>0:0</code>字单元存放偏移地址，<code>0:2</code>字单元存放段地址</strong></li>
<li><strong>将do0的段地址0存放在<code>0000:0002</code>字单元中，将偏移地址200H存放在<code>0000:0000</code>字单元</strong></li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code

code segment
start<span class="token operator">:</span>	
		mov ax<span class="token punctuation">,</span> cs
		mov ds<span class="token punctuation">,</span> ax
		mov si<span class="token punctuation">,</span> offset do0		<span class="token punctuation">;</span>设置ds<span class="token operator">:</span>si指向源地址
		mov ax<span class="token punctuation">,</span> <span class="token number">0</span>
		mov es<span class="token punctuation">,</span> ax
		mov di<span class="token punctuation">,</span> <span class="token number">200</span>h			<span class="token punctuation">;</span>设置es<span class="token operator">:</span>di指向目的地址<span class="token number">0000</span><span class="token operator">:</span><span class="token number">0200</span>
		mov cx<span class="token punctuation">,</span> offset do0end <span class="token operator">-</span> offset do0		<span class="token punctuation">;</span>设置cx为传输长度 编译时给出do0部分代码长度
		cld				        <span class="token punctuation">;</span>设置传输方向为正
		rep movsb <span class="token punctuation">;</span>将do0的代码送入<span class="token number">0</span><span class="token operator">:</span><span class="token number">200</span>处

		mov ax<span class="token punctuation">,</span> <span class="token number">0</span>               <span class="token punctuation">;</span>设置中断向量表
		mov es<span class="token punctuation">,</span> ax
		mov word ptr es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">200</span>h
		mov word ptr es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>

      	mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
      	<span class="token keyword">int</span> <span class="token number">21</span>h

<span class="token punctuation">;</span>do0程序的主要任务是显示字符串

do0<span class="token operator">:</span>	jmp <span class="token keyword">short</span> do0 start 
      	db <span class="token string">"overflow!"</span>

do0start<span class="token operator">:</span>
      	mov ax<span class="token punctuation">,</span> cs
      	mov ds<span class="token punctuation">,</span> ax
      	mov si<span class="token punctuation">,</span> <span class="token number">202</span>h			<span class="token punctuation">;</span>设置ds<span class="token operator">:</span>si指向字符串

      	mov ax<span class="token punctuation">,</span> <span class="token number">0</span>b800h
      	mov es<span class="token punctuation">,</span> ax
		mov di<span class="token punctuation">,</span> <span class="token number">12</span><span class="token operator">*</span><span class="token number">160</span><span class="token operator">+</span><span class="token number">36</span><span class="token operator">*</span><span class="token number">2</span>		<span class="token punctuation">;</span>设置es<span class="token operator">:</span>di指向显存空间的中间位置

        mov cx<span class="token punctuation">,</span> <span class="token number">9</span>				<span class="token punctuation">;</span>设置cx为字符串长度
	s<span class="token operator">:</span>	mov al<span class="token punctuation">,</span> <span class="token punctuation">[</span>si<span class="token punctuation">]</span>
      	mov es<span class="token operator">:</span><span class="token punctuation">[</span>di<span class="token punctuation">]</span><span class="token punctuation">,</span> al
      	inc si
      	add di<span class="token punctuation">,</span> <span class="token number">1</span>
		mov al<span class="token punctuation">,</span> <span class="token number">02</span>h             <span class="token punctuation">;</span>设置颜色
		mov es<span class="token operator">:</span><span class="token punctuation">[</span>di<span class="token punctuation">]</span><span class="token punctuation">,</span> al        
		add di<span class="token punctuation">,</span> <span class="token number">1</span>
      	loop s

      	mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h
      	<span class="token keyword">int</span> <span class="token number">21</span>h
do0end<span class="token operator">:</span>	nop

code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="单步中断"><a href="#单步中断" class="headerlink" title="单步中断"></a><strong>单步中断</strong></h3><blockquote>
<ol>
<li><strong><font color=red>CPU在执行完一条指令之后，如果检测到标志寄存器的TF位为1，则产生单步中断，引发中断过程。单步中断的中断类型码为1</font></strong></li>
<li><strong><font color=red>Debug是如何利用CPU所提供的单步中断的功能进行调试？如使用t命令查看寄存器状态</font></strong></li>
<li><strong><font color=red>Debug提供了单步中断的中断处理程序，功能为显示所有寄存器中的内容后等待输入命令</font></strong></li>
<li><strong><font color=red>在使用t命令执行指令时，Debug将TF设置为1，在CPU执行完这条指令后就引发单步中断，执行单步中断的中断处理程序，所有寄存器中的内容被显示在屏幕上，并且等待输入命令</font></strong></li>
<li><strong><font color=red>在进入中断处理程序之前，设置TF&#x3D;0。从而避免CPU在执行中断处理程序的时候发生单步中断</font></strong></li>
</ol>
</blockquote>
<hr>
<h3 id="int指令"><a href="#int指令" class="headerlink" title="int指令"></a><strong>int指令</strong></h3><blockquote>
<ol>
<li><strong>int指令的格式为：<code>int n</code> ，n为中断类型码，它的功能是引发中断过程</strong></li>
<li><strong>CPU执行int n指令，相当于引发一个n号中断的中断过程</strong></li>
<li><strong>在程序中使用int指令调用任何一个中断的中断处理程序(中断例程)</strong></li>
</ol>
<p><font color=red>编写供应用程序调用的中断例程：</font></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//实验一</span>
<span class="token punctuation">;</span>求<span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3456</span><span class="token operator">^</span><span class="token number">2</span>

assume cs<span class="token operator">:</span>code

code segment

start<span class="token operator">:</span> 
     mov ax<span class="token punctuation">,</span> <span class="token number">3456</span> <span class="token punctuation">;</span><span class="token punctuation">(</span>ax<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3456</span>
     <span class="token keyword">int</span> <span class="token number">7</span>ch  <span class="token punctuation">;</span> 调用中断<span class="token number">7</span>ch的中断例程，计算ax中的数据的平方
     add ax<span class="token punctuation">,</span> ax  
     adc dx<span class="token punctuation">,</span> dx  <span class="token punctuation">;</span>存放结果，将结果乘以<span class="token number">2</span>

     mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
     <span class="token keyword">int</span> <span class="token number">21</span>h
code ends
end start <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//实验二</span>
<span class="token punctuation">;</span>功能：将一个全是字母，以<span class="token number">0</span>结尾的字符串，转化为大写
<span class="token punctuation">;</span>参数：ds<span class="token operator">:</span>si指向字符串的首地址
<span class="token punctuation">;</span>应用举例：将data段中的字符串转化为大写

assume cs<span class="token operator">:</span>code

data segment
	db <span class="token char">'conversation'</span><span class="token punctuation">,</span><span class="token number">0</span>
data ends

code segment
start<span class="token operator">:</span>  mov ax<span class="token punctuation">,</span> data
		mov ds<span class="token punctuation">,</span> ax
		mov si<span class="token punctuation">,</span> <span class="token number">0</span>
		<span class="token keyword">int</span> <span class="token number">7</span>ch

		mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
		<span class="token keyword">int</span> <span class="token number">21</span>h
code ends
end start   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="BIOS和DOS所提供的中断例程"><a href="#BIOS和DOS所提供的中断例程" class="headerlink" title="BIOS和DOS所提供的中断例程"></a><strong>BIOS和DOS所提供的中断例程</strong></h3><blockquote>
<p><strong><font color=red>在系统板的ROM中存放着一套程序，称为BIOS（基本输入输出系统）</font></strong></p>
<p><strong><code>BIOS中主要包含以下几部分内容：</code></strong></p>
<ol>
<li><strong><mark>硬件系统的检测和初始化程序</mark></strong></li>
<li><strong><mark>外部中断和内部中断的中断例程</mark></strong></li>
<li><strong><mark>用于对硬件设备进行I&#x2F;O操作的中断例程</mark></strong></li>
<li><strong><mark>其他和硬件系统相关的中断例程</mark></strong></li>
</ol>
<p><strong><font color=red>程序员在编程的时候，可以用int指令直接调用BIOS和DOS系统提供的中断例程，来完成某些工作，和硬件设备相关的DOS中断例程中，一般都调用了BIOS的中断例程</font></strong></p>
</blockquote>
<p><strong><code>BIOS和DOS中断例程的安装过程:</code></strong></p>
<blockquote>
<p><strong><font color=red>BIOS和DOS提供的中断例程是如何安装到内存中的呢？</font></strong></p>
<ol>
<li><strong><mark>开机后，CPU一加电，初始化（CS）&#x3D; 0FFFFH，（IP）&#x3D; 0，自动从FFFF:0单元开始执行程序。FFFF:0处有一条转跳指令，CPU执行该指令后，转去执行BIOS中的硬件系统检测和初始化程序</mark></strong></li>
<li><strong><mark>初始化程序将建立BIOS所支持的中断向量，即将BIOS提供的中断例程的入口地址登记在中断向量表中。注意，对于BIOS所提供的中断例程，只需将入口地址登记在中断向量表中即可，因为它们是固化到ROM中的程序，一直在内存中存在</mark></strong></li>
<li><strong><mark>硬件系统检测和初始化完成后，调用int 19h进行操作系统的引导。从此将计算机交由操作系统控制</mark></strong></li>
<li><strong><mark>DOS启动后，除完成其他工作外，还将它所提供的中断例程装入内存，并建立相应的中断向量</mark></strong></li>
</ol>
</blockquote>
<p><strong><code>BIOS中断例程应用:</code></strong></p>
<blockquote>
<p><strong><font color=red>一般来说，一个供程序员调用的中断例程中往往包括多个子程序，中断例程内部用传递进来的参数来决定执行哪一个子程序</font></strong></p>
<p><strong><font color=red>BIOS和DOS提供的中断例程，都用 ah 来传递内部子程序的编号</font></strong></p>
<p><strong><mark>编程：在屏幕的5行12列显示3个红底高亮闪烁绿色的“al</mark></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code 

code segment
<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token number">10</span>h中断例程的<span class="token string">"设置光标位置"</span>功能
mov ah<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">;</span>设置光标调用第<span class="token number">10</span>h号中断例程的<span class="token number">2</span>号子程序，功能为设置光标位置<span class="token punctuation">(</span>可以提供光标所在的行号、列号和页号作为参数<span class="token punctuation">)</span>

<span class="token punctuation">;</span>设置光标到第<span class="token number">0</span>页，第<span class="token number">5</span>行，第<span class="token number">12</span>列
mov bh<span class="token punctuation">,</span> <span class="token number">0</span>；第<span class="token number">0</span>页
mov dh<span class="token punctuation">,</span> <span class="token number">5</span>；dh中放行号
mov dl<span class="token punctuation">,</span> <span class="token number">12</span>；dl中放列号
<span class="token keyword">int</span> <span class="token number">10</span>h

<span class="token punctuation">;</span>int10h中断例程的<span class="token string">"在光标位置显示字符"</span>功能。
mov ah，<span class="token number">9</span> <span class="token punctuation">;</span>调用第<span class="token number">10</span>h号中断例程的<span class="token number">9</span>号子程序，功能为在光标位置显示字符
<span class="token punctuation">;</span>提供要显示的字符、颜色属性、页号、字符重复个数作为参数
mov al，<span class="token char">'a'</span>  <span class="token punctuation">;</span>字符
mov b1，<span class="token number">11001010</span>b  <span class="token punctuation">;</span>颜色属性
mov bh，<span class="token number">0</span>  <span class="token punctuation">;</span>第<span class="token number">0</span>页
mov cx，<span class="token number">3</span>  <span class="token punctuation">;</span>字符重复个数
<span class="token keyword">int</span> <span class="token number">10</span>h

code ends 
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><strong><mark>bh中页号的含义：内存地址空间中，B8000H~BFFFFH共32kB的空间，为80*25彩色字符模式的显示缓冲区</mark></strong></li>
<li><strong><mark>一屏的内容在显示缓冲区中共占4000个字节。显示缓冲区分为8页，每页4KB（约4000B），显示器可以显示任意一页的内容。一般情况下，显示第0页的内容。也就是说，通常情况下，B8000H~B8F9FH中的4000个字节的内容将出现在显示器上</mark></strong></li>
</ol>
</blockquote>
<p><strong><code>DOS中断例程应用:</code></strong></p>
<blockquote>
<p><strong><code>int 21h</code>中断例程是DOS提供的中断例程，<code>4ch</code>号功能，即程序返回功能</strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov ah<span class="token punctuation">,</span> <span class="token number">4</span>ch <span class="token punctuation">;</span>调用第<span class="token number">21</span>h号中断例程的<span class="token number">4</span>ch号子程序，功能为程序返回<span class="token punctuation">,</span>可以提供返回值作为参数
mov al<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">;</span>返回值
<span class="token keyword">int</span> <span class="token number">21</span>h<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<p><strong><code>编程：在屏幕的5行12列显示字符串“Welcome to masm！”</code></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code 

data segment 
	db	<span class="token char">'Welcome to masm'</span><span class="token punctuation">,</span>  <span class="token char">'$'</span>     <span class="token punctuation">;</span>“$”本身并不显示，只起到边界的作用
data ends 

code segment
start<span class="token operator">:</span>	mov ah<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">;</span><span class="token number">10</span>号中断设置光标位置功能
		mov bh<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">;</span>第<span class="token number">0</span>页
		mov dh<span class="token punctuation">,</span> <span class="token number">5</span>；dh中放行号
		mov dl<span class="token punctuation">,</span> <span class="token number">12</span> <span class="token punctuation">;</span>dl中放列号
		<span class="token keyword">int</span> <span class="token number">10</span>h 

		mov ax<span class="token punctuation">,</span> data 
		mov ds<span class="token punctuation">,</span> ax 
		mov dx<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">;</span>ds<span class="token operator">:</span>dx指向字符串的首地址data<span class="token operator">:</span><span class="token number">0</span>  （参数）
		mov ah<span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">;</span>调用第<span class="token number">21</span>h号中断例程的<span class="token number">9</span>号子程序，功能为在光标位置显示字符串，可以提供要显示字符串的地址作为参数
		<span class="token keyword">int</span> <span class="token number">21</span>h 

		mov ax<span class="token punctuation">,</span> <span class="token number">4</span>c00h <span class="token punctuation">;</span><span class="token number">21</span>号中断程序返回功能
		<span class="token keyword">int</span> <span class="token number">21</span>h 
code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h2 id="第十一章：端口"><a href="#第十一章：端口" class="headerlink" title="第十一章：端口"></a>第十一章：端口</h2><h3 id="端口的引入"><a href="#端口的引入" class="headerlink" title="端口的引入"></a><strong>端口的引入</strong></h3><blockquote>
<p><strong><font color=red>在PC机系统中，和CPU通过总线相连的芯片除各种存储器外，还有以下3种芯片：</font></strong></p>
<ol>
<li><p><strong><mark>各种接口卡（比如，网卡、显卡）上的接口芯片，它们控制接口卡进行工作</mark></strong></p>
</li>
<li><p><strong><mark>主板上的接口芯片，CPU通过它们对部分外设进行访问</mark></strong></p>
</li>
<li><p><strong><mark>其他芯片，用来存储相关的系统信息，或进行相关的输入输出处理</mark></strong></p>
</li>
</ol>
<p><strong><font color=red>在这些芯片中，都有一组可以由CPU读写的寄存器。这些寄存器，它们在物理上可能处于不同的芯片中，但是它们在以下两点上相同：</font></strong></p>
<ol>
<li><strong><mark>都和CPU的总线相连，这种连接是通过它们所在的芯片进行的</mark></strong></li>
<li><strong><mark>CPU对它们进行读或写的时候都通过控制线向它们所在的芯片发出端口读写命令</mark></strong></li>
</ol>
<p><strong>从CPU的角度，将这些寄存器都当作端口，对它们进行统一编址，从而建立了一个统一的端口地址空间,每一个端口在地址空间中都有一个地址。在访问端口的时候，CPU通过端口地址来定位端口。因为端口所在的芯片和CPU通过总线相连，<font color=red>CPU可以直接读写以下3个地方的数据:</font></strong></p>
<ol>
<li><strong><mark>CPU内部的寄存器</mark></strong></li>
<li><strong><mark>内存单元</mark></strong></li>
<li><strong><mark>端口</mark></strong></li>
</ol>
</blockquote>
<hr>
<h3 id="端口的读写"><a href="#端口的读写" class="headerlink" title="端口的读写"></a><strong>端口的读写</strong></h3><blockquote>
<ol>
<li><strong><font color=red>端口地址和内存地址一样，通过地址总线来传送。在PC系统中，CPU最多可以定位64KB个不同的端口。则端口地址的范围为<code>0-65535</code></font></strong></li>
<li><strong><font color=red>端口的读写指令只有两条：<code>in</code>和<code>out</code>，分别用于从端口读取数据和往端口写入数据</font></strong></li>
<li><strong><font color=red>在in和out指令中，只能使用ax或al来存放从端口中读入的数据或要发送到端口中的数据</font></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>对<span class="token number">0</span><span class="token operator">~</span><span class="token number">255</span>以内的端口进行读写时：    
in al<span class="token punctuation">,</span> <span class="token number">20</span>h  <span class="token punctuation">;</span>从<span class="token number">20</span>h端口读入一个字节
out <span class="token number">20</span>h<span class="token punctuation">,</span> al  <span class="token punctuation">;</span>往<span class="token number">20</span>h端口写入一个字节

<span class="token punctuation">;</span>对<span class="token number">256</span><span class="token operator">~</span><span class="token number">65535</span>的端口进行读写时，端口号放在dx中：
mov dx<span class="token punctuation">,</span> <span class="token number">3f</span><span class="token number">8</span>h  <span class="token punctuation">;</span>将端口号<span class="token number">3f</span><span class="token number">8</span>h送入dx
in al<span class="token punctuation">,</span> dx  <span class="token punctuation">;</span>从<span class="token number">3f</span><span class="token number">8</span>h端口读入一个字节
out dx<span class="token punctuation">,</span> al <span class="token punctuation">;</span>向<span class="token number">3f</span><span class="token number">8</span>h端口写入一个字节<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h3 id="CMOS-RAM芯片"><a href="#CMOS-RAM芯片" class="headerlink" title="CMOS RAM芯片"></a><strong>CMOS RAM芯片</strong></h3><blockquote>
<p><strong><font color=red>PC机中，有一个CMOS RAM芯片，一般简称为CMOS。此芯片的特征如下：</font></strong></p>
<ol>
<li><strong><mark>包含一个实时钟和一个有128个存储单元的RAM存储器</mark></strong></li>
<li><strong><mark>该芯片靠电池供电。关机后内部的实时钟正常工作，RAM中的信息不丢失</mark></strong></li>
<li><strong><mark>128个字节的RAM中，内部实时钟占用<code>0~0dh</code>单元来保存时间信息，其余大部分单元用于保存系统配置信息，供系统启动时BIOS程序读取。BIOS也提供了相关的程序，使我们可以在开机的时候配置CMOS RAM中的系统信息</mark></strong></li>
<li><strong><mark>该芯片内部有两个端口，端口地址为70h和71h。CPU通过这两个端口来读写CMOS RAM</mark></strong></li>
<li><strong><mark>70h为地址端口，存放要访问的CMOS RAM单元的地址；71h为数据端口，存放从选定的CMOS RAM单元中读取的数据，或要写入到其中的数据</mark></strong></li>
<li><strong><mark>可见，CPU对CMOS RAM的读写分两步进行，比如，读CMOS RAM的2号单元：1：将2送入端口70h  2：从端口71h读出2号单元的内容</mark></strong></li>
</ol>
</blockquote>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010215513825.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010215513825.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010215513825">

<p><strong><font color=red>BCD码是以4位二进制数表示十进制数码的编码方法 4 &#x3D;&#x3D; 0100B，一个字节可表示两个BCD码。则CMOS RAM存储时间信息的单元中，存储了用两个BCD码表示的两位十进制数，高4位的BCD码表示十位，低4位的BCD码表示个位。比如，00010100b表示14</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>编程，在屏幕中间显示当前的月份。
assume cs<span class="token operator">:</span>code
code segment 
start<span class="token operator">:</span>	mov al，<span class="token number">8</span> <span class="token punctuation">;</span>从CMOS RAM的<span class="token number">8</span>号单元读出当前月份的BCD码。
		out <span class="token number">70</span>h，al 
		in al<span class="token punctuation">,</span> <span class="token number">71</span>h <span class="token punctuation">;</span>从数据端口<span class="token number">71</span>h中取得指定单元中的数据：
		
		mov ah<span class="token punctuation">,</span> al <span class="token punctuation">;</span>al中为从CMOS RAM的<span class="token number">8</span>号单元中读出的数据
		mov cl<span class="token punctuation">,</span> <span class="token number">4</span>
		shr ah<span class="token punctuation">,</span> cl <span class="token punctuation">;</span>ah中为月份的十位数码值<span class="token punctuation">,</span>左移四位空出四位
		and al<span class="token punctuation">,</span> <span class="token number">00001111</span>b <span class="token punctuation">;</span>al中为月份的个位数码值
		
		add ah<span class="token punctuation">,</span> <span class="token number">30</span>h <span class="token punctuation">;</span>BCD码值<span class="token operator">+</span><span class="token number">30</span>h<span class="token operator">=</span>十进制数对应的ASCII
		add al<span class="token punctuation">,</span> <span class="token number">30</span>h 
		
		mov bx<span class="token punctuation">,</span> <span class="token number">0</span>b800h 
		mov es<span class="token punctuation">,</span> bx 
		mov byte ptr es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">160</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ah <span class="token punctuation">;</span>显示月份的十位数码
		mov byte ptr es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">160</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> al <span class="token punctuation">;</span>接着显示月份的个位数码
		
		mov ax，<span class="token number">4</span>c00h
		<span class="token keyword">int</span> <span class="token number">21</span>h
code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="shl和shr指令"><a href="#shl和shr指令" class="headerlink" title="shl和shr指令"></a><strong>shl和shr指令</strong></h3><p><strong><font color=red>shl和shr是逻辑移位指令，shl是逻辑左移指令，它的功能为：</font></strong></p>
<ol>
<li><strong><mark>将一个寄存器或内存单元中的数据向左移位</mark></strong></li>
<li><strong><mark>将最后移出的一位写入CF中</mark></strong></li>
<li><strong><mark>最低位用0补充</mark></strong></li>
<li><strong><mark>shr是逻辑右移指令，同理</mark></strong></li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">mov al<span class="token punctuation">,</span> <span class="token number">01001000</span>b 
shl al<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">;</span>将a1中的数据左移一位执行后（al）<span class="token operator">=</span><span class="token number">10010000</span>b，CF<span class="token operator">=</span><span class="token number">0</span>。

mov al<span class="token punctuation">,</span> <span class="token number">01010001</span>b 
mov cl<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">;</span>如果移动位数大于<span class="token number">1</span>时，必须将移动位数放在cl中
shl al<span class="token punctuation">,</span> c1

mov al<span class="token punctuation">,</span> <span class="token number">10000001</span>b 
shr al<span class="token punctuation">,</span> <span class="token number">1</span>  <span class="token punctuation">;</span>将al中的数据右移一位执行后（al）<span class="token operator">=</span><span class="token number">01000000</span>b，CF<span class="token operator">=</span><span class="token number">1</span>。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong><font color=red>补充：将X逻辑左移一位，相当于执行X&#x3D;X*2,将X逻辑右移一位，相当于执行X&#x3D;X&#x2F;2</font></strong></p>
<hr>
<h2 id="第十二章：外中断"><a href="#第十二章：外中断" class="headerlink" title="第十二章：外中断"></a>第十二章：外中断</h2><h3 id="外中断概念"><a href="#外中断概念" class="headerlink" title="外中断概念"></a><strong>外中断概念</strong></h3><blockquote>
<ol>
<li><strong>CPU在计算机系统中，除了能够执行指令，进行运算以外，还应该能够对外部设备进行控制，接收它们的输入，向它们进行输出（I&#x2F;O能力）</strong></li>
<li><strong>PC系统的接口卡和主板上，装有各种接口芯片。这些外设接口芯片的内部有若干寄存器，CPU将这些寄存器当作端口来访问</strong></li>
<li><strong>外设的输入不直接送入内存和CPU，而是送入相关的接口芯片的端口中</strong></li>
<li><strong>CPU向外设的输出也不是直接送入外设，而是先送入端口中，再由相关的芯片送到外设</strong></li>
<li><strong>CPU还可以向外设输出控制命令，而这些控制命令也是先送到相关芯片的端口中，然后再由相关的芯片根据命令对外设实施控制,即：CPU通过端口和外部设备进行联系</strong></li>
<li><strong>当CPU外部有需要处理的事情发生的时候，比如说，外设的输入到达，相关芯片将向CPU发出相应的中断信息。CPU在执行完当前指令后，可以检测到发送过来的中断信息，引发中断过程，处理外设的输入</strong></li>
</ol>
</blockquote>
<p><strong><font color=red>PC系统中，外中断源有两类：</font></strong></p>
<blockquote>
<ol>
<li><strong><font color=red>可屏蔽中断</font></strong><ol>
<li><strong>可屏蔽中断是CPU可以不响应的外中断。CPU是否响应可屏蔽中断，要看标志寄存器的IF位的设置</strong></li>
<li><strong>当CPU检测到可屏蔽中断信息时，如果IF&#x3D;1，则CPU在执行完当前指令后响应中断，引发中断过程；如果IF&#x3D;0，则不响应可屏蔽中断</strong></li>
<li><strong>可屏蔽中断信息来自于CPU外部，中断类型码是通过数据总线送入CPU的；而内中断的中断类型码是在CPU内部产生的</strong></li>
<li><strong>中断过程中将IF置0的原因就是，在进入中断处理程序后，禁止其他的可屏蔽中断</strong></li>
<li><strong>如果在中断处理程序中需要处理可屏蔽中断，可以用指令将IF置1</strong></li>
<li><strong>8086CPU提供的设置IF的指令：<code>sti</code>，设置IF&#x3D;1；<code>cli</code>，设置IF&#x3D;0</strong></li>
</ol>
</li>
<li><strong><font color=red>不可屏蔽中断</font></strong><ol>
<li><strong>不可屏蔽中断是CPU必须响应的外中断。当CPU检测到不可屏蔽中断信息时，则在执行完当前指令后，立即响应，引发中断过程</strong></li>
<li><strong>对于8086CPU，不可屏蔽中断的中断类型码固定为2，所以中断过程中，不需要取中断类型码。则不可屏蔽中断的中断过程为：①标志寄存器入栈，IF&#x3D;0，TF&#x3D;0；②CS、IP入栈；③（IP）&#x3D;（8），（CS）&#x3D;（0AH）</strong></li>
<li><strong>几乎所有由外设引发的外中断，都是可屏蔽中断。当外设有需要处理的事件（比如说键盘输入）发生时，相关芯片向CPU发出可屏蔽中断信息。不可屏蔽中断是在系统中有必须处理的紧急情况发生时用来通知CPU的中断信息</strong></li>
</ol>
</li>
</ol>
</blockquote>
<hr>
<h3 id="PC机键盘的处理过程"><a href="#PC机键盘的处理过程" class="headerlink" title="PC机键盘的处理过程"></a><strong>PC机键盘的处理过程</strong></h3><blockquote>
<ol>
<li><strong>键盘中有一个芯片对键盘上的每一个键的开关状态进行扫描。按下一个键时，开关接通，该芯片就产生一个扫描码，扫描码说明了按下的键在键盘上的位置。扫描码被送入主板上的相关接口芯片的寄存器中，该寄存器的端口地址为60h。松开按下的键时，也产生一个扫描码，扫描码说明了松开的键在键盘上的位置。松开按键时产生的扫描码也被送入60h端口中</strong></li>
<li><strong>一般将按下一个键时产生的扫描码称为通码，松开一个键产生的扫描码称为断码</strong></li>
<li><strong>扫描码长度为一个字节，通码的第7位为0，断码的第7位为1。即：断码 &#x3D; 通码 + 80h。比如，g键的通码为22h，断码为a2h</strong></li>
<li><strong>键盘的输入到达60h端口时，相关的芯片就会向CPU发出中断类型码为9的可屏蔽中断信息。CPU检测到该中断信息后，如果IF&#x3D;1，则响应中断，引发中断过程，转去执行int 9中断例程</strong></li>
</ol>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010220731001.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010220731001.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010220731001">

<p><strong><font color=red>BIOS提供了int 9中断例程，用来进行基本的键盘输入处理，主要的工作如下：</font></strong></p>
<ol>
<li><strong>读出60h端口中的扫描码</strong></li>
<li><strong>如果是字符键的扫描码，将该扫描码和它所对应的字符码（即ASCII码）送入内存中的BIOS键盘缓冲区； 如果是控制键（比如Ctrl）和切换键（比如CapsLock）的扫描码，则将其转变为状态字节写入内存中存储状态字节的单元</strong></li>
<li><strong>对键盘系统进行相关的控制，比如说，向相关芯片发出应答信息</strong></li>
</ol>
<p><strong><font color=red>BIOS键盘缓冲区可以存储15个键盘输入，一个键盘输入用一个字单元存放，高位字节存放扫描码，低位字节存放字符码</font></strong></p>
<p><strong><code>0040:17</code>单元存储键盘状态字节，该字节记录了控制键和切换键的状态。键盘状态字节各位记录的信息如下:</strong></p>
<img src="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010220731002.png" class="lazyload placeholder" data-srcset="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/image-20221010220731002.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" class=" lazyload placeholder" title="image-20221010220731002">



<p><strong><font color=red>编写int 9中断例程：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>编程：在屏幕中间依次显示“a”<span class="token operator">~</span>“z”，并可以让人看清。在显示的过程中，按下<span class="token char">'Esc'</span>键后，改变显示的颜色。

<span class="token punctuation">;</span>完整功能代码：
；<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>老<span class="token keyword">int</span> <span class="token number">9</span>中断例程<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
assume cs<span class="token operator">:</span>code

stack segment
	db <span class="token number">128</span> <span class="token function">dup</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
stack ends

data segment
	dw <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>
data ends

code segment
start<span class="token operator">:</span>	
	mov ax<span class="token punctuation">,</span>stack
	mov ss<span class="token punctuation">,</span>ax
	mov sp<span class="token punctuation">,</span><span class="token number">128</span>
	mov ax<span class="token punctuation">,</span>data
	mov ds<span class="token punctuation">,</span>ax
	mov ax<span class="token punctuation">,</span><span class="token number">0</span>
	mov es<span class="token punctuation">,</span>ax

	push es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span>
	pop ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	push es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>
	pop ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>		<span class="token punctuation">;</span>将原来的<span class="token keyword">int</span> <span class="token number">9</span>中断例程的入口地址保存在ds<span class="token operator">:</span><span class="token number">0</span>、ds<span class="token operator">:</span><span class="token number">2</span>单元中

	mov word ptr es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> offset int9
	mov es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cs	<span class="token punctuation">;</span>在中断向量表中设置新的<span class="token keyword">int</span> <span class="token number">9</span>中断例程的入口地址

<span class="token punctuation">;</span>显示字符串
	mov ax<span class="token punctuation">,</span> <span class="token number">0</span>b800h
	mov es<span class="token punctuation">,</span> ax
	mov ah<span class="token punctuation">,</span> <span class="token char">'a'</span>
s<span class="token operator">:</span>	
	mov  es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">160</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ah
	call delay
	inc ah
	cmp ah<span class="token punctuation">,</span> <span class="token char">'z'</span>
	jna s
	mov ax<span class="token punctuation">,</span><span class="token number">0</span>
	mov es<span class="token punctuation">,</span>ax

	push ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	pop es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span>
	push ds<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
	pop es<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>   	<span class="token punctuation">;</span>将中断向量表中<span class="token keyword">int</span> <span class="token number">9</span>中断例程的入口恢复为原来的地址

	mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
	<span class="token keyword">int</span> <span class="token number">21</span>h

<span class="token punctuation">;</span>将循环延时的程序段写为一个子程序
delay<span class="token operator">:</span>	
	push ax 
	push dx
	mov dx<span class="token punctuation">,</span> <span class="token number">2000</span>h  <span class="token punctuation">;</span>用两个<span class="token number">16</span>位寄存器来存放<span class="token number">32</span>位的循环次数
	mov ax<span class="token punctuation">,</span> <span class="token number">0</span>
s1<span class="token operator">:</span> 	
	sub ax<span class="token punctuation">,</span> <span class="token number">1</span>
	sbb dx<span class="token punctuation">,</span> <span class="token number">0</span>
	cmp ax<span class="token punctuation">,</span> <span class="token number">0</span>
	jne s1
	cmp dx<span class="token punctuation">,</span> <span class="token number">0</span>
	jne s1
	pop dx
	pop ax
	ret

<span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>以下为新的<span class="token keyword">int</span> <span class="token number">9</span>中断例程<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>

int9<span class="token operator">:</span>	
	push ax
	push bx
	push es

	in al<span class="token punctuation">,</span> <span class="token number">60</span>h<span class="token punctuation">;</span>从端口<span class="token number">60</span>h读出键盘的输入

	pushf <span class="token punctuation">;</span>标志寄存器入栈

	pushf   
	pop bx
	and bh<span class="token punctuation">,</span><span class="token number">11111100</span>b
	push bx
	popf	<span class="token punctuation">;</span>TF<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>IF<span class="token operator">=</span><span class="token number">0</span>

	call dword ptr ds<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 	<span class="token punctuation">;</span>对<span class="token keyword">int</span>指令进行模拟，调用原来的<span class="token keyword">int</span> <span class="token number">9</span>中断例程

	cmp al<span class="token punctuation">,</span><span class="token number">1</span>
	jne int9ret

	mov ax<span class="token punctuation">,</span><span class="token number">0</span>b800h
	mov es<span class="token punctuation">,</span>ax
	inc byte ptr es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">160</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token punctuation">;</span>属性增加<span class="token number">1</span>，改变颜色

int9ret<span class="token operator">:</span>
	pop es
	pop bx
	pop ax
	iret

code ends

end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>CPU对外设输入的通常处理方法：</font></strong><br><strong><mark>（1）外设的输入送入端口</mark></strong><br><strong><mark>（2）向CPU发出外中断（可屏蔽中断）信息</mark></strong><br><strong><mark>（3）CPU检测到可屏蔽中断信息，如果IF&#x3D;1，CPU在执行完当前指令后响应中断，执行相应的中断例程</mark></strong><br><strong><mark>（4）可在中断例程中实现对外设输入的处理</mark></strong></p>
<p><strong><font color=red>端口和中断机制，是CPU进行I&#x2F;O的基础</font></strong></p>
</blockquote>
<hr>
<h2 id="第十三章：直接定址法"><a href="#第十三章：直接定址法" class="headerlink" title="第十三章：直接定址法"></a>第十三章：直接定址法</h2><h3 id="描述了单元长度的标号"><a href="#描述了单元长度的标号" class="headerlink" title="描述了单元长度的标号"></a><strong>描述了单元长度的标号</strong></h3><p><strong><font color=red>我们一直在代码段中使用标号来标记指令、数据、段的起始地址。比如：下面的程序(将code段中a标号处的8个数据累加，结果存放在b标号处的字中)</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code
code segment
         a <span class="token operator">:</span> db <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span>  <span class="token punctuation">;</span>在后面加有“：”的地址标号，只能在代码段中使用，不能在其他段中使用。
         b <span class="token operator">:</span> dw <span class="token number">0</span>
start <span class="token operator">:</span>mov si<span class="token punctuation">,</span>offset a
         mov bx<span class="token punctuation">,</span>offset b
         mov cx<span class="token punctuation">,</span><span class="token number">8</span>
    s <span class="token operator">:</span> mov al<span class="token punctuation">,</span>cs<span class="token operator">:</span><span class="token punctuation">[</span>si<span class="token punctuation">]</span>
         mov ah<span class="token punctuation">,</span><span class="token number">0</span>
         add cs<span class="token operator">:</span><span class="token punctuation">[</span>bx<span class="token punctuation">]</span><span class="token punctuation">,</span>ax
         inc si
         loop s
         mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
         <span class="token keyword">int</span> <span class="token number">21</span>h
code ends
end start
<span class="token punctuation">;</span>程序中，code、a、b、start、s都是标号。这些标号仅仅表示了内存单元的地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><strong><font color=red>但是我们还是可以使用一种标号，这种标号不但可以表示内存单元地址，还表示了内存单元的长度，即表示在此标号处的单元，是一个字节单元，还是字单元，还是双字单元。所以，上面的代码还可以写成：</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token punctuation">;</span>描述了单位长度的标号
assume cs<span class="token operator">:</span>code
code segment
          a db <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span> <span class="token punctuation">;</span>标号a、b后面没有<span class="token string">":"</span>，因此它们是可以同时描述内存地址和单元长度的标号。
                               <span class="token punctuation">;</span>标号a，描述了地址code<span class="token operator">:</span><span class="token number">0</span>，和从这个地址开始，以后的内存单元都是字节单元
          b dw <span class="token number">0</span>               <span class="token punctuation">;</span>标号b描述了地址code<span class="token operator">:</span><span class="token number">8</span>，和从这个地址开始，以后的内存单元都是字单元。
start <span class="token operator">:</span>  mov si<span class="token punctuation">,</span><span class="token number">0</span>
          mov cx<span class="token punctuation">,</span><span class="token number">8</span>
    s <span class="token operator">:</span>   mov al<span class="token punctuation">,</span>a<span class="token punctuation">[</span>si<span class="token punctuation">]</span>
          mov ah<span class="token punctuation">,</span><span class="token number">0</span>
          add b<span class="token punctuation">,</span>ax
          inc si
          loop s
          mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
          <span class="token keyword">int</span> <span class="token number">21</span>h
code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="在其他段中使用数据标号"><a href="#在其他段中使用数据标号" class="headerlink" title="在其他段中使用数据标号"></a><strong>在其他段中使用数据标号</strong></h3><p><strong><font color=red>一般来说，我们不在代码段中定义数据，而是将数据定义到其他段中。其他段中，我们也可以使用数据标号来描述存储数据的单元的地址和长度，比如下面的程序：将data段中a标号处的8个数据累加，结果存在b标记处的字中</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">；注意：后面加：的地址标号，只能在代码段中使用，不能在其他段中使用
    
assume cs<span class="token operator">:</span>code<span class="token punctuation">,</span>ds<span class="token operator">:</span>data ；用伪指令assume将标号所在的段和一个段寄存器联系起来<span class="token punctuation">(</span>编译器需要<span class="token punctuation">)</span>
data segment          
          a db <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span>
          b dw <span class="token number">0</span>
data ends
code segment
start<span class="token operator">:</span>  mov ax<span class="token punctuation">,</span>data
          mov ds<span class="token punctuation">,</span>ax <span class="token punctuation">;</span>真正确定ds寄存器
          mov si<span class="token punctuation">,</span><span class="token number">0</span>
          mov cx<span class="token punctuation">,</span><span class="token number">8</span>
s<span class="token operator">:</span>       mov al<span class="token punctuation">,</span>a<span class="token punctuation">[</span>si<span class="token punctuation">]</span> <span class="token punctuation">;</span>编译为：mov al<span class="token punctuation">,</span><span class="token punctuation">[</span>si<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">]</span> 默认所访问单元的段地址在ds
          mov ah<span class="token punctuation">,</span><span class="token number">0</span>
          add b<span class="token punctuation">,</span>ax <span class="token punctuation">;</span>编译为：add <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ax
          inc si
          loop s
          mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
          <span class="token keyword">int</span> <span class="token number">21</span>h
code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c">data segment
	a db <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span>
	b dw <span class="token number">0</span>
	c dw a<span class="token punctuation">,</span> b <span class="token punctuation">;</span>等价于c dw offset a<span class="token punctuation">,</span> offset b
	<span class="token punctuation">;</span>数据标号c处存储的两个字型数据为标号a、b 的偏移地址
data ends

data segment
	a db <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span>
	b dw <span class="token number">0</span>
	c dd a<span class="token punctuation">,</span>b <span class="token punctuation">;</span>等价于c dw offset a<span class="token punctuation">,</span> seg a<span class="token punctuation">,</span> offset b<span class="token punctuation">,</span> seg b 注：seg操作符，功能为取得某一标号的段地址
	<span class="token punctuation">;</span>数据标号c处存储的两个双字型数据为标号a的偏移地址和段地址、标号b 的偏移地址和段地址
data ends<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h3 id="直接定址表"><a href="#直接定址表" class="headerlink" title="直接定址表"></a><strong>直接定址表</strong></h3><p><strong><font color=red>建立一张表，表中依次存储“0”~“F”，我们可以通过数值0 ~15直接查找到对应的字符</font></strong></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">assume cs<span class="token operator">:</span>code

code segment
start<span class="token operator">:</span>  
		mov al<span class="token punctuation">,</span><span class="token number">0</span>eh

        call showbyte

        mov ax<span class="token punctuation">,</span><span class="token number">4</span>c00h
        <span class="token keyword">int</span> <span class="token number">21</span>h

<span class="token punctuation">;</span>子程序：
<span class="token punctuation">;</span>用al传送要显示的数据

showbyte<span class="token operator">:</span>
        jmp <span class="token keyword">short</span> show

        table db <span class="token char">'0123456789ABCDEF'</span>	<span class="token punctuation">;</span>字符表

show<span class="token operator">:</span>   push bx
        push es

        mov ah<span class="token punctuation">,</span>al
        shr ah<span class="token punctuation">,</span><span class="token number">1</span>           
        shr ah<span class="token punctuation">,</span><span class="token number">1</span>
        shr ah<span class="token punctuation">,</span><span class="token number">1</span>
        shr ah<span class="token punctuation">,</span><span class="token number">1</span>			    <span class="token punctuation">;</span>右移<span class="token number">4</span>位，ah中得到高<span class="token number">4</span>位的值
        and al<span class="token punctuation">,</span><span class="token number">00001111</span>b		<span class="token punctuation">;</span>al中为低<span class="token number">4</span>位的值

        mov bl<span class="token punctuation">,</span>ah
        mov bh<span class="token punctuation">,</span><span class="token number">0</span>
        mov ah<span class="token punctuation">,</span>table<span class="token punctuation">[</span>bx<span class="token punctuation">]</span>		<span class="token punctuation">;</span>用高<span class="token number">4</span>位的值作为相对于table的偏移，取得对应的字符

        mov bx<span class="token punctuation">,</span><span class="token number">0</span>b800h
        mov es<span class="token punctuation">,</span>bx
        mov es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">160</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ah

        mov bl<span class="token punctuation">,</span>al
        mov bh<span class="token punctuation">,</span><span class="token number">0</span>
        mov al<span class="token punctuation">,</span>table<span class="token punctuation">[</span>bx<span class="token punctuation">]</span>		<span class="token punctuation">;</span>用低<span class="token number">4</span>位的值作为相对于table的偏移，取得对应的字符
        
        mov es<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">160</span><span class="token operator">*</span><span class="token number">12</span><span class="token operator">+</span><span class="token number">40</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>al

        pop es
        pop bx
        ret

code ends
end start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<hr>
<h2 id="第十四章：指令系统总结"><a href="#第十四章：指令系统总结" class="headerlink" title="第十四章：指令系统总结"></a>第十四章：指令系统总结</h2><p><strong>我们对8086CPU的指令系统进行一下总结。若要详细了解8086指令系统中的各个指令的用法，可以查看有关的指令手册</strong></p>
<p><strong>8086CPU提供以下几大类指令：</strong></p>
<ol>
<li><strong>数据传送指令：<code>mov、push、pop、pushf、popf、xchg</code> 等都是数据传送指令，这些指令实现寄存器和内存、寄器和寄存器之间的单个数据传送</strong></li>
<li><strong>算术运算指令：<code>add、sub、adc、sbb、inc、dec、cmp、imul、idiv、aaa</code>等都是算术运算指令，这些指令实现存器和内存中的数据的算数运算。它们的执行结果影响标志寄存器的<code>sf、zf、of、cf、pf、af</code>位</strong></li>
<li><strong>逻辑指令：<code>and、or、not、xor、test、shl、shr、sal、sar、rol、ror、rcl、rcr</code>等都是逻辑指令。除了not指外，它们的执行结果都影响标志寄存器的相关标志位</strong></li>
<li><strong>转移指令：可以修改IP，或同时修改CS和IP的指令统称为转移指令</strong><ul>
<li><strong>转移指令分为以下几类：</strong><ol>
<li><strong>无条件转移指令，比如：<code>jmp</code></strong></li>
<li><strong>条件转移指令，比如：<code>jcxz、je、jb、ja、jnb、jna</code>等</strong></li>
<li><strong>循环指令，比如：<code>loop</code></strong></li>
<li><strong>过程，比如：<code>call、ret、retf</code></strong></li>
<li><strong>中断，比如：<code>int、iret</code></strong></li>
</ol>
</li>
</ul>
</li>
<li><strong>处理机控制指令：对标志寄存器或其他处理机状态进行设置，<code>cld、std、cli、sti、nop、clc、cmc、stc、hlt、wait、esc、lock</code>等都是处理机控制指令</strong></li>
<li><strong>串处理指令：对内存中的批量数据进行处理，<code>movsb、movsw、cmps、scas、lods、stos</code>等。若要使用这些指令方便地进行批量数据的处理，则需要和<code>rep、repe、repne</code> 等前缀指令配合使用</strong></li>
</ol>

      </div>
      <div class="post-tags-categories">
        
        <div class="tags">
          
            <a href="/tags/%E4%B8%93%E4%B8%9A%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA/" class="">
              专业核心基础理论
            </a>
          
        </div>
        
      </div>
      
        <div class="copyright">
  <ul class="post-copyright">
    <li class="post-copyright-author">
    <strong>作者:  </strong>牟建波</a>
    </li>
    <li class="post-copyright-link">
    <strong>文章链接:  </strong>
    <a href="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/" target="_blank" title="专业核心基础理论：汇编语言">https://Not-Go.github.io/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-hui-bian-yu-yan/</a>
    </li>
    <li class="post-copyright-license">
      <strong>版权声明:   </strong>
      本网站所有文章除特别声明外,均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
      许可协议。转载请注明出处!
    </li>
  </ul>
<div>
      
    </article>
    <!-- 上一篇文章和下一篇文章 -->
    
      <!-- 文章详情页的上一页和下一页 -->
<div class="post-nav">



  
  <div class="post-nav-prev post-nav-item">
    <div class="post-nav-img" style="background-size: cover; 
      background-position: center center;">
      <img class="lazyload lazyload placeholder" src="https://pic3.zhimg.com/80/v2-7cfc909ebe8d83683909846edd6b5232_1440w.webp" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/80/v2-7cfc909ebe8d83683909846edd6b5232_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
    </div>
    <a href="/2022/04/20/zhuan-ye-he-xin-ji-chu-li-lun-shu-ju-ku/" class="post-nav-link">
      <div class="title">
        <i class="fas fa-angle-left"></i> 上一篇:
        <div class="title-text">专业核心基础理论：数据库</div>
      </div>
      
      <!-- <div class="content">
        专业核心基础理论：数据库第一章：数据库概述数据库系统概述本章思维导图


四大基本概念数据—Data


数据库—Dat
      </div> -->
    </a>
  </div>



</div>

    
    

    <!-- 打赏 -->
    
      <div id="appDonate" class="post-donate">
  <div id="donate_board" class="donate_bar center" ref="donate">
    <a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏" @click="showDialogDrawer()"></a>
  </div>
  <transition name="fade">
    <div 
      class="donate-box-mask"
      v-cloak 
      v-show="visible"
      @click="cancelDialogDrawer()"
    >
    </div>
  </transition>
  <transition name="bounce">
    <div class="donate-box" v-cloak v-show="visible">
      <div class="donate-box_close">
        <i class="fas fa-times" aria-hidden="true" @click="cancelDialogDrawer" pointer></i>
      </div>
      <div class="donate-box_title">
        <h4>
          你的赏识是我前进的动力
        </h4>
      </div>
      <div class="donate-box_tab">
        <div class="Alipay" pointer :class="{'active': tabActive === 'Alipay'}" @click="changeTabActive('Alipay')">
          支付宝
        </div>
        <div class="WeChatpay" pointer :class="{'active': tabActive === 'WeChatpay'}" @click="changeTabActive('WeChatpay')">
          微信
        </div>
      </div>
      <div class="donate-box_img">
        <div class="AlipayImg" v-show="tabActive === 'Alipay'">
          <img src="/img/qq.jpg" class="lazyload placeholder" data-srcset="/img/qq.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="支付宝打赏" />
        </div> 
        <div class="WeChatpayImg" v-show="tabActive === 'WeChatpay'">
          <img src="/img/wechat.jpg" class="lazyload placeholder" data-srcset="/img/wechat.jpg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="微信打赏" />
        </div>
      </div>
    </div>
  </transition>
</div>

<script>
  var body = document.body || document.documentElement || window;
  var vm = new Vue({
    el: '#appDonate',
    data: {
      visible: false,
      tabActive: 'Alipay',
      top: 0,
    },
    computed: {
    },
    mounted() {
    },
    methods: {
      showDialogDrawer() {
        this.visible = true;
        // 防止页面滚动，只能让弹框滚动
        // function getScroll() {
        //   return {
        //     left: window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0,
        //     top: window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0
        //   };
        // }
        this.top = $(document).scrollTop() // or getScroll().top
        // console.log('aa', $('.main-content'));
        body.style.cssText = 'overflow: hidden;';
      },
      cancelDialogDrawer() {
        this.visible = false;
        body.removeAttribute('style');
        $(document).scrollTop(this.top)
      },
      changeTabActive(name) {
        this.tabActive = name;
      }
    },
    created() {}
  })
</script>
    

    <!-- 分享 -->
    
      <!-- https://github.com/overtrue/share.js -->
<!-- 文章详情页的分享 -->
<div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>

<script src="/js/shareJs/social-share.min.js"></script>
</script>

<style>
  .social-share {
    margin: 20px 0;
  }
</style>


    
    
    <!-- 评论 -->
    <!-- 评论 -->

  <div id="myComment">
    
      <div id="gitment-container"></div>

    
  </div>

<!-- comment script in themes\hexo-theme-bamboo\layout\_partial\scripts\index.ejs -->


  </div>

  <!-- 目录 -->
  <aside id='l_side'>
  
    
      <section class="widget side_blogger">
  <div class='content'>
    
      
        <a class='avatar flat-box rectangle' href='/about/'>
          <img src='https://pic2.zhimg.com/80/v2-42b72d5ebee4b8d8aa70d9687effe87b_1440w.webp'/>
        </a>
      
    
    
      <div class='text'>
        
          <h2>牟建波</h2>
        
        
        
          <p><span id="jinrishici-sentence">建波的学习妙妙屋</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1353429820"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="mailto:me@1353429820@qq.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="https://gitee.com/Not_Go"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
          
            <a href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1353429820"
              class="social fab fa-qq flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
              
            </a>
          
        
      </div>
    
  </div>
</section>

    
  
  
  
    
  

  <div class="layout_sticky">    
    
      
<section class="widget side_toc">
  
  <header>
    
      <i style="color: " class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name' style="color: ">本文目录</span>
    
  </header>


  <div class='content'>
    <div class="toc-main">
      <div class="toc-content">
        <!-- <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%93%E4%B8%9A%E6%A0%B8%E5%BF%83%E5%9F%BA%E7%A1%80%E7%90%86%E8%AE%BA%EF%BC%9A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80"><span class="toc-text">专业核心基础理论：汇编语言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80"><span class="toc-text">第一章：汇编语言基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-text">指令基础概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E5%99%A8%E6%A6%82%E5%BF%B5"><span class="toc-text">存储器概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BA%BF%E6%A6%82%E5%BF%B5"><span class="toc-text">总线概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CPU%E5%AF%B9%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E8%AF%BB%E5%86%99"><span class="toc-text">CPU对存储器的读写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CPU%E5%AF%B9%E5%A4%96%E8%AE%BE%E7%9A%84%E6%8E%A7%E5%88%B6"><span class="toc-text">CPU对外设的控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%E7%A9%BA%E9%97%B4%E6%A6%82%E5%BF%B5"><span class="toc-text">内存地址空间概念</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A8086CPU%E7%9A%84%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">第二章：8086CPU的寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8086cpu%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-text">8086cpu寄存器的基本结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8%E5%9F%BA%E7%A1%80"><span class="toc-text">通用寄存器基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8086cpu%E7%BB%99%E5%87%BA%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">8086cpu给出物理地址的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%B5%E5%AF%84%E5%AD%98%E5%99%A8%E5%89%96%E6%9E%90"><span class="toc-text">段寄存器剖析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CS%E5%92%8CIP%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">CS和IP寄存器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DS%E5%92%8C-address-%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">DS和[address]寄存器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SS%E5%92%8CSP%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">SS和SP寄存器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%B1%87%E7%BC%96%E7%A8%8B%E5%BA%8F"><span class="toc-text">第三章：第一个汇编程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E6%A8%A1%E6%8B%9F%E7%A8%8B%E5%BA%8F%EF%BC%9ADOSBox%E4%BD%BF%E7%94%A8"><span class="toc-text">汇编模拟程序：DOSBox使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E7%A8%8B%E5%BA%8F%E4%BB%8E%E5%86%99%E5%87%BA%E5%88%B0%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-text">汇编程序从写出到执行的过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E8%B7%9F%E8%B8%AA"><span class="toc-text">程序执行过程跟踪</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0%EF%BC%9A-bx-%E4%B8%8Eloop%E6%8C%87%E4%BB%A4"><span class="toc-text">第四章：[bx]与loop指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bx-%E4%B8%8Eloop%E6%8C%87%E4%BB%A4%E6%A6%82%E5%BF%B5"><span class="toc-text">[bx]与loop指令概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bx-%E5%92%8Cloop%E7%9A%84%E8%81%94%E5%90%88%E5%BA%94%E7%94%A8"><span class="toc-text">[bx]和loop的联合应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%B5%E5%89%8D%E7%BC%80%E6%A6%82%E5%BF%B5"><span class="toc-text">段前缀概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E6%AE%B5%E7%9A%84%E7%A8%8B%E5%BA%8F%E6%A1%88%E4%BE%8B"><span class="toc-text">包含多个段的程序案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0%EF%BC%9A%E6%9B%B4%E7%81%B5%E6%B4%BB%E5%AE%9A%E4%BD%8D%E5%86%85%E5%AD%98%E5%9C%B0%E5%9D%80%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">第五章：更灵活定位内存地址的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#and%E5%92%8Cor"><span class="toc-text">and和or</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E5%AD%97%E7%AC%A6%E5%BD%A2%E5%BC%8F%E7%BB%99%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-text">以字符形式给出的数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bx-idata"><span class="toc-text">[bx+idata]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SI%E3%80%81DI%E4%B8%8E%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F%E7%9A%84%E7%81%B5%E6%B4%BB%E5%BA%94%E7%94%A8"><span class="toc-text">SI、DI与寻址方式的灵活应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%9F%BA%E6%9C%AC%E9%97%AE%E9%A2%98"><span class="toc-text">第六章：数据处理的两个基本问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bx%E3%80%81si%E3%80%81di%E5%92%8Cbp%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">bx、si、di和bp寄存器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%BA%E5%99%A8%E6%8C%87%E4%BB%A4%E5%A4%84%E7%90%86%E7%9A%84%E6%95%B0%E6%8D%AE%E5%9C%A8%E4%BB%80%E4%B9%88%E5%9C%B0%E6%96%B9"><span class="toc-text">机器指令处理的数据在什么地方</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E4%B8%AD%E6%95%B0%E6%8D%AE%E4%BD%8D%E7%BD%AE%E7%9A%84%E8%A1%A8%E8%BE%BE"><span class="toc-text">汇编语言中数据位置的表达</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F"><span class="toc-text">寻址方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E8%A6%81%E5%A4%84%E7%90%86%E7%9A%84%E6%95%B0%E6%8D%AE%E6%9C%89%E5%A4%9A%E9%95%BF"><span class="toc-text">指令要处理的数据有多长</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F%E7%9A%84%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8"><span class="toc-text">寻址方式的综合应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#div%E6%8C%87%E4%BB%A4%E3%80%81%E4%BC%AA%E6%8C%87%E4%BB%A4dd%E3%80%81dup%E3%80%81mul%E6%8C%87%E4%BB%A4"><span class="toc-text">div指令、伪指令dd、dup、mul指令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0%EF%BC%9A%E8%BD%AC%E7%A7%BB%E6%8C%87%E4%BB%A4%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">第七章：转移指令的原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E7%A7%BB%E6%8C%87%E4%BB%A4%E6%A6%82%E5%BF%B5"><span class="toc-text">转移指令概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6offset"><span class="toc-text">操作符offset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jmp%E6%8C%87%E4%BB%A4"><span class="toc-text">jmp指令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E6%8D%AE%E4%BD%8D%E7%A7%BB%E8%BF%9B%E8%A1%8C%E8%BD%AC%E7%A7%BB%E7%9A%84jmp%E6%8C%87%E4%BB%A4"><span class="toc-text">依据位移进行转移的jmp指令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AC%E7%A7%BB%E7%9A%84%E7%9B%AE%E7%9A%84%E5%9C%B0%E5%9D%80%E5%9C%A8%E6%8C%87%E4%BB%A4%E4%B8%AD%E7%9A%84jmp%E6%8C%87%E4%BB%A4"><span class="toc-text">转移的目的地址在指令中的jmp指令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AC%E7%A7%BB%E5%9C%B0%E5%9D%80%E5%9C%A8%E5%AF%84%E5%AD%98%E5%99%A8%E6%88%96%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84jmp%E6%8C%87%E4%BB%A4"><span class="toc-text">转移地址在寄存器或内存中的jmp指令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jcxz%E6%8C%87%E4%BB%A4%E5%92%8Cloop%E6%8C%87%E4%BB%A4"><span class="toc-text">jcxz指令和loop指令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0%EF%BC%9ACALL%E5%92%8CRET%E6%8C%87%E4%BB%A4"><span class="toc-text">第八章：CALL和RET指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ret%E5%92%8Cretf%E6%8C%87%E4%BB%A4"><span class="toc-text">ret和retf指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call%E6%8C%87%E4%BB%A4"><span class="toc-text">call指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call%E5%92%8Cret%E7%9A%84%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-text">call和ret的配合使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0%EF%BC%9A%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">第九章：标志寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E6%A6%82%E5%BF%B5"><span class="toc-text">标志寄存器概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%B6%E6%A0%87%E5%BF%97%E4%BD%8D-ZF"><span class="toc-text">零标志位(ZF)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A5%87%E5%81%B6%E6%A0%87%E5%BF%97%E4%BD%8D-PF"><span class="toc-text">奇偶标志位(PF)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E6%A0%87%E5%BF%97%E7%AC%A6-SF"><span class="toc-text">符号标志符(SF)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E4%BD%8D%E6%A0%87%E5%BF%97%E7%AC%A6-CF"><span class="toc-text">进位标志符(CF)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%A2%E5%87%BA%E6%A0%87%E5%BF%97%E7%AC%A6-OF"><span class="toc-text">溢出标志符(OF)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#adc%E6%8C%87%E4%BB%A4%E5%92%8Csbb%E6%8C%87%E4%BB%A4"><span class="toc-text">adc指令和sbb指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cmp%E6%8C%87%E4%BB%A4"><span class="toc-text">cmp指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E6%AF%94%E8%BE%83%E7%BB%93%E6%9E%9C%E7%9A%84%E6%9D%A1%E4%BB%B6%E8%BD%AC%E7%A7%BB%E6%8C%87%E4%BB%A4"><span class="toc-text">检测比较结果的条件转移指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DF%E6%A0%87%E5%BF%97%E5%92%8C%E4%B8%B2%E4%BC%A0%E9%80%81%E6%8C%87%E4%BB%A4"><span class="toc-text">DF标志和串传送指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pushf%E5%92%8Cpopf"><span class="toc-text">pushf和popf</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0%EF%BC%9A%E5%86%85%E4%B8%AD%E6%96%AD"><span class="toc-text">第十章：内中断</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E4%B8%AD%E6%96%AD%E7%9A%84%E4%BA%A7%E7%94%9F"><span class="toc-text">内中断的产生</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E3%80%81%E4%B8%AD%E6%96%AD%E5%90%91%E9%87%8F%E8%A1%A8%E3%80%81%E4%B8%AD%E6%96%AD%E8%BF%87%E7%A8%8B"><span class="toc-text">中断处理程序、中断向量表、中断过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iret%E6%8C%87%E4%BB%A4"><span class="toc-text">iret指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%A4%E6%B3%95%E9%94%99%E8%AF%AF%E4%B8%AD%E6%96%AD%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-text">除法错误中断的处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5%E4%B8%AD%E6%96%AD"><span class="toc-text">单步中断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#int%E6%8C%87%E4%BB%A4"><span class="toc-text">int指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BIOS%E5%92%8CDOS%E6%89%80%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%AD%E6%96%AD%E4%BE%8B%E7%A8%8B"><span class="toc-text">BIOS和DOS所提供的中断例程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0%EF%BC%9A%E7%AB%AF%E5%8F%A3"><span class="toc-text">第十一章：端口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E7%9A%84%E5%BC%95%E5%85%A5"><span class="toc-text">端口的引入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E7%9A%84%E8%AF%BB%E5%86%99"><span class="toc-text">端口的读写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CMOS-RAM%E8%8A%AF%E7%89%87"><span class="toc-text">CMOS RAM芯片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shl%E5%92%8Cshr%E6%8C%87%E4%BB%A4"><span class="toc-text">shl和shr指令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0%EF%BC%9A%E5%A4%96%E4%B8%AD%E6%96%AD"><span class="toc-text">第十二章：外中断</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E4%B8%AD%E6%96%AD%E6%A6%82%E5%BF%B5"><span class="toc-text">外中断概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PC%E6%9C%BA%E9%94%AE%E7%9B%98%E7%9A%84%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B"><span class="toc-text">PC机键盘的处理过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0%EF%BC%9A%E7%9B%B4%E6%8E%A5%E5%AE%9A%E5%9D%80%E6%B3%95"><span class="toc-text">第十三章：直接定址法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0%E4%BA%86%E5%8D%95%E5%85%83%E9%95%BF%E5%BA%A6%E7%9A%84%E6%A0%87%E5%8F%B7"><span class="toc-text">描述了单元长度的标号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%85%B6%E4%BB%96%E6%AE%B5%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E6%A0%87%E5%8F%B7"><span class="toc-text">在其他段中使用数据标号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E5%AE%9A%E5%9D%80%E8%A1%A8"><span class="toc-text">直接定址表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0%EF%BC%9A%E6%8C%87%E4%BB%A4%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BB%93"><span class="toc-text">第十四章：指令系统总结</span></a></li></ol></li></ol> -->
        <div class="toc"></div>
      </div>
    </div>
  </div>
</section>
<!-- 手机端目录按钮 -->
<div id="toc-mobile-btn">
  <i class="fas fa-list-ul" aria-hidden="true"></i>
</div>

      
  <section class="widget side_recent_post">
    
  <header>
    
      <a style="color: " href='/tags/'><i class="fas fa-book fa-fw" aria-hidden="true"></i><span class='name'>最新文章</span></a>
    
  </header>


    <div class='content'>
      
      <!-- hash算法 -->
      
      <div class="aside-list">
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/07/05/hello-world/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/80/v2-5f7cb7e900b9dcf5354c3d4d2c5cc3c2_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">07-05</span>
                
              </div>
              <a class="post-title" href="/2023/07/05/hello-world/">Hello World</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/04/20/zhuan-ye-he-xin-ji-chu-li-lun-ji-suan-ji-zu-cheng-yuan-li/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://pic2.zhimg.com/80/v2-e22aaad20d20634f506f57fff0fcbc17_1440w.webp" class="lazyload placeholder" data-srcset="https://pic2.zhimg.com/80/v2-e22aaad20d20634f506f57fff0fcbc17_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">04-20</span>
                
              </div>
              <a class="post-title" href="/2023/04/20/zhuan-ye-he-xin-ji-chu-li-lun-ji-suan-ji-zu-cheng-yuan-li/">专业核心基础理论：计算机组成原理</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/04/20/zhuan-ye-he-xin-ji-chu-li-lun-ji-suan-ji-wang-luo/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://picx.zhimg.com/80/v2-9c50d3af0bc62a0e8b6e89e24c769317_1440w.webp" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/80/v2-9c50d3af0bc62a0e8b6e89e24c769317_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">04-20</span>
                
              </div>
              <a class="post-title" href="/2023/04/20/zhuan-ye-he-xin-ji-chu-li-lun-ji-suan-ji-wang-luo/">专业核心基础理论：计算机网络</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/04/08/wo-de-linux-ri-zhi/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp" class="lazyload placeholder" data-srcset="https://picx.zhimg.com/80/v2-b44931ea513e5f7b3b06f2703f79653c_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">04-08</span>
                
              </div>
              <a class="post-title" href="/2023/04/08/wo-de-linux-ri-zhi/">低谷期成长日志</a>
            </div>
          </div>
        
          <div class="aside-list-item">
            
            
            

            <div class="post-img-box">
              <a href="/2023/03/20/1.linux-wang-luo-ji-chu-gai-nian/" class="post-img " style="background-size: cover; 
                background-position: center center;">
                <img class="lazyload lazyload placeholder" style="width:100%;height:100%;object-fit:cover;" data-src="https://pic3.zhimg.com/80/v2-7cfc909ebe8d83683909846edd6b5232_1440w.webp" class="lazyload placeholder" data-srcset="https://pic3.zhimg.com/80/v2-7cfc909ebe8d83683909846edd6b5232_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="">
              </a>
            </div>
            <div class="post-date-title">
              <div>
                
                  <span class="post-date">03-20</span>
                
              </div>
              <a class="post-title" href="/2023/03/20/1.linux-wang-luo-ji-chu-gai-nian/">Linux网络基础概念</a>
            </div>
          </div>
        
      </div>
    </div>
  </section>

    
  </div>
</aside>

  <!-- 图片放大 Wrap images with fancybox support -->
  <script src="/js/wrapImage.js"></script>
</div>

<!-- 文章详情页背景图 -->
<div id="appBgSwiper" style="position: fixed;left: 0;top: 0;width: 100%;height: 100%;z-index: -2;"
	:style="{'background-color': bgColor ? bgColor : 'transparent'}">
	<transition-group tag="ul" :name="names">
		<li v-for='(image,index) in img' :key='index' v-show="index === mark" class="bg-swiper-box">
			<img :src="image" class="bg-swiper-img no-lazy">
		</li>
	</transition-group>
</div>
<script>
	var vm = new Vue({
		el: '#appBgSwiper',
		data: {
			names: '' || 'fade' || 'fade', // translate-fade fade
			mark: 0,
			img: [],
			bgColor: '',
			time: null
		},
		methods: {   //添加方法
			change(i, m) {
				if (i > m) {
					// this.names = 'fade';
				} else if (i < m) {
					// this.names = 'fade';
				} else {
					return;
				}
				this.mark = i;
			},
			prev() {
				// this.names = 'fade';
				this.mark--;
				if (this.mark === -1) {
					this.mark = 3;
					return
				}
			},
			next() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			autoPlay() {
				// this.names = 'fade';
				this.mark++;
				if (this.mark === this.img.length) {
					this.mark = 0;
					return
				}
			},
			play() {
				let bgImgDelay = '' || '180000'
				let delay = parseInt(bgImgDelay) || 180000;
				this.time = setInterval(this.autoPlay, delay);
			},
			enter() {
				clearInterval(this.time);
			},
			leave() {
				this.play();
			}
		},
		created() {
			this.play()
		},
		beforeDestroy() {
			clearInterval(this.time);
		},
		mounted() {
			let prop = '' || '';
			let isImg = prop.includes('.bmp') || prop.includes('.jpg') || prop.includes('.png') || prop.includes('.tif') || prop.includes('.gif') || prop.includes('.pcx') || prop.includes('.tga') || prop.includes('.exif') || prop.includes('.fpx') || prop.includes('.psd') || prop.includes('.cdr') || prop.includes('.pcd') || prop.includes('.dxf') || prop.includes('.ufo') || prop.includes('.eps') || prop.includes('.ai') || prop.includes('.raw') || prop.includes('.WMF') || prop.includes('.webp') || prop.includes('.jpeg') || prop.includes('http://') || prop.includes('https://')
			if (isImg) {
				let img = prop.split(',');
				let configRoot = '/'
				let arrImg = [];
				img.forEach(el => {
					var Expression = /http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/;
					var objExp = new RegExp(Expression);

					if (objExp.test(el)) {
						// http or https
						arrImg.push(el);
					} else {
						// 非http or https开头
						// 本地文件
						let firstStr = el.charAt(0);
						if (firstStr == '/') {
							el = el.substr(1); // 删除第一个字符 '/',因为 configRoot最后一个字符为 /
						}
						el = configRoot + el;
						arrImg.push(el);
					}
				})
				this.img = arrImg;
			} else {
				this.bgColor = prop;
			}
		}
	})
</script>

<style>
	.bg-swiper-box {
		position: absolute;
		display: block;
		width: 100%;
		height: 100%;
	}

	.bg-swiper-img {
		object-fit: cover;
		width: 100%;
		height: 100%;
	}
</style>




  <script>
  function loadMermaid() {
    if (document.getElementsByClassName('mermaid').length) {
      if (window.mermaidJsLoad) mermaid.init()
      else {
        loadScript('https://unpkg.com/mermaid/dist/mermaid.min.js').then(() => {
          window.mermaidJsLoad = true
          mermaid.initialize({
            theme: 'default',
          })
          if ('true') {
            mermaid.init();
          }
        })
      }
    }
  };
  document.addEventListener("DOMContentLoaded", function () {
    loadMermaid();
  })

  document.addEventListener('pjax:complete', function () {
    loadMermaid();
  })
  
</script>


      </main>
    </div>

    <!-- 页脚 -->
    
  
  
    <!-- 底部鱼儿跳动效果，依赖于jquery-->
<div id="j-fish-skip" style=" position: relative;height: 153px;width: auto;"></div>
<script>
  var RENDERER = {
    POINT_INTERVAL: 5,
    FISH_COUNT: 3,
    MAX_INTERVAL_COUNT: 50,
    INIT_HEIGHT_RATE: .5,
    THRESHOLD: 50,
    FISH_COLOR: '',
    init: function () {
      this.setFishColor(); this.setParameters(), this.reconstructMethods(), this.setup(), this.bindEvent(), this.render()
    },
    setFishColor: function () {
      let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');
      if (isDark) {
        this.FISH_COLOR = '#222'; // 暗黑色，有时间把这整成一个变量
      } else {
        this.FISH_COLOR = '' || 'rgba(66, 185, 133, 0.8)';
      }
    },
    setParameters: function () {
      this.$window = $(window), this.$container = $("#j-fish-skip"), this.$canvas = $("<canvas />"), this.context = this.$canvas.appendTo(this.$container).get(0).getContext("2d"), this.points = [], this.fishes = [], this.watchIds = []
    },
    createSurfacePoints: function () {
      var t = Math.round(this.width / this.POINT_INTERVAL);
      this.pointInterval = this.width / (t - 1), this.points.push(new SURFACE_POINT(this, 0));
      for (var i = 1; i < t; i++) {
        var e = new SURFACE_POINT(this, i * this.pointInterval),
          h = this.points[i - 1];
        e.setPreviousPoint(h), h.setNextPoint(e), this.points.push(e)
      }
    },
    reconstructMethods: function () {
      this.watchWindowSize = this.watchWindowSize.bind(this), this.jdugeToStopResize = this.jdugeToStopResize.bind(this), this.startEpicenter = this.startEpicenter.bind(this), this.moveEpicenter = this.moveEpicenter.bind(this), this.reverseVertical = this.reverseVertical.bind(this), this.render = this.render.bind(this)
    },
    setup: function () {
      this.points.length = 0, this.fishes.length = 0, this.watchIds.length = 0, this.intervalCount = this.MAX_INTERVAL_COUNT, this.width = this.$container.width(), this.height = this.$container.height(), this.fishCount = this.FISH_COUNT * this.width / 500 * this.height / 500, this.$canvas.attr({
        width: this.width,
        height: this.height
      }), this.reverse = !1, this.fishes.push(new FISH(this)), this.createSurfacePoints()
    },
    watchWindowSize: function () {
      this.clearTimer(), this.tmpWidth = this.$window.width(), this.tmpHeight = this.$window.height(), this.watchIds.push(setTimeout(this.jdugeToStopResize, this.WATCH_INTERVAL))
    },
    clearTimer: function () {
      for (; this.watchIds.length > 0;) clearTimeout(this.watchIds.pop())
    },
    jdugeToStopResize: function () {
      var t = this.$window.width(),
        i = this.$window.height(),
        e = t == this.tmpWidth && i == this.tmpHeight;
      this.tmpWidth = t, this.tmpHeight = i, e && this.setup()
    },
    bindEvent: function () {
      this.$window.on("resize", this.watchWindowSize), this.$container.on("mouseenter", this.startEpicenter), this.$container.on("mousemove", this.moveEpicenter)
    },
    getAxis: function (t) {
      var i = this.$container.offset();
      return {
        x: t.clientX - i.left + this.$window.scrollLeft(),
        y: t.clientY - i.top + this.$window.scrollTop()
      }
    },
    startEpicenter: function (t) {
      this.axis = this.getAxis(t)
    },
    moveEpicenter: function (t) {
      var i = this.getAxis(t);
      this.axis || (this.axis = i), this.generateEpicenter(i.x, i.y, i.y - this.axis.y), this.axis = i
    },
    generateEpicenter: function (t, i, e) {
      if (!(i < this.height / 2 - this.THRESHOLD || i > this.height / 2 + this.THRESHOLD)) {
        var h = Math.round(t / this.pointInterval);
        h < 0 || h >= this.points.length || this.points[h].interfere(i, e)
      }
    },
    reverseVertical: function () {
      this.reverse = !this.reverse;
      for (var t = 0, i = this.fishes.length; t < i; t++) this.fishes[t].reverseVertical()
    },
    controlStatus: function () {
      for (var t = 0, i = this.points.length; t < i; t++) this.points[t].updateSelf();
      for (t = 0, i = this.points.length; t < i; t++) this.points[t].updateNeighbors();
      this.fishes.length < this.fishCount && 0 == --this.intervalCount && (this.intervalCount = this.MAX_INTERVAL_COUNT, this.fishes.push(new FISH(this)))
    },
    render: function () {
      requestAnimationFrame(this.render), this.controlStatus(), this.context.clearRect(0, 0, this.width, this.height), this.context.fillStyle = this.FISH_COLOR;
      for (var t = 0, i = this.fishes.length; t < i; t++) this.fishes[t].render(this.context);
      this.context.save(), this.context.globalCompositeOperation = "xor", this.context.beginPath(), this.context.moveTo(0, this.reverse ? 0 : this.height);
      for (t = 0, i = this.points.length; t < i; t++) this.points[t].render(this.context);
      this.context.lineTo(this.width, this.reverse ? 0 : this.height), this.context.closePath(), this.context.fill(), this.context.restore()
    }
  },
  SURFACE_POINT = function (t, i) {
    this.renderer = t, this.x = i, this.init()
  };
  SURFACE_POINT.prototype = {
    SPRING_CONSTANT: .03,
    SPRING_FRICTION: .9,
    WAVE_SPREAD: .3,
    ACCELARATION_RATE: .01,
    init: function () {
      this.initHeight = this.renderer.height * this.renderer.INIT_HEIGHT_RATE, this.height = this.initHeight, this.fy = 0, this.force = {
        previous: 0,
        next: 0
      }
    },
    setPreviousPoint: function (t) {
      this.previous = t
    },
    setNextPoint: function (t) {
      this.next = t
    },
    interfere: function (t, i) {
      this.fy = this.renderer.height * this.ACCELARATION_RATE * (this.renderer.height - this.height - t >= 0 ? -1 : 1) * Math.abs(i)
    },
    updateSelf: function () {
      this.fy += this.SPRING_CONSTANT * (this.initHeight - this.height), this.fy *= this.SPRING_FRICTION, this.height += this.fy
    },
    updateNeighbors: function () {
      this.previous && (this.force.previous = this.WAVE_SPREAD * (this.height - this.previous.height)), this.next && (this.force.next = this.WAVE_SPREAD * (this.height - this.next.height))
    },
    render: function (t) {
      this.previous && (this.previous.height += this.force.previous, this.previous.fy += this.force.previous), this.next && (this.next.height += this.force.next, this.next.fy += this.force.next), t.lineTo(this.x, this.renderer.height - this.height)
    }
  };
  var FISH = function (t) {
    this.renderer = t, this.init()
  };
  FISH.prototype = {
    GRAVITY: .4,
    init: function () {
      this.direction = Math.random() < .5, this.x = this.direction ? this.renderer.width + this.renderer.THRESHOLD : -this.renderer.THRESHOLD, this.previousY = this.y, this.vx = this.getRandomValue(4, 10) * (this.direction ? -1 : 1), this.renderer.reverse ? (this.y = this.getRandomValue(1 * this.renderer.height / 10, 4 * this.renderer.height / 10), this.vy = this.getRandomValue(2, 5), this.ay = this.getRandomValue(.05, .2)) : (this.y = this.getRandomValue(6 * this.renderer.height / 10, 9 * this.renderer.height / 10), this.vy = this.getRandomValue(-5, -2), this.ay = this.getRandomValue(-.2, -.05)), this.isOut = !1, this.theta = 0, this.phi = 0
    },
    getRandomValue: function (t, i) {
      return t + (i - t) * Math.random()
    },
    reverseVertical: function () {
      this.isOut = !this.isOut, this.ay *= -1
    },
    controlStatus: function (t) {
      this.previousY = this.y, this.x += this.vx, this.y += this.vy, this.vy += this.ay, this.renderer.reverse ? this.y > this.renderer.height * this.renderer.INIT_HEIGHT_RATE ? (this.vy -= this.GRAVITY, this.isOut = !0) : (this.isOut && (this.ay = this.getRandomValue(.05, .2)), this.isOut = !1) : this.y < this.renderer.height * this.renderer.INIT_HEIGHT_RATE ? (this.vy += this.GRAVITY, this.isOut = !0) : (this.isOut && (this.ay = this.getRandomValue(-.2, -.05)), this.isOut = !1), this.isOut || (this.theta += Math.PI / 20, this.theta %= 2 * Math.PI, this.phi += Math.PI / 30, this.phi %= 2 * Math.PI), this.renderer.generateEpicenter(this.x + (this.direction ? -1 : 1) * this.renderer.THRESHOLD, this.y, this.y - this.previousY), (this.vx > 0 && this.x > this.renderer.width + this.renderer.THRESHOLD || this.vx < 0 && this.x < -this.renderer.THRESHOLD) && this.init()
    },
    render: function (t) {
      t.save(), t.translate(this.x, this.y), t.rotate(Math.PI + Math.atan2(this.vy, this.vx)), t.scale(1, this.direction ? 1 : -1), t.beginPath(), t.moveTo(-30, 0), t.bezierCurveTo(-20, 15, 15, 10, 40, 0), t.bezierCurveTo(15, -10, -20, -15, -30, 0), t.fill(), t.save(), t.translate(40, 0), t.scale(.9 + .2 * Math.sin(this.theta), 1), t.beginPath(), t.moveTo(0, 0), t.quadraticCurveTo(5, 10, 20, 8), t.quadraticCurveTo(12, 5, 10, 0), t.quadraticCurveTo(12, -5, 20, -8), t.quadraticCurveTo(5, -10, 0, 0), t.fill(), t.restore(), t.save(), t.translate(-3, 0), t.rotate((Math.PI / 3 + Math.PI / 10 * Math.sin(this.phi)) * (this.renderer.reverse ? -1 : 1)), t.beginPath(), this.renderer.reverse ? (t.moveTo(5, 0), t.bezierCurveTo(10, 10, 10, 30, 0, 40), t.bezierCurveTo(-12, 25, -8, 10, 0, 0)) : (t.moveTo(-5, 0), t.bezierCurveTo(-10, -10, -10, -30, 0, -40), t.bezierCurveTo(12, -25, 8, -10, 0, 0)), t.closePath(), t.fill(), t.restore(), t.restore(), this.controlStatus(t)
    }
  }, $(function () {
    RENDERER.init()
    $('.dark').click(function () {
      setTimeout(() => {
        RENDERER.setFishColor();
        RENDERER.context.fill();
      });
    })
  });
</script>
  
  <div class="footer bg-color">
    <div class="footer-main">
      
        
          <div class="link">
            
              
                <a href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1353429820" class="social">
                  
                    <i class="fas fa-rss" aria-hidden="true"></i>
                  
                </a>
              
            
              
                <a target="_blank" rel="noopener" href="https://mail.qq.com/cgi-bin/frame_html?sid=KBSRKCNvjCdIfCxP&amp;r=1d7d9d00703f1c291266ec60a05a3ec1&amp;lang=zh" class="social">
                  
                    <i class="fas fa-envelope" aria-hidden="true"></i>
                  
                </a>
              
            
              
                <a target="_blank" rel="noopener" href="https://gitee.com/Not_Go" class="social">
                  
                    <i class="fab fa-github" aria-hidden="true"></i>
                  
                </a>
              
            
              
                <a href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1353429820" class="social">
                  
                    <i class="fab fa-qq" aria-hidden="true"></i>
                  
                </a>
              
            
          </div>
        
      
        
          <div class="footer-copyright">
            <p>Copyright © 2022 - 2032 <a target="_blank" rel="noopener" href="https://gitee.com/Not_Go">牟建波</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo</a> </p>

          </div>
        
      
        
          
            <!-- 不蒜子统计 -->
            <!-- 不蒜子统计 -->
<span id="busuanzi_container_site_pv">
      <i class="fas fa-eye" aria-hidden="true"></i>本站总访问量：<span id="busuanzi_value_site_pv"></span> 次
</span>
<span class="post-meta-divider">|</span>
<span id="busuanzi_container_site_uv" style='display:none'>
      <i class="fas fa-users" aria-hidden="true"></i>本站访客数：<span id="busuanzi_value_site_uv"></span> 人
</span>

          
        
      
        
          <div class="footer-custom">
            
          </div>
        
      
    </div>
  </div>



    <!-- 渲染暗黑按钮 -->
    
      <div class="dark">
  <div class="dark-content">
    <i class="fas fa-moon" aria-hidden="true"></i>
    <!-- <span>关灯</span> -->
  </div>
  
</div>

<script>
  $(function() {
    let isDark = JSON.parse(localStorage.getItem('dark'))  || JSON.parse('false');
    if (isDark) {
      $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
    }
    $('.dark').click(function() {
      if ($(document.body).is('.darkModel')) {
        $(document.body).removeClass('darkModel');
        localStorage.setItem('dark', false);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-moon" aria-hidden="true"></i>
          </div>
          `
        );
      } else {
        $(document.body).addClass('darkModel');
        localStorage.setItem('dark', true);
        $(".dark-content").replaceWith(
          `
          <div class='dark-content'>
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
          </div>
          `
        );
      }
    })
  })
</script>
    
    <!-- 渲染回到顶部按钮 -->
    
      <div class="goTop top-btn-color" pointer>
  <i class="fas fa-arrow-up" aria-hidden="true"></i>
</div>
<script src="/js/goTop.js"></script>

    
    <!-- 渲染左下角音乐播放器 -->
    
      <link rel="stylesheet" href="/js/aplayer/APlayer@1.10.1.min.css">
<style>
.aplayer .aplayer-lrc p {
  
  display: none;
  
  font-size: 12px;
  font-weight: 700;
  line-height: 16px !important;
}

.aplayer .aplayer-lrc p.aplayer-lrc-current {
  
  display: none;
  
  font-size: 15px;
  color: #42b983;
}


.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
  left: -66px !important;
}

.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
  left: 0px !important;
}


</style>
<meting-js  
  class=""
  server="netease"
  type="playlist"
  id="2905900351"
  fixed='true'
  autoplay='false'
  theme='#42b983'
  loop='all'
  order='random'
  preload='auto'
  volume='0.7'
  list-folded='true'
>
</meting-js>

<!-- <style>
  #aplayer {
    position: fixed;
    left: 0;
    bottom: 300px;
  }
</style> -->
<script src="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script src="https://unpkg.com/meting@2/dist/Meting.min.js"></script>
    

    <!-- 图片放大 -->
    
      <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
    

    <!-- 百度解析 -->
    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <!-- 背景彩带 -->
    
      <script type="text/javascript" size="100" alpha='0.4' zIndex="-1" src="/js/ribbon.min.js"></script>
    

    <script src="/js/utils/index.js"></script>
    <script src="/js/app.js"></script>
    
    <!-- 文章目录所需js -->
<!-- <link href="/js/tocbot/tocbot.css" rel="stylesheet">
<script src="/js/tocbot/tocbot.min.js"></script> -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">

<script>
  var headerEl = 'h2, h3, h4',  //headers 
    content = '.post-detail',//文章容器
    idArr = {};  //标题数组以确定是否增加索引id
  //add #id
  var option = {
    // Where to render the table of contents.
    tocSelector: '.toc',
    // Where to grab the headings to build the table of contents.
    contentSelector: content,
    // Which headings to grab inside of the contentSelector element.
    headingSelector: headerEl,
    scrollSmooth: true,
    scrollSmoothOffset: -70,
    // headingsOffset: -($(window).height() * 0.4 - 45),
    headingsOffset: -($(window).height() * 0.4 - 70),
    // positionFixedSelector: '.toc-main',
    // positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
    activeLinkClass: 'is-active-link',
    orderedList: true,
    collapseDepth: 20,
    // onClick: function (e) {},
  }
  if ($('.toc').length > 0) {

    $(content).children(headerEl).each(function () {
      //去除空格以及多余标点
      var headerId = $(this).text().replace(/[\s|\~|`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\||\|\[|\]|\{|\}|\;|\:|\"|\'|\,|\<|\.|\>|\/|\?|\：|\，|\。]/g, '');

      headerId = headerId.toLowerCase();
      if (idArr[headerId]) {
        //id已经存在
        $(this).attr('id', headerId + '-' + idArr[headerId]);
        idArr[headerId]++;
      }
      else {
        //id未存在
        idArr[headerId] = 1;
        $(this).attr('id', headerId);
      }
    });

    document.addEventListener("DOMContentLoaded", function () {
      tocbot.init(option);
      mobileTocClick();
    });

  }

  window.tocScrollFn = function () {
    return bamboo.throttle(function () {
      findHeadPosition();
    }, 100)()
  }
  window.addEventListener('scroll', tocScrollFn);

  const findHeadPosition = function (top) {
    if ($('.toc-list').length <= 0) {
      return false;
    }
    setTimeout(() => {  // or DOMContentLoaded 
      autoScrollToc();
    }, 0);
  }

  const autoScrollToc = function () {
    const $activeItem = document.querySelector('.is-active-link');
    const $cardToc = document.querySelector('.toc-content');
    const activePosition = $activeItem.getBoundingClientRect().top
    const sidebarScrollTop = $cardToc.scrollTop
    if (activePosition > (document.documentElement.clientHeight - 100)) {
      $cardToc.scrollTop = sidebarScrollTop + 150
    }
    if (activePosition < 150) {
      $cardToc.scrollTop = sidebarScrollTop - 150
    }
  }

  document.addEventListener('pjax:send', function () {
    if ($('.toc').length) {
      tocbot.destroy();
    }
  });

  document.addEventListener('pjax:complete', function () {
    if ($('.toc').length) {
      tocbot.init(option);
      mobileTocClick();
    }
  });
  
  // 手机端toc按钮点击出现目录
  const mobileTocClick = function () {
    const $cardTocLayout = document.getElementsByClassName('side_toc')[0];
    const $cardToc = $cardTocLayout.getElementsByClassName('toc-content')[0];
    let right = '45px';
    if (window.innerWidth >= 551 && window.innerWidth <= 992) {
      right = '100px'
    }
    const mobileToc = {
      open: () => {
        $cardTocLayout.style.cssText = 'animation: toc-open .3s; opacity: 1; right: ' + right
      },

      close: () => {
        $cardTocLayout.style.animation = 'toc-close .2s'
        setTimeout(() => {
          $cardTocLayout.style.cssText = "opacity:''; animation: ''; right: ''"
        }, 100)
      }
    }
    document.getElementById('toc-mobile-btn').addEventListener('click', () => {
      if (window.getComputedStyle($cardTocLayout).getPropertyValue('opacity') === '0') mobileToc.open()
      else mobileToc.close()
    })

    $cardToc.addEventListener('click', (e) => {
      if (window.innerWidth < 992) { // 小于992px的时候
        mobileToc.close()
      }
    })
  }
</script>

<style>
  /* .is-position-fixed {
    position: sticky !important;
    top: 74px;
  }

  .toc-main ul {
    counter-reset: show-list;
  }

  .toc-main ul li::before {
    content: counter(item)".";
    display: block;
    position: absolute;
    left: 12px;
    top: 0;
  } */
</style>
 

<!-- 设置导航背景 -->
<script>
  let setHeaderClass = () => {
    const nav = $('#navHeader');
    const navTop = nav.outerHeight();
    const winTop = $(window).scrollTop();
    if(winTop > navTop) {
      nav.addClass('header-bg-color');
    }
    else {
      nav.removeClass('header-bg-color');
    }
  };

  let scrollCollect = () => {
    return bamboo.throttle(function (e) {
      setHeaderClass();
    }, 200)()
  }

  let initHeaderBg = () => {
    setHeaderClass();
  }

  setHeaderClass();
  window.addEventListener('scroll', scrollCollect);

  document.addEventListener('pjax:send', function () {
    window.removeEventListener('scroll', scrollCollect)
  })
  document.addEventListener('pjax:complete', function () {
    window.addEventListener('scroll', scrollCollect);
    setHeaderClass();
  })
</script> 

<!-- 渲染issues标签里的内容 -->
<script>
  function loadIssuesJS() {
    if ($(".post-detail").find(".issues-api").length == 0) {
      return;
    } 
    loadScript('/js/issues/index.js');
  };
  $(function () {
    loadIssuesJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof IssuesAPI == "undefined") {
      loadIssuesJS();
    }
  })
</script>

<!-- 渲染远程json加载的图片标签(getPhotoOnline)里的内容 -->
<script>
  function loadPhotoOnlineJS() {
    if ($(".post-detail").find(".getJsonPhoto-api").length == 0) {
      return;
    } 
    loadScript('/js/getPhotoOnline/index.js');
  };
  $(function () {
    loadPhotoOnlineJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof getPhotoJson == "undefined") {
      loadPhotoOnlineJS();
    }
  })
</script>

<!-- 渲染远程json加载的talk标签(getTalkOnline)里的内容 -->
<script>
  function loadTalkOnlineJS() {
    if ($(".post-detail").find(".getJsonTalk-api").length == 0) {
      return;
    } 
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/waterfall.js/1.0.2/waterfall.min.js'); // 瀑布流插件，https://raphamorim.io/waterfall.js/
    loadScript('/js/getTalkOnline/index.js');
  };
  $(function () {
    loadTalkOnlineJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof getTalkJson == "undefined") {
      loadTalkOnlineJS();
    }
  })
</script>

<!-- 渲染远程json加载的site-card标签(getSiteOnline)里的内容 -->
<script>
  function loadSiteOnlineJS() {
    if ($(".post-detail").find(".getJsonSite-api").length == 0) {
      return;
    } 
    loadScript('/js/getSiteOnline/index.js');
  };
  $(function () {
    loadSiteOnlineJS();
  });
  document.addEventListener('pjax:complete', function () {
    if (typeof getSiteJson == "undefined") {
      loadSiteOnlineJS();
    }
  })
</script>

<!-- 输入框打字特效 -->
<!-- 输入框打字特效 -->

  <script src="/js/activate-power-mode.js"></script>
  <script>
    POWERMODE.colorful = true;  // 打开随机颜色特效
    POWERMODE.shake = false;    // 关闭输入框抖动
    document.body.addEventListener('input', POWERMODE);//监听打字事件
  </script>


<!-- markdown代码一键复制功能 -->

  <link rel="stylesheet" href="https://unpkg.com/v-plugs-ayu/lib/ayu.css">
  <script src="https://unpkg.com/v-plugs-ayu/lib/ayu.umd.min.js"></script>
  <script src="/js/clipboard/clipboard.min.js"></script>
  <div id="appCopy">
  </div>
  <script data-pjax>
    var vm = new Vue({
      el: '#appCopy',
      data: {
      },
      computed: {
      },
      mounted() {
        const that = this;
        var copy = '复制';
        /* code */
        var initCopyCode = function () {
          var copyHtml = '';
          copyHtml += '<button class="btn-copy" data-clipboard-snippet="" style="position:absolute;top:0;right:0;z-index:1;">';
          copyHtml += '<i class="fas fa-copy"></i><span>' + copy + '</span>';
          copyHtml += '</button>';
          $(".post-detail pre").not('.gutter pre').wrap("<div class='codeBox' style='position:relative;width:100%;'></div>")
          $(".post-detail pre").not('.gutter pre').before(copyHtml);
          new ClipboardJS('.btn-copy', {
            target: function (trigger) {
              return trigger.nextElementSibling;
            }
          });
        }
        initCopyCode();
        $('.btn-copy').unbind('click').bind('click', function () {
          doSomething();
        })
        $(document).unbind('keypress').bind('keypress', function (e) {
          if (e.ctrlKey && e.keyCode == 67) {
            doSomething();
          }
        })

        function doSomething() {
          that.$notify({
            title: "成功",
            content: "代码已复制，请遵守相关授权协议。",
            type: 'success'
          })
        }
      },
      methods: {
      },
      created() { }
    })
  </script>
  

<!-- 图片懒加载 -->
<script defer src="https://unpkg.com/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
  document.addEventListener('pjax:complete', function () {
    lazyLoadInstance.update();
  });
</script>


<!-- 卡片滚动动画 -->

    <script type="text/javascript">
  loadScript("https://unpkg.com/scrollreveal@4.0.6/dist/scrollreveal.min.js")
  function pjax_scrollrebeal() {
    ScrollReveal().reveal('.reveal', {
      distance: '120px',
      duration: '400',
      interval: '30',
      scale: '1',
      origin: 'bottom', // 动画开始的方向
      easing: 'ease'
    });
  }
  $(function () {
    var checkScrollReveal = setInterval(function () {
      if ($("#safearea").css("display") != "block") return
      if (typeof ScrollReveal == "undefined") return
      clearInterval(checkScrollReveal)
      pjax_scrollrebeal();
    }, 100)
  });
  document.addEventListener('pjax:complete', function () {
    pjax_scrollrebeal();
  })
</script>
   

<!-- 评论所需js -->

  
    <script type="text/javascript">
  var utteranceCommon = {};

  function check_utterance() {
    let isDark = JSON.parse(localStorage.getItem('dark')) || JSON.parse('false');
    if (isDark) {
      utteranceCommon.Theme = 'github-dark';
    } else {
      utteranceCommon.Theme = 'github-light';
    }

    return document.getElementById("gitment-container");
  }
  comment_el = '#gitment-container';
  load_utterance = function () {
    if ($(comment_el).length) {
      // 匿名函数，防止污染全局变量
      const HEAD = check_utterance();

      var utterances = document.createElement('script');
      utterances.type = 'text/javascript';
      utterances.async = true;
      utterances.setAttribute('issue-term', 'pathname')
      utterances.setAttribute('theme', utteranceCommon.Theme)
      utterances.setAttribute('repo', 'Not-Go/Not-Go.github.io')
      utterances.crossorigin = 'anonymous';
      utterances.src = 'https://utteranc.es/client.js';
      // content 是要插入评论的地方
      document.getElementById('gitment-container').appendChild(utterances);

    }
  }

  function dark_utterance() {
    const HEAD = check_utterance();
    if (!HEAD) return;
    const message = {
      type: 'set-theme',
      theme: utteranceCommon.Theme
    };
    const utteranceIframe = document.querySelector('iframe');
    utteranceIframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }

  $(document).ready(load_utterance);
  document.addEventListener('pjax:complete', function () {
    load_utterance();
  });

  $('.dark').click(function () {
    setTimeout(() => {
      dark_utterance();
    });
  })

</script>

<style>
  .utterances {
    max-width: inherit !important;
  }
</style>
  


<!-- 鼠标点击特效 -->
<!-- 爱心点击 -->

  
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 999; pointer-events: none;" ></canvas>
    <script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
    <script src="/js/cursor/explosion.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" data-pjax></script>


<!-- 轮播图标签 -->
<script>
  var bambooSwiperTag = {};
  function load_swiper() {
    if (!document.querySelectorAll(".post-swiper-container")[0]) return;
    loadCSS("https://unpkg.com/swiper@6/swiper-bundle.min.css")
    loadScript("https://unpkg.com/swiper@6/swiper-bundle.min.js").then(() => {
      pjax_swiper();
    });
  }

  load_swiper();

  function pjax_swiper() {
    bambooSwiperTag.swiper = new Swiper('.post-swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      autoplay: true ? {
        delay: 3000,
        stopOnLastSlide: false,
        disableOnInteraction: false,
      } : false,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      on:{
        init: function(){
          swiperAnimateCache(this); //隐藏动画元素 
          swiperAnimate(this); //初始化完成开始动画
        }, 
        slideChangeTransitionEnd: function(){ 
          swiperAnimate(this); //每个slide切换结束时也运行当前slide动画
          //this.slides.eq(this.activeIndex).find('.ani').removeClass('ani'); 动画只展现一次，去除ani类名
        } 
      }
    });
  }

  document.addEventListener('pjax:complete', function () {
    if (!document.querySelectorAll(".post-swiper-container")[0]) return;
    if (typeof bambooSwiperTag.swiper === "undefined") {
      load_swiper();
    } else {
      pjax_swiper();
    }
  });
</script>
    <!-- pjax -->
    

<!-- pjax -->


  <script src="/js/pjax@0.2.8/index.js"></script>
  
    <!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <div class="loading-circle"><div id="loader-circle"></div></div>
    <script>
      window.ShowLoading = function() {
        $(".loading-circle").css("display", "block");
      };
      window.HideLoading = function() {
        $(".loading-circle").css("display", "none");
      }
    </script>
  
	<script>
    document.addEventListener('pjax:complete', function () {
      window.HideLoading();
    })
    document.addEventListener('pjax:send', function () {
      window.ShowLoading();
    })
    document.addEventListener('pjax:error', function () {
      window.HideLoading();
    })
	</script>
</div>

  

  <script>
    var pjax = new Pjax({
      elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([no-pjax])',   // 拦截正常带链接的 a 标签
      selectors: ["#pjax-container","title"],                                   // 根据实际需要确认重载区域
      cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
      timeout: 5000
    });

    document.addEventListener('pjax:send', function (e) {

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');

    })
    
    document.addEventListener('pjax:complete', function () {
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
    });

    document.addEventListener('pjax:error', function (e) {
      window.location.href = e.triggerElement.href;
    })
    
    // 刷新不从顶部开始
    document.addEventListener("DOMContentLoaded", function () {
      history.scrollRestoration = 'auto';
    })
  </script>



  </body>
</html>